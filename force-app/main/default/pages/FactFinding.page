<!--
  @File Name          : FactFinding.page
  @Description        : 
  @Author             : Alvin Aquino
  @Group              : 
  @Last Modified By   : Alvin Aquino
  @Last Modified On   : 9/29/2020, 1:30:00 PM
  @Modification Log   : 
  Ver       Date            Author                  Modification
  1.0    2/21/2020   Alvin Aquino     Initial Version
  1.1    9/17/2020   Patrick Lorilla  Added the client expectation field and section
  1.2    9/29/2020   Patrick Lorilla  Moved the client expectation field and section
-->
<apex:page standardController="Opportunity" extensions="FactFindingController" showHeader="false" sidebar="false" docType="html-5.0"
    standardStylesheets="false" title="Client Discovery" tabStyle="Opportunity">
    <!-- Common scripts -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.19.1/moment.js"></script>
    <script src="https://momentjs.com/downloads/moment.min.js"></script>
    <!-- Important To Include ALJS init File-->
    <script src="{!URLFOR($Resource.aljs, '/jquery.aljs-init.min.js')}"></script>
    <!-- ALJS Datepicker Module-->
    <script src="{!URLFOR($Resource.aljs, '/jquery.aljs-datepicker.min.js')}"></script>
    <script src="{!URLFOR($Resource.Akina, '/js/SLDSDynamicLookup.js')}" />
    <script src="{!URLFOR($Resource.Akina, '/js/functions.js')}" />
    <link href="{!$Resource.SLDS_Extended}" rel="stylesheet" type="text/css" />
    <apex:stylesheet value="{!URLFOR($Resource.Akina, 'css/base.css')}" />
    <style>
        .totalIncome1,
        .totalIncome2,
        .totalAssets,
        .totalLiabilities,
        .totalConLiabilities {
            font-weight: bold;
        }

        .production {
            padding-top: 1.5rem;
        }

        .tabsContent {
            overflow: auto;
            padding-top: 0 !important;
            height: calc(100% - 40px);
            margin-top: 20px;
        }

        .tabsContent.internalTabs {
            height: calc(100% - 10px) !important;
            margin-top: 6px !important;
        }

        .navbar {
            overflow: hidden;
            z-index: 1;
            position: fixed;
            background: white;
            top: 0;
            width: 100%;
        }

        .messages {
            position: fixed;
            width: 100%;
            bottom: 0;
            right: 0;
            z-index: 999999;
            background: transparent;
        }

        .unsaved,
        .unsaved abbr {
            color: #cc3f30 !important;
        }
    </style>
    <html xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" lang="en" style="height: 100%">

    <head>
        <title>Client Discovery</title>
        <apex:slds />
    </head>

    <body class="slds-scope" id="body" style="overflow-y: hidden; height: 100%">
        <c:spinner />

        <!-- Form Main -->
        <apex:form enctype="multipart/form-data" id="mainForm" styleClass="{!IF(sandbox, '', 'production')}" style="height: 100%">
            <!-- save buttons actions -->
            <apex:actionFunction action="{!saveClientDetails}" name="saveAndNextTab1" rerender="pageNotif,internalTabs,contactTypePanel,nextStepPanel"
                oncomplete="setDatePickers(); hideSpinner(); hideMessages(); setSaved('Tab1'); moveToNextTab({!hasError});" />
            <apex:actionFunction action="{!saveNeedsAnalysis}" name="saveNeedAnalysis" rerender="pageNotif,needsPanel" oncomplete="hideSpinner(); hideMessages(); setSaved('Tab2');"
            />
            <apex:actionFunction action="{!saveRiskAnalysis}" name="saveRiskAnalysis" rerender="pageNotif,riskAnalysisPanel" oncomplete="hideSpinner(); hideMessages(); setSaved('Tab3');"
            />
            <apex:actionFunction action="{!saveLetterOfAuthority}" name="loaScopeSaveRecord" rerender="pageNotif,letterOfAuthorityPanel"
                oncomplete="hideSpinner(); hideMessages(); setSaved('Tab4');" />
            <apex:actionFunction name="resetLetterOfAuthority" action="{!cleanLetterOfAuthority}" rerender="pageNotif,letterOfAuthorityPanel"
                oncomplete="hideSpinner(); hideMessages(); markAsChanged('Tab4');" />
            <apex:actionFunction action="{!saveScopeOfEngagement}" name="scopeSaveRecord" rerender="pageNotif,scopeOfEngagement" oncomplete="hideSpinner(); hideMessages(); setSaved('Tab5');"
            />
            <apex:actionFunction name="resetScopeOfEngagement" action="{!cleanScopeOfEngagement}" rerender="pageNotif,scopeOfEngagement"
                oncomplete="hideSpinner(); hideMessages(); markAsChanged('Tab5');" />
            <apex:actionFunction action="{!saveAppointment}" name="saveAppointment" rerender="pageNotif,nextAppointmentPanel" oncomplete="hideSpinner(); hideMessages(); setSaved('Tab6'); closeDialognextappointment()"
            />
            <apex:actionFunction action="{!addNotes}" name="addNotes" rerender="pageNotif,addNotes" oncomplete="hideSpinner(); hideMessages(); setSaved('Tab6');"
            />




            <!-- Delete record function -->
            <apex:actionFunction name="deleteRecord" action="{!deleteRecord}" reRender="pageNotif,internalTabs,otherEntityRelationshipPanel"
                oncomplete="hideSpinner(); setTotals('{!typeToDelete}'); hideMessages();">
                <apex:param name="recordId" assignTo="{!recordIdToDelete}" value="" />
                <apex:param name="tempId" assignTo="{!tempIdToDelete}" value="" />
                <apex:param name="type" assignTo="{!typeToDelete}" value="" />
            </apex:actionFunction>

            <!-- Client selection function (Who are you? Tab) -->
            <apex:actionFunction action="{!changeClient2}" name="client2selected" reRender="internalTabs,pageNotif" onComplete="hideSpinner(); hideMessages(); setSaved('Tab1'); return false;">
                <apex:param value="" name="selectedId" assignTo="{!opp.Joint_Owner__c}" />
            </apex:actionFunction>

            <!-- Calculate Risk Score function (Investor Profile Tab - Investment Investor Profile Questionnaire Section) -->
            <apex:actionFunction action="{!calculateScore}" name="calculateRiskScore" rerender="riskScore" />

            <!-- Reload signature function (Next Steps Tab) -->
            <apex:actionFunction name="ReloadSignature" rerender="nextStepPanel" action="{!getUpdatedSignatures}" />

            <!-- Legal Entity selection function (Other Entities Tab) -->
            <apex:actionFunction action="{!selectLegalEntity}" name="legalEntitySelected" reRender="legalEntityPanel" onComplete="hideSpinner(); return false;">
                <apex:param value="" name="selectedId" assignTo="{!otherEntityToAddEdit.account.Id}" />
            </apex:actionFunction>

            <!-- Family Member account selection function (Your Family Tab) -->
            <apex:actionFunction action="{!selectFamilyAccount}" name="familyAccountSelected" reRender="familyMemberPanel" onComplete="hideSpinner(); return false;">
                <apex:param value="" name="selectedId" assignTo="{!familyMemberToAddEdit.account.Id}" />
            </apex:actionFunction>

            <!-- Add asset data -->
            <apex:actionFunction action="{!addEditAsset}" name="openAssetDataPopup" onComplete="hideSpinner(); openDialog('assetData'); return false;"
                rerender="assetDataDialog">
                <apex:param value="" name="tempId" id="assetTempId" />
            </apex:actionFunction>

            <!-- Add new Institution -->
            <apex:actionFunction action="{!addNewInstitution}" name="openNewInstitution" onComplete="hideSpinner(); openDialog('newInstitution', true); return false;"
                rerender="newInstitutionDialog" />

            <!-- On Confirm Family Member Popup Function -->
            <apex:actionFunction action="{!saveFamilyMember}" name="saveMember" reRender="pageNotif,familyDetailsPanel,internalTabs"
                onComplete="closeDialogfamilyMember(); hideSpinner();  hideMessages();" />

            <!-- On Confirm Other Entity Popup Function -->
            <apex:actionFunction action="{!saveOtherEntities}" name="saveOtherEntity" reRender="pageNotif,otherEntitiesPanel,internalTabs"
                onComplete="closeDialogotherEntities(); hideSpinner();  hideMessages();" />

            <!-- On Confirm Asset Data Popup Function -->
            <apex:actionFunction action="{!saveAssetData}" name="saveAsset" reRender="pageNotif,internalTabs" onComplete="closeDialogassetData(); hideSpinner(); hideMessages();">
                <apex:param value="" name="createLiability" id="createLiability" />
            </apex:actionFunction>

            <!-- On Confirm New Institution Popup Function -->
            <apex:actionFunction action="{!saveNewInstitution}" name="saveInstitution" reRender="pageNotif,internalTabs" onComplete="closeDialognewInstitution(); hideSpinner(); hideMessages();">
                <apex:param value="" name="tempId" id="rowTempId" />
                <apex:param value="" name="origin" id="origin" />
            </apex:actionFunction>

            <div class="slds-tabs--default" style="height: 100%">
                <apex:outputPanel id="pageNotif">
                    <apex:variable value="{!0}" var="count" />
                    <div id="pageMessages" class="messages">
                        <apex:repeat value="{!allPageMessagesMap}" var="alertTheme">
                            <div class="slds-notify slds-notify_alert slds-theme_alert-texture slds-theme_{!alertTheme}" role="alert">
                                <span class="slds-assistive-text">{!alertTheme}</span>
                                <h2 class="slds-text-heading_small">
                                    <apex:repeat value="{!allPageMessagesMap[alertTheme]}" var="message">
                                        <apex:outputText value="{!message}" escape="false" />
                                        <br/>
                                    </apex:repeat>
                                </h2>
                            </div>
                            <apex:variable var="count" value="{!count + 1}" />
                        </apex:repeat>
                    </div>
                </apex:outputPanel>
                <div class="messages">
                    <div class="slds-notify slds-notify_alert slds-theme_alert-texture slds-theme_offline" role="alert" id="offline" style="display: none;">
                        <span class="slds-assistive-text">offline</span>
                        <span class="slds-icon_container slds-icon-utility-offline slds-m-right_x-small">
                            <c:icon elementId="lostConnection" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#offline')}" classes="slds-icon slds-icon_x-small"
                            />
                            <h2>You have lost connection to the internet. Please do not click any buttons or navigate away from
                                this page until you have reconnected or you risk losing information that hasn't been saved
                                yet.
                            </h2>
                        </span>
                    </div>
                </div>
                <!-- TABS -->
                <div class="navbar">
                    <div id="tab-container" class="slds-is-relative">
                        <ul class="slds-tabs--default__nav" role="tablist">
                            <li class="slds-tabs__item slds-text-heading--label {!IF(OR(selectedTab == 'Tab1', selectedTab == ''), 'slds-active', '')}"
                                title="Know your Client" role="presentation">
                                <a style="color: #66b245; font-weight: bold;" href="#" role="tab" id="Tab1" tabindex="-1" aria-selected="false" aria-controls="tab-default-1"
                                    onclick="selectTab(this); return false;">
                                    Know your Client
                                </a>
                            </li>
                            <li class="slds-tabs__item slds-text-heading--label {!IF(selectedTab == 'Tab2', 'slds-active', '')}" title="Needs Analysis"
                                role="presentation">
                                <a style="color: #66b245; font-weight: bold;" href="#" role="tab" id="Tab2" tabindex="-1" aria-selected="false" aria-controls="tab-default-2"
                                    onclick="selectTab(this); return false;">
                                    <apex:outputPanel styleClass="slds-indicator-container slds-hide unsaved-abbr">
                                        <abbr class="slds-indicator_unsaved" title="Tab Not Saved" aria-label="Tab Not Saved">*</abbr>
                                    </apex:outputPanel>
                                    Needs Analysis
                                </a>
                            </li>
                            <li class="slds-tabs__item slds-text-heading--label {!IF(selectedTab == 'Tab3', 'slds-active', '')} {!IF(OR(CONTAINS(opp.Type, 'Investment'), CONTAINS(opp.Type, 'Kiwisaver')), 'slds-show', 'slds-hide')}"
                                title="Investor Profile" role="presentation">
                                <a style="color: #66b245; font-weight: bold;" href="#" role="tab" id="Tab3" tabindex="-1" aria-selected="false" aria-controls="tab-default-3"
                                    onclick="selectTab(this); return false;">
                                    <apex:outputPanel styleClass="slds-indicator-container slds-hide unsaved-abbr">
                                        <abbr class="slds-indicator_unsaved" title="Tab Not Saved" aria-label="Tab Not Saved">*</abbr>
                                    </apex:outputPanel>
                                    Investor Profile
                                </a>
                            </li>
                            <li class="slds-tabs__item slds-text-heading--label {!IF(selectedTab == 'Tab4', 'slds-active', '')}" title="Letter of Authority"
                                role="presentation">
                                <a style="color: #66b245; font-weight: bold;" href="#" role="tab" id="Tab4" tabindex="-1" aria-selected="false" aria-controls="tab-default-4"
                                    onclick="selectTab(this); return false;">
                                    <apex:outputPanel styleClass="slds-indicator-container slds-hide unsaved-abbr">
                                        <abbr class="slds-indicator_unsaved" title="Tab Not Saved" aria-label="Tab Not Saved">*</abbr>
                                    </apex:outputPanel>
                                    Letter of Authority
                                </a>
                            </li>
                            <li class="slds-tabs__item slds-text-heading--label {!IF(selectedTab == 'Tab5', 'slds-active', '')}" title="Scope of Engagement"
                                role="presentation">
                                <a style="color: #66b245; font-weight: bold;" href="#" role="tab" id="Tab5" tabindex="-1" aria-selected="false" aria-controls="tab-default-5"
                                    onclick="selectTab(this); return false;">
                                    <apex:outputPanel styleClass="slds-indicator-container slds-hide unsaved-abbr">
                                        <abbr class="slds-indicator_unsaved" title="Tab Not Saved" aria-label="Tab Not Saved">*</abbr>
                                    </apex:outputPanel>
                                    Scope of Engagement
                                </a>
                            </li>
                            <li class="slds-tabs__item slds-text-heading--label {!IF(selectedTab == 'Tab6', 'slds-active', '')}" title="Next Steps" role="presentation">
                                <a style="color: #66b245; font-weight: bold;" href="#" role="tab" id="Tab6" tabindex="-1" aria-selected="false" aria-controls="tab-default-6"
                                    onclick="selectTab(this); return false;">
                                    <apex:outputPanel styleClass="slds-indicator-container slds-hide unsaved-abbr">
                                        <abbr class="slds-indicator_unsaved" title="Tab Not Saved" aria-label="Tab Not Saved">*</abbr>
                                    </apex:outputPanel>
                                    Next Steps
                                </a>
                            </li>
                        </ul>
                        <div id="headerButtons" style="right: 10px; position: absolute; top: 4px;">
                            <button class="slds-button slds-button_brand active-btn header-btn slds-show Tab1 saveAndNext" title="Next" onclick="showSpinner();checkAndFillPostalAddress();saveAndNextTab1();return false;">
                                Save and Next
                            </button>
                            <button class="slds-button slds-button_brand active-btn header-btn Tab2" title="Save Needs Analysis" onclick="showSpinner();saveNeedAnalysis();return false;"
                                style="{!IF(selectedTab == 'Tab2', '', 'display: none;')}">
                                Save
                            </button>
                            <button class="slds-button slds-button_brand active-btn header-btn Tab3" title="Save Investor Profile" onclick="checkTaxCountryData();return false;"
                                style="{!IF(AND(selectedTab == 'Tab3', OR(CONTAINS(opp.Type, 'Investment'), CONTAINS(opp.Type, 'Kiwisaver'))), '', 'display: none;')}">
                                Save
                            </button>
                            <button class="slds-button slds-button_neutral neutral-btn header-btn Tab4" title="Reset selection" onclick="showSpinner(); resetLetterOfAuthority();return false;"
                                style="color: #66b245;{!IF(selectedTab == 'Tab4', '', 'display: none;')}">
                                Reset
                            </button>
                            <button class="slds-button slds-button_brand active-btn header-btn Tab4" title="Save Letter of Authority" onclick="showSpinner();loaScopeSaveRecord();return false;"
                                style="{!IF(selectedTab == 'Tab4', '', 'display: none;')}">
                                Save
                            </button>
                            <button class="slds-button slds-button_neutral neutral-btn header-btn Tab5" title="Reset selection" onclick="showSpinner(); resetScopeOfEngagement();return false;"
                                style="color: #66b245;{!IF(selectedTab == 'Tab5', '', 'display: none;')}">
                                Reset
                            </button>
                            <button class="slds-button slds-button_brand active-btn header-btn Tab5" title="Save Scope of Engagement" onclick="showSpinner();scopeSaveRecord();return false;"
                                style="{!IF(selectedTab == 'Tab5', '', 'display: none;')}">
                                Save
                            </button>
                        </div>
                    </div>
                </div>
                <!-- <div> -->
                <!-- Know Your Client Tab -->
                <div class="slds-tabs__content {!IF(OR(selectedTab == 'Tab1', selectedTab == ''), 'slds-show', 'slds-hide')}" role="tabpanel"
                    aria-labelledby="Tab1" id="divTab1" style="height: 100%">

                    <!-- Internal Tabs for Know Your Client -->
                    <div class="slds-vertical-tabs slds-grid slds-wrap" style="border: none; height: 100%;">
                        <ul class="slds-vertical-tabs__nav" role="tablist" style="margin-top: 6px">
                            <li class="slds-text-heading--label slds-vertical-tabs__nav-item {!IF(OR(selectedInternalTab == 'tabAgenda', selectedInternalTab == ''), 'slds-is-active', '')}"
                                title="Agenda" role="presentation">
                                <a class="slds-vertical-tabs__link slds-p-around--x-small" style="color: #66b245; font-weight: bold;" href="#" onclick="selectInternalTab(this); return false;"
                                    role="tab" tabindex="0" aria-selected="true" aria-controls="tab-scoped-1" id="tabAgenda">
                                    <apex:outputPanel styleClass="slds-indicator-container slds-hide unsaved-abbr">
                                        <abbr class="slds-indicator_unsaved" title="Tab Not Saved" aria-label="Tab Not Saved">*</abbr>
                                    </apex:outputPanel>
                                    Agenda
                                </a>
                            </li>
                            <li class="slds-text-heading--label slds-vertical-tabs__nav-item {!IF(selectedInternalTab == 'tabWhoAreYou', 'slds-is-active', '')}"
                                title="Who are you?" role="presentation">
                                <a class="slds-vertical-tabs__link slds-p-around--x-small" style="color: #66b245; font-weight: bold;" href="#" onclick="selectInternalTab(this); return false;"
                                    role="tab" tabindex="0" aria-selected="true" aria-controls="tab-scoped-2" id="tabWhoAreYou">
                                    <apex:outputPanel styleClass="slds-indicator-container slds-hide unsaved-abbr">
                                        <abbr class="slds-indicator_unsaved" title="Tab Not Saved" aria-label="Tab Not Saved">*</abbr>
                                    </apex:outputPanel>
                                    Who are you?
                                </a>
                            </li>
                            <li class="slds-text-heading--label slds-vertical-tabs__nav-item {!IF(selectedInternalTab == 'tabYourFamily', 'slds-is-active', '')}"
                                title="Your Family" role="presentation">
                                <a class="slds-vertical-tabs__link slds-p-around--x-small" style="color: #66b245; font-weight: bold;" href="#" onclick="selectInternalTab(this); return false;"
                                    role="tab" tabindex="0" aria-selected="true" aria-controls="tab-scoped-3" id="tabYourFamily">
                                    <apex:outputPanel styleClass="slds-indicator-container slds-hide unsaved-abbr">
                                        <abbr class="slds-indicator_unsaved" title="Tab Not Saved" aria-label="Tab Not Saved">*</abbr>
                                    </apex:outputPanel>
                                    Your Family
                                </a>
                            </li>
                            <li class="slds-text-heading--label slds-vertical-tabs__nav-item {!IF(selectedInternalTab == 'tabEmployment', 'slds-is-active', '')}"
                                title="Employment" role="presentation">
                                <a class="slds-vertical-tabs__link slds-p-around--x-small" style="color: #66b245; font-weight: bold;" href="#" onclick="selectInternalTab(this); return false;"
                                    role="tab" tabindex="0" aria-selected="true" aria-controls="tab-scoped-4" id="tabEmployment">
                                    <apex:outputPanel styleClass="slds-indicator-container slds-hide unsaved-abbr">
                                        <abbr class="slds-indicator_unsaved" title="Tab Not Saved" aria-label="Tab Not Saved">*</abbr>
                                    </apex:outputPanel>
                                    Employment
                                </a>
                            </li>
                            <li class="slds-text-heading--label slds-vertical-tabs__nav-item {!IF(selectedInternalTab == 'tabOtherEntities', 'slds-is-active', '')}"
                                title="Other Entities" role="presentation">
                                <a class="slds-vertical-tabs__link slds-p-around--x-small " style="color: #66b245; font-weight: bold;" href="#" onclick="selectInternalTab(this); return false;"
                                    role="tab" tabindex="0" aria-selected="true" aria-controls="tab-scoped-5" id="tabOtherEntities">
                                    <apex:outputPanel styleClass="slds-indicator-container slds-hide unsaved-abbr">
                                        <abbr class="slds-indicator_unsaved" title="Tab Not Saved" aria-label="Tab Not Saved">*</abbr>
                                    </apex:outputPanel>
                                    Other Entities
                                </a>
                            </li>
                            <li class="slds-text-heading--label slds-vertical-tabs__nav-item {!IF(selectedInternalTab == 'tabAssetsLiabilities', 'slds-is-active', '')}"
                                title="Assets & Liabilities" role="presentation">
                                <a class="slds-vertical-tabs__link slds-p-around--x-small" style="color: #66b245; font-weight: bold;" href="#" onclick="selectInternalTab(this); return false;"
                                    role="tab" tabindex="0" aria-selected="true" aria-controls="tab-scoped-6" id="tabAssetsLiabilities">
                                    <apex:outputPanel styleClass="slds-indicator-container slds-hide unsaved-abbr">
                                        <abbr class="slds-indicator_unsaved" title="Tab Not Saved" aria-label="Tab Not Saved">*</abbr>
                                    </apex:outputPanel>
                                    Assets &amp; Liabilities
                                </a>
                            </li>
                            <li class="slds-text-heading--label slds-vertical-tabs__nav-item {!IF(selectedInternalTab == 'tabIncomeExpenses', 'slds-is-active', '')}"
                                title="Income & Expenses" role="presentation">
                                <a class="slds-vertical-tabs__link slds-p-around--x-small" style="color: #66b245; font-weight: bold;" href="#" onclick="selectInternalTab(this); return false;"
                                    role="tab" tabindex="0" aria-selected="true" aria-controls="tab-scoped-7" id="tabIncomeExpenses">
                                    <apex:outputPanel styleClass="slds-indicator-container slds-hide unsaved-abbr">
                                        <abbr class="slds-indicator_unsaved" title="Tab Not Saved" aria-label="Tab Not Saved">*</abbr>
                                    </apex:outputPanel>
                                    Income &amp; Expenses
                                </a>
                            </li>
                            <!--AP2-104 - added by Alvin Aquino -->
                            <li class="slds-text-heading--label slds-vertical-tabs__nav-item {!IF(selectedInternalTab == 'tabExistingCover', 'slds-is-active', '')}"
                                title="Existing Cover" role="presentation">
                                <a class="slds-vertical-tabs__link slds-p-around--x-small" style="color: #66b245; font-weight: bold;" href="#" onclick="selectInternalTab(this); return false;"
                                    role="tab" tabindex="0" aria-selected="true" aria-controls="tab-scoped-11" id="tabExistingCover">
                                    <apex:outputPanel styleClass="slds-indicator-container slds-hide unsaved-abbr">
                                        <abbr class="slds-indicator_unsaved" title="Tab Not Saved" aria-label="Tab Not Saved">*</abbr>
                                    </apex:outputPanel>
                                    Existing Cover
                                </a>
                            </li>
                            <li class="slds-text-heading--label slds-vertical-tabs__nav-item {!IF(selectedInternalTab == 'tabLegalDocuments', 'slds-is-active', '')}"
                                title="Legal Documents" role="presentation">
                                <a class="slds-vertical-tabs__link slds-p-around--x-small" style="color: #66b245; font-weight: bold;" href="#" onclick="selectInternalTab(this); return false;"
                                    role="tab" tabindex="0" aria-selected="true" aria-controls="tab-scoped-8" id="tabLegalDocuments">
                                    <apex:outputPanel styleClass="slds-indicator-container slds-hide unsaved-abbr">
                                        <abbr class="slds-indicator_unsaved" title="Tab Not Saved" aria-label="Tab Not Saved">*</abbr>
                                    </apex:outputPanel>
                                    Legal
                                </a>
                            </li>

                            <!--END of AP2-104 - added by Alvin Aquino -->
                            <li class="slds-text-heading--label slds-vertical-tabs__nav-item {!IF(selectedInternalTab == 'tabCoverGoals', 'slds-is-active', '')}"
                                title="Cover & Goals" role="presentation">
                                <a class="slds-vertical-tabs__link slds-p-around--x-small" style="color: #66b245; font-weight: bold;" href="#" onclick="selectInternalTab(this); return false;"
                                    role="tab" tabindex="0" aria-selected="true" aria-controls="tab-scoped-9" id="tabCoverGoals">
                                    <apex:outputPanel styleClass="slds-indicator-container slds-hide unsaved-abbr">
                                        <abbr class="slds-indicator_unsaved" title="Tab Not Saved" aria-label="Tab Not Saved">*</abbr>
                                    </apex:outputPanel>
                                    Goals &amp; Referrals
                                </a>
                            </li>
                            <li class="slds-text-heading--label slds-vertical-tabs__nav-item {!IF(selectedInternalTab == 'tabSummary', 'slds-is-active', '')}"
                                title="Summary" role="presentation">
                                <a class="slds-vertical-tabs__link slds-p-around--x-small" style="color: #66b245; font-weight: bold;" href="#" onclick="selectInternalTab(this); return false;"
                                    role="tab" tabindex="0" aria-selected="true" aria-controls="tab-scoped-10" id="tabSummary">
                                    Summary
                                </a>
                            </li>
                        </ul>
                        <apex:outputPanel id="internalTabs" styleClass="slds-vertical-tabs__content tabsContent internalTabs">
                            <!-- INTERNAL TAB CONTENTS -->
                            <!-- KNOW YOUR CLIENT - AGENDA -->
                            <div id="tab-scoped-1" class="{!IF(OR(selectedInternalTab == 'tabAgenda', selectedInternalTab == ''), 'slds-show', 'slds-hide')}"
                                role="tabpanel" aria-labelledby="tabAgenda">
                                <div class="slds-section slds-is-open slds-form--compound">
                                    <h3 class="slds-section__title">
                                        <span class="slds-button slds-section__title-action" title="Meeting Agenda">Meeting Agenda</span>
                                    </h3>
                                    <div class="slds-section__content">
                                        <div class="slds-text-heading_small slds-p-top--small">1. What we do</div>
                                        <div class="slds-text-body_regular slds-p-left--medium">Identify how we help.</div>
                                        <div class="slds-text-body_regular slds-p-left--medium">Run through Disclosure Agreement.</div>
                                        <!-- open circle of life popup -->
                                        <div class="slds-m-left--large slds-m-top--x-small">
                                            <apex:image url="{!URLFOR($Resource.Akina, 'images/circleOfLife.jpg')}" styleClass="slds-avatar" onclick="openCircleOfLife();return false;"
                                                style="cursor: pointer; border: 1px solid #66b245" />
                                        </div>

                                        <div class="slds-text-heading_small slds-p-top--small">2. Listen to you and Understand where you are.
                                        </div>
                                        <div class="slds-text-body_regular slds-p-left--medium">Collecting the facts.</div>

                                        <div class="slds-text-heading_small slds-p-top--small">3. Discuss what you want to achieve.</div>
                                        <div class="slds-text-body_regular slds-p-left--medium">Focus on your goals.</div>

                                        <div class="slds-text-heading_small slds-p-top--small">4. What happens next?</div>
                                        <div class="slds-text-body_regular slds-p-left--medium">Go away and formulate written advice.</div>

                                        <div class="slds-text-heading_small slds-p-top--medium">Are there any items you would like to add to the Agenda?
                                        </div>
                                        <div class="slds-form-element slds-p-top--x-small">
                                            <div class="slds-form-element__control">
                                                <apex:inputField styleClass="slds-textarea" value="{!factFind.Agenda_Notes__c}" style="height: 150px;" onchange="markAsChanged('Tab1', 'tabAgenda');"
                                                />
                                            </div>
                                        </div>
                                        <div class="slds-form-element slds-grid slds-p-top--x-small">
                                            <label class="slds-checkbox">
                                                <apex:inputCheckbox styleClass="slds-input" value="{!factfind.Do_Not_Advise_Base_On_Client_Details__c}" onchange="setLimitedAdvice(this); markAsChanged('Tab1', 'tabAgenda');"
                                                />
                                                <span class="slds-checkbox_faux"></span>
                                            </label>
                                            <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">You have instructed me not to determine the suitability of my financial adviser
                                                services to your particular circumstances.</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- KNOW YOUR CLIENT - WHO ARE YOU -->
                            <div id="tab-scoped-2" class="{!IF(selectedInternalTab == 'tabWhoAreYou', 'slds-show', 'slds-hide')}" role="tabpanel" aria-labelledby="tabWhoAreYou">
                                <div class="slds-section slds-is-open slds-form--compound">
                                    <h3 class="slds-section__title">
                                        <span class="slds-button slds-section__title-action" title="Who are you?">Who are you?</span>
                                    </h3>
                                    <div class="slds-section__content">
                                        <apex:outputPanel id="contactTypePanel">
                                            <fieldset class="slds-box slds-theme_default slds-container slds-form-element">
                                                <legend class="slds-form-element__label slds-text-title_caps">Contact Type</legend>
                                                <apex:selectList size="1" id="contactType" value="{!applicationType}" styleClass="slds-select" style="width: 50%;">
                                                    <apex:selectOptions value="{!contactType}" />
                                                    <apex:actionSupport action="{!changeApplicationType}" event="onchange" onsubmit="showSpinner();" reRender="internalTabs,pageNotif,needsPanel"
                                                        onComplete="if({!joint}) markAsChanged('Tab1', 'tabWhoAreYou'); hideSpinner(); hideMessages();"
                                                    />
                                                </apex:selectList>
                                                <apex:outputPanel rendered="{!joint}">
                                                    <div style="padding-top:10px; width:50%;">
                                                        <c:SLDSDynamicLookup SLDSResourceName="$Asset.SLDS" ObjectApiName="Account" JSfunction="client2selected" AdditionalWHEREFilter="isPersonAccount = true"
                                                            DisplayFieldApiNames="Name,Type,Birth_Date_Text__c" DisplayFieldsPattern="Name - Type - Birth_Date_Text__c"
                                                            OnKeyDown="handleKeyDown(event)" photo="url->/img/icon/t4v35/standard/person_account_120.png"
                                                            LabelName="OppJointOwner" PlaceholderText="Search Client 2" showSpinner='true'
                                                            SetValueToField="{!opp.Joint_Owner__c}" />
                                                    </div>
                                                </apex:outputPanel>
                                            </fieldset>
                                        </apex:outputPanel>
                                    </div>
                                    <div class="slds-section__content">
                                        <apex:outputPanel id="clientDetailsPanel">
                                            <fieldset class="slds-box slds-theme_default slds-container slds-form-element">
                                                <legend class="slds-form-element__label slds-text-title_caps">Client Details</legend>
                                                <div class="slds-form-element__group">
                                                    <div class="slds-form-element__row slds-border_bottom" style="height:28px;">
                                                        <div class="slds-size--1-of-5"></div>
                                                        <div class="slds-size--2-of-5">
                                                            <div class="slds-text-heading_small slds-align_absolute-center">{! IF(ISNULL(client1.account.Name), "Client 1", client1.account.Name)}</div>
                                                        </div>
                                                        <div class="slds-size--2-of-5" style="{!IF(single, 'display: none', 'display: block')}">
                                                            <div class="slds-text-heading_small slds-align_absolute-center">{! IF(ISNULL(client2.account.Name), "Client 2", client2.account.Name)}</div>
                                                        </div>
                                                    </div>
                                                    <!-- Title -->
                                                    <div class="slds-form-element__row">
                                                        <div class="slds-size--1-of-5">
                                                            <div class="slds-text-heading_small">Title</div>
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium">
                                                            <apex:selectList size="1" id="salutation1" value="{!client1.account.Salutation}" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                styleClass="slds-select">
                                                                <apex:selectOptions value="{!salutationList}" />
                                                            </apex:selectList>
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium" style="{!IF(single, 'display: none', 'display: block')}">
                                                            <apex:selectList size="1" id="salutation2" value="{!client2.account.Salutation}" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                styleClass="slds-select" disabled="{!single}">
                                                                <apex:selectOptions value="{!salutationList}" />
                                                            </apex:selectList>
                                                        </div>
                                                    </div>
                                                    <!-- First Name -->
                                                    <div class="slds-form-element__row">
                                                        <div class="slds-size--1-of-5">
                                                            <div class="slds-text-heading_small">First Name</div>
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium">
                                                            <apex:inputField value="{!client1.account.FirstName}" styleClass="slds-input" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                html-placeholder="Client 1 first name" />
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium" style="{!IF(single, 'display: none', 'display: block')}">
                                                            <apex:inputText value="{!client2.account.FirstName}" styleClass="slds-input" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                html-placeholder="Client 2 first name" disabled="{!single}" />
                                                        </div>
                                                    </div>
                                                    <!-- Middle Name -->
                                                    <div class="slds-form-element__row">
                                                        <div class="slds-size--1-of-5">
                                                            <div class="slds-text-heading_small">Middle Name</div>
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium">
                                                            <apex:inputField value="{!client1.account.MiddleName}" styleClass="slds-input" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                html-placeholder="Client 1 middle name" />
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium" style="{!IF(single, 'display: none', 'display: block')}">
                                                            <apex:inputText value="{!client2.account.MiddleName}" styleClass="slds-input" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                html-placeholder="Client 2 middle name" disabled="{!single}"
                                                            />
                                                        </div>
                                                    </div>
                                                    <!-- Last Name -->
                                                    <div class="slds-form-element__row">
                                                        <div class="slds-size--1-of-5">
                                                            <div class="slds-text-heading_small">Last Name</div>
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium">
                                                            <apex:inputField value="{!client1.account.LastName}" styleClass="slds-input" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                html-placeholder="Client 1 last name" />
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium" style="{!IF(single, 'display: none', 'display: block')}">
                                                            <apex:inputText value="{!client2.account.LastName}" styleClass="slds-input" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                html-placeholder="Client 2 last name" disabled="{!single}" />
                                                        </div>
                                                    </div>
                                                    <!-- Preferred Name -->
                                                    <div class="slds-form-element__row">
                                                        <div class="slds-size--1-of-5">
                                                            <div class="slds-text-heading_small">Preferred Name</div>
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium">
                                                            <apex:inputField value="{!client1.account.Preferred_Name__pc}" styleClass="slds-input" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                html-placeholder="Client 1 preferred name" />
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium" style="{!IF(single, 'display: none', 'display: block')}">
                                                            <apex:inputText value="{!client2.account.Preferred_Name__pc}" styleClass="slds-input" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                html-placeholder="Client 2 preferred name" disabled="{!single}"
                                                            />
                                                        </div>
                                                    </div>
                                                    <!-- Date of Birth -->
                                                    <div class="slds-form-element__row">
                                                        <div class="slds-size--1-of-5">
                                                            <div class="slds-text-heading_small">Date of Birth</div>
                                                        </div>
                                                        <div class="slds-form-element slds-size--2-of-5 slds-p-right--medium" style="width:40%; padding-left: 0;">
                                                            <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                                                                <c:icon elementId="calDate1" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#event')}" classes="slds-input__icon slds-icon-text-default iconButton"
                                                                />
                                                                <apex:inputText id="date1" value="{!client1.stringDate}" styleClass="slds-input date1" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                    html-placeholder="dd/MM/YYYY" />
                                                            </div>
                                                        </div>
                                                        <div class="slds-form-element slds-size--2-of-5 slds-p-right--medium" style="{!IF(single, 'display: none', 'width:40%; padding-left: 0; display: block')}">
                                                            <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                                                                <apex:outputPanel rendered="{!joint}">
                                                                    <c:icon elementId="calDate2" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#event')}" classes="slds-input__icon slds-icon-text-default iconButton"
                                                                    />
                                                                    <apex:inputText id="date2" value="{!client2.stringDate}" styleClass="slds-input date2" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                        html-placeholder="dd/MM/YYYY" />
                                                                </apex:outputPanel>
                                                                <apex:inputText styleClass="slds-input" html-placeholder="dd/MM/YYYY" disabled="{!single}" onkeydown="handleKeyDown(event)"
                                                                    rendered="{!single}" />
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- Gender -->
                                                    <div class="slds-form-element__row">
                                                        <div class="slds-size--1-of-5">
                                                            <div class="slds-text-heading_small">Gender</div>
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium">
                                                            <apex:inputField value="{!client1.account.Gender__pc}" styleClass="slds-select" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                            />
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium" style="{!IF(single, 'display: none', 'display: block')}">
                                                            <apex:inputField value="{!client2.account.Gender__pc}" styleClass="slds-select" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                rendered="{!joint}" />
                                                            <apex:inputField value="{!client2.account.Gender__pc}" styleClass="slds-select" rendered="{!single}" html-disabled="true"
                                                            />
                                                        </div>
                                                    </div>
                                                    <!-- Smoking Status -->
                                                    <div class="slds-form-element__row">
                                                        <div class="slds-size--1-of-5">
                                                            <div class="slds-text-heading_small">Smoking Status</div>
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium">
                                                            <apex:inputField value="{!client1.account.Smoker__pc}" styleClass="slds-select" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                            />
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium" style="{!IF(single, 'display: none', 'display: block')}">
                                                            <apex:inputField value="{!client2.account.Smoker__pc}" styleClass="slds-select" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                rendered="{!joint}" />
                                                            <apex:inputField value="{!client2.account.Smoker__pc}" styleClass="slds-select" rendered="{!single}" html-disabled="true"
                                                            />
                                                        </div>
                                                    </div>
                                                    <!-- Marital Status -->
                                                    <div class="slds-form-element__row">
                                                        <div class="slds-size--1-of-5">
                                                            <div class="slds-text-heading_small">Marital Status</div>
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium">
                                                            <apex:inputField value="{!client1.account.Marital_Status__pc}" styleClass="slds-select" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                            />
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium" style="{!IF(single, 'display: none', 'display: block')}">
                                                            <apex:inputField value="{!client2.account.Marital_Status__pc}" styleClass="slds-select" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                rendered="{!joint}" />
                                                            <apex:inputField value="{!client2.account.Marital_Status__pc}" styleClass="slds-select" rendered="{!single}" html-disabled="true"
                                                            />
                                                        </div>
                                                    </div>
                                                    <!-- Residency -->
                                                    <div class="slds-form-element__row">
                                                        <div class="slds-size--1-of-5">
                                                            <div class="slds-text-heading_small">Residency</div>
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium">
                                                            <apex:inputField value="{!client1.account.Resident__pc}" styleClass="slds-select" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                            />
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium" style="{!IF(single, 'display: none', 'display: block')}">
                                                            <apex:inputField value="{!client2.account.Resident__pc}" styleClass="slds-select" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                rendered="{!joint}" />
                                                            <apex:inputField value="{!client2.account.Resident__pc}" styleClass="slds-select" rendered="{!single}" html-disabled="true"
                                                            />
                                                        </div>
                                                    </div>
                                                    <!-- Housing Status -->
                                                    <div class="slds-form-element__row">
                                                        <div class="slds-size--1-of-5">
                                                            <div class="slds-text-heading_small">Housing Status</div>
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium">
                                                            <apex:inputField value="{!client1.account.Housing_Status__pc}" styleClass="slds-select" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                            />
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium" style="{!IF(single, 'display: none', 'display: block')}">
                                                            <apex:inputField value="{!client2.account.Housing_Status__pc}" styleClass="slds-select" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                rendered="{!joint}" />
                                                            <apex:inputField value="{!client2.account.Housing_Status__pc}" styleClass="slds-select" rendered="{!single}" html-disabled="true"
                                                            />
                                                        </div>
                                                    </div>

                                                    <!-- Home address -->
                                                    <div class="slds-form-element__row">
                                                        <div class="slds-size--1-of-5">
                                                            <div class="slds-text-heading_small">Home Address</div>
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--small">
                                                            <c:vf_nzPostAddress containerId="client1homeaddress" recordId="{!client1.account.Id}" objectApiName="Account" showMap="false"
                                                                editEnabled="true" editAlwaysEnabled="true" labelToShow="" streetFieldName="PersonOtherStreet"
                                                                streetFieldValue="{!client1.account.PersonOtherStreet}" suburbFieldName="PersonOtherCity"
                                                                suburbFieldValue="{!client1.account.PersonOtherCity}" countryFieldName="PersonOtherCountry"
                                                                countryFieldValue="{!client1.account.PersonOtherCountry}" cityFieldName="PersonOtherState"
                                                                cityFieldValue="{!client1.account.PersonOtherState}" postalCodeFieldName="PersonOtherPostalCode"
                                                                postalCodeFieldValue="{!client1.account.PersonOtherPostalCode}"
                                                                showButtons="false" internationalSearch="true" showAustraliaAsOption="true"
                                                                OnChange="markAsChanged('Tab1', 'tabWhoAreYou');" loadJQuery="false"
                                                            />
                                                            <apex:outputPanel styleClass="slds-form-element__row" rendered="{!joint}">
                                                                <a href="#" onclick="copyAddress('home', 'home', 'client1', 'client2'); markAsChanged('Tab1', 'tabWhoAreYou');" style="text-decoration: underline; font-size: 0.75rem;">Copy to Partner</a>
                                                            </apex:outputPanel>
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--small" style="{!IF(single, 'display: none', 'display: block')}">
                                                            <c:vf_nzPostAddress containerId="client2homeaddress" recordId="{!client2.account.Id}" objectApiName="Account" showMap="false"
                                                                editEnabled="true" editAlwaysEnabled="true" labelToShow="" streetFieldName="PersonOtherStreet"
                                                                streetFieldValue="{!client2.account.PersonOtherStreet}" suburbFieldName="PersonOtherCity"
                                                                suburbFieldValue="{!client2.account.PersonOtherCity}" countryFieldName="PersonOtherCountry"
                                                                countryFieldValue="{!client2.account.PersonOtherCountry}" cityFieldName="PersonOtherState"
                                                                cityFieldValue="{!client2.account.PersonOtherState}" postalCodeFieldName="PersonOtherPostalCode"
                                                                postalCodeFieldValue="{!client2.account.PersonOtherPostalCode}"
                                                                showButtons="false" internationalSearch="true" showAustraliaAsOption="true"
                                                                OnChange="markAsChanged('Tab1', 'tabWhoAreYou');" loadJQuery="false"
                                                            />
                                                            <apex:outputPanel styleClass="slds-form-element__row" rendered="{!joint}">
                                                                <a href="#" onclick="copyAddress('home', 'home', 'client2', 'client1'); markAsChanged('Tab1', 'tabWhoAreYou');" style="text-decoration: underline; font-size: 0.75rem;">Copy to Partner</a>
                                                            </apex:outputPanel>
                                                        </div>
                                                    </div>
                                                    <!-- Postal Address -->
                                                    <div class="slds-form-element__row">
                                                        <div class="slds-size--1-of-5">
                                                            <div class="slds-text-heading_small">Postal Address</div>
                                                        </div>
                                                        <div class="slds-size--2-of-5">
                                                            <label class="slds-checkbox">
                                                                <apex:inputCheckbox styleClass="slds-input" value="{!client1.differentAddresses}" html-data-id="differentPrimaryPostalAddressCheckbox"
                                                                    onchange="showHidePostalAddress('primary')" />
                                                                <span class="slds-checkbox_faux"></span>
                                                            </label>
                                                            <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">Different Postal Address?</span>
                                                        </div>
                                                        <div class="slds-size--2-of-5" style="{!IF(single, 'display: none', 'display: block')}">
                                                            <label class="slds-checkbox">
                                                                <apex:inputCheckbox styleClass="slds-input" value="{!client2.differentAddresses}" html-data-id="differentJointPostalAddressCheckbox"
                                                                    onchange="showHidePostalAddress('joint')" />
                                                                <span class="slds-checkbox_faux"></span>
                                                            </label>
                                                            <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">Different Postal Address?</span>
                                                        </div>
                                                    </div>
                                                    <div class="slds-form-element__row">
                                                        <div class="slds-size--1-of-5" />
                                                        <div class="slds-size--2-of-5 slds-p-right--small">
                                                            <div class="{!IF(client1.differentAddresses, 'slds-show', 'slds-hide')}" id="primary-postalAddress">
                                                                <c:vf_nzPostAddress containerId="client1postaladdress" recordId="{!client1.account.Id}" objectApiName="Account" showMap="false"
                                                                    editEnabled="true" editAlwaysEnabled="true" labelToShow=""
                                                                    streetFieldName="PersonMailingStreet" streetFieldValue="{!client1.account.PersonMailingStreet}"
                                                                    suburbFieldName="PersonMailingCity" suburbFieldValue="{!client1.account.PersonMailingCity}"
                                                                    countryFieldName="PersonMailingCountry" countryFieldValue="{!client1.account.PersonMailingCountry}"
                                                                    cityFieldName="PersonMailingState" cityFieldValue="{!client1.account.PersonMailingState}"
                                                                    postalCodeFieldName="PersonMailingPostalCode" postalCodeFieldValue="{!client1.account.PersonMailingPostalCode}"
                                                                    showButtons="false" internationalSearch="true" showAustraliaAsOption="true"
                                                                    OnChange="markAsChanged('Tab1', 'tabWhoAreYou');" loadJQuery="false"
                                                                />
                                                                <apex:outputPanel styleClass="slds-form-element__row" rendered="{!joint}">
                                                                    <a href="#" onclick="copyAddress('postal', 'postal', 'client1', 'client2'); markAsChanged('Tab1', 'tabWhoAreYou');" style="text-decoration: underline; font-size: 0.75rem;">Copy to Partner</a>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--small" style="{!IF(single, 'display: none', 'display: block')}">
                                                            <div class="{!IF(client2.differentAddresses, 'slds-show', 'slds-hide')}" id="joint-postalAddress">
                                                                <c:vf_nzPostAddress containerId="client2postaladdress" recordId="{!client2.account.Id}" objectApiName="Account" showMap="false"
                                                                    editEnabled="true" editAlwaysEnabled="true" labelToShow=""
                                                                    streetFieldName="PersonMailingStreet" streetFieldValue="{!client2.account.PersonMailingStreet}"
                                                                    suburbFieldName="PersonMailingCity" suburbFieldValue="{!client2.account.PersonMailingCity}"
                                                                    countryFieldName="PersonMailingCountry" countryFieldValue="{!client2.account.PersonMailingCountry}"
                                                                    cityFieldName="PersonMailingState" cityFieldValue="{!client2.account.PersonMailingState}"
                                                                    postalCodeFieldName="PersonMailingPostalCode" postalCodeFieldValue="{!client2.account.PersonMailingPostalCode}"
                                                                    showButtons="false" internationalSearch="true" showAustraliaAsOption="true"
                                                                    OnChange="markAsChanged('Tab1', 'tabWhoAreYou');" loadJQuery="false"
                                                                />
                                                                <apex:outputPanel styleClass="slds-form-element__row" rendered="{!joint}">
                                                                    <a href="#" onclick="copyAddress('postal', 'postal', 'client2', 'client1'); markAsChanged('Tab1', 'tabWhoAreYou');" style="text-decoration: underline; font-size: 0.75rem;">Copy to Partner</a>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- Contact Details -->
                                                    <div class="slds-form-element__row">
                                                        <div class="slds-size--1-of-5">
                                                            <div class="slds-text-heading_small">Contact Details</div>
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium">
                                                            <div class="slds-form-element__group">
                                                                <div class="slds-form-element__row">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label">Country Code</label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:inputField value="{!client1.account.Country_Code__pc}" styleClass="slds-input" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                                html-placeholder="" />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="slds-form-element__row">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label">Mobile</label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:inputField value="{!client1.account.PersonMobilePhone}" styleClass="slds-input" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                                html-placeholder="" />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="slds-form-element__row">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label">Home Phone</label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:inputField value="{!client1.account.PersonHomePhone}" styleClass="slds-input" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                                html-placeholder="" />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="slds-form-element__row">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label">Business Phone</label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:inputField value="{!client1.account.Phone}" styleClass="slds-input" html-placeholder="" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                                onkeydown="handleKeyDown(event)" />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium" style="{!IF(single, 'display: none', 'display: block')}">
                                                            <div class="slds-form-element__group">
                                                                <div class="slds-form-element__row">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label">Country Code</label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:inputField value="{!client2.account.Country_Code__pc}" styleClass="slds-input" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                                html-placeholder="" />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="slds-form-element__row">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label">Mobile</label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:inputText value="{!client2.account.PersonMobilePhone}" styleClass="slds-input" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                                html-placeholder="" disabled="{!single}" />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="slds-form-element__row">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label">Home Phone</label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:inputText value="{!client2.account.PersonHomePhone}" styleClass="slds-input" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                                html-placeholder="" disabled="{!single}" />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="slds-form-element__row">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label">Business Phone</label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:inputText value="{!client2.account.Phone}" styleClass="slds-input" html-placeholder="" onkeydown="handleKeyDown(event)"
                                                                                onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                                disabled="{!single}" />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- Email Address -->
                                                    <div class="slds-form-element__row">
                                                        <div class="slds-size--1-of-5">
                                                            <div class="slds-text-heading_small">Email Address</div>
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium">
                                                            <div class="slds-form-element__group">
                                                                <div class="slds-form-element__row">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label">Preferred Email</label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:inputField value="{!client1.account.PersonEmail}" styleClass="slds-input" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                                html-data-id="client1Email" html-placeholder=""
                                                                            />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="slds-form-element__row">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label">Home</label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:inputField value="{!client1.account.Other_Email__pc}" styleClass="slds-input" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                                html-placeholder="" />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="slds-form-element__row">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label">Business</label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:inputField value="{!client1.account.Business_Email__c}" styleClass="slds-input" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                                html-placeholder="" />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="slds-size--2-of-5 slds-p-right--medium" style="{!IF(single, 'display: none', 'display: block')}">
                                                            <div class="slds-form-element__group">
                                                                <div class="slds-form-element__row">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label">Preferred Email</label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:inputField value="{!client2.account.PersonEmail}" styleClass="slds-input" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                                html-placeholder="" rendered="{!joint}" />
                                                                            <apex:inputField value="{!client2.account.PersonEmail}" styleClass="slds-input" html-placeholder="" rendered="{!single}"
                                                                                html-disabled="true" />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="slds-form-element__row">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label">Home</label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:inputField value="{!client2.account.Other_Email__pc}" styleClass="slds-input" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                                html-placeholder="" rendered="{!joint}" />
                                                                            <apex:inputField value="{!client2.account.Other_Email__pc}" styleClass="slds-input" html-placeholder="" rendered="{!single}"
                                                                                html-disabled="true" />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="slds-form-element__row">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label">Business</label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:inputField value="{!client2.account.Business_Email__c}" styleClass="slds-input" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabWhoAreYou');"
                                                                                html-placeholder="" rendered="{!joint}" />
                                                                            <apex:inputField value="{!client2.account.Business_Email__c}" styleClass="slds-input" html-placeholder="" rendered="{!single}"
                                                                                html-disabled="true" />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </fieldset>
                                        </apex:outputPanel>
                                    </div>
                                </div>
                            </div>

                            <!-- KNOW YOUR CLIENT - YOUR FAMILY -->
                            <div id="tab-scoped-3" class="{!IF(selectedInternalTab == 'tabYourFamily', 'slds-show', 'slds-hide')}" role="tabpanel" aria-labelledby="tabYourFamily">
                                <div class="slds-section slds-is-open slds-form--compound">
                                    <h3 class="slds-section__title">
                                        <span class="slds-button slds-section__title-action">Who relies on you?</span>
                                    </h3>
                                    <div class="slds-section__content">
                                        <fieldset class="slds-box slds-theme_default slds-container slds-form-element">
                                            <legend class="slds-form-element__label slds-text-title_caps">Your Family Details</legend>
                                            <div id="familyDetailsChkBoxesContext" class="slds-form-element__control">
                                                <div class="slds-grid">
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox styleClass="slds-input" value="{!factFind.No_Dependents__c}" html-data-id="noFamilyMembers" onchange="selectChkBox(this, true, 'familyDetailsChkBoxesContext'); markAsChanged('Tab1', 'tabYourFamily');"
                                                        />
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                    <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">You have no dependants</span>
                                                </div>
                                                <div class="slds-grid">
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox styleClass="slds-input limitedAdvice" html-data-id="chosenNotToProvideFamilyMembers" value="{!factFind.Chosen_Not_to_Provide_Dependents_Details__c}"
                                                            onchange="selectChkBox(this, true, 'familyDetailsChkBoxesContext'); markAsChanged('Tab1', 'tabYourFamily');"
                                                        />
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                    <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">You choose not to provide/update these details</span>
                                                </div>
                                            </div>
                                            <apex:outputPanel id="familyDetailsPanel">
                                                <div class="slds-border--top slds-grid slds-m-top--medium slds-wrap">
                                                    <!-- Existing Family Member -->
                                                    <apex:repeat value="{!familyMemberWrappers}" var="member">
                                                        <apex:outputPanel rendered="{!!familyMembersIsEmpty}" styleClass="slds-box slds-medium-size--1-of-3 slds-size--1-of-1 slds-large-size--1-of-5 slds-p-around--small slds-m-around--small"
                                                            style="background-color: rgb(235, 235, 235);">
                                                            <div class="slds-form-element__row slds-p-around--xx-small">
                                                                <div class="slds-size--1-of-2">
                                                                    <span class="label">Name</span>
                                                                </div>
                                                                <div class="slds-size--1-of-2">
                                                                    <apex:outputText value="{!member.account.Name}" />
                                                                </div>
                                                            </div>
                                                            <div class="slds-form-element__row slds-p-around--xx-small">
                                                                <div class="slds-size--1-of-2">
                                                                    <span class="label">Relationship</span>
                                                                </div>
                                                                <div class="slds-size--1-of-2">
                                                                    <apex:outputText value="{!member.relationship.Relationship_Type__c}" />
                                                                </div>
                                                            </div>
                                                            <div class="slds-form-element__row slds-p-around--xx-small">
                                                                <div class="slds-size--1-of-2">
                                                                    <span class="label">Date of Birth</span>
                                                                </div>
                                                                <div class="slds-size--1-of-2">
                                                                    <apex:outputText value="{!member.stringDate}" />
                                                                </div>
                                                            </div>
                                                            <div class="slds-form-element__row slds-p-around--xx-small">
                                                                <div class="slds-size--1-of-2">
                                                                    <span class="label">Dependant?</span>
                                                                </div>
                                                                <div class="slds-size--1-of-2">
                                                                    <apex:outputText value="{!member.relationship.Dependant__c}" />
                                                                </div>
                                                            </div>
                                                            <apex:outputPanel layout="none" rendered="{!member.relationship.Dependant__c == 'Yes'}">
                                                                <div class="slds-form-element__row slds-p-around--xx-small">
                                                                    <div class="slds-size--1-of-2">
                                                                        <span class="label">Dependant until</span>
                                                                    </div>
                                                                    <div class="slds-size--1-of-2">
                                                                        <apex:outputText value="{!member.account.Dependant_until_age__pc}" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <div class="slds-form-element__row slds-float--right">
                                                                <div class="slds-align_absolute-center slds-size--1-of-1">
                                                                    <apex:commandLink html-data-toggle="tooltip" html-data-placement="top" styleClass="slds-button slds-button_brand active-btn"
                                                                        title="Edit" value="Edit" action="{!addEditFamilyMember}"
                                                                        reRender="familyMemberDialog" onClick="showSpinner()"
                                                                        onComplete="hideSpinner(); openDialog('familyMember');">
                                                                        <apex:param name="familyMemberAddEditType" value="edit" assignTo="{!familyMemberAddEditType}" />
                                                                        <apex:param name="memberAccountId" value="{!member.account.Id}" />
                                                                    </apex:commandLink>
                                                                    <c:icon elementId="delMember-{!member.account.Id}" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#delete')}"
                                                                        classes="slds-m-left--medium iconButton icon-secondary slds-icon--small"
                                                                        onclick="confirmDelete('Relationship', '{!member.account.Id}', '{!member.tempId}', 'relationship {!member.account.Name}'); return false;"
                                                                    />
                                                                </div>
                                                            </div>
                                                        </apex:outputPanel>
                                                    </apex:repeat>
                                                </div>
                                                <apex:outputPanel rendered="{!familyMembersIsEmpty}">
                                                    <div class="slds-form-element__row" data-id="familyMembersEmpty">
                                                        <div class="slds-size--1-of-1">
                                                            <div class="slds-text-heading_small slds-align_absolute-center">
                                                                <i>No Relationships Added</i>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </apex:outputPanel>
                                                <apex:commandLink html-data-toggle="tooltip" html-data-placement="top" styleClass="slds-button slds-button_brand slds-float_right active-btn"
                                                    title="Add Relationship" value="Add Relationship" action="{!addEditFamilyMember}"
                                                    reRender="familyMemberDialog" onClick="showSpinner()" onComplete="hideSpinner(); openDialog('familyMember', true);">
                                                    <apex:param name="familyMemberAddEditType" value="add" assignTo="{!familyMemberAddEditType}" />
                                                    <apex:param name="memberAccountId" value="" />
                                                </apex:commandLink>
                                            </apex:outputPanel>
                                            <div class="slds-form-element slds-m-top--x-large">
                                                <label class="slds-form-element__label">Notes</label>
                                                <div class="slds-form-element__control">
                                                    <apex:inputField styleClass="slds-textarea" value="{!factFind.Dependent_Notes__c}" onchange="markAsChanged('Tab1', 'tabYourFamily');"
                                                        style="height: 150px;" />
                                                </div>
                                            </div>
                                        </fieldset>
                                    </div>
                                </div>
                            </div>

                            <!-- KNOW YOUR CLIENT - EMPLOYMENT -->
                            <div id="tab-scoped-4" class="{!IF(selectedInternalTab == 'tabEmployment', 'slds-show', 'slds-hide')}" role="tabpanel" aria-labelledby="tabEmployment">
                                <!-- Div WHERE DO YOU WORK-->
                                <div class="slds-section slds-is-open slds-form--compound">
                                    <h3 class="slds-section__title">
                                        <span class="slds-button slds-section__title-action" title="Where do you work?">Where do you work?</span>
                                    </h3>
                                    <div class="slds-section__content">
                                        <apex:outputPanel id="employmentPanel">
                                            <fieldset class="slds-box slds-theme_default slds-container slds-form-element">
                                                <legend class="slds-form-element__label slds-text-title_caps">Employment Details</legend>
                                                <div class="slds-form-element__control">
                                                    <div class="slds-grid">
                                                        <label class="slds-checkbox">
                                                            <apex:inputCheckbox styleClass="slds-input limitedAdvice" onchange="markAsChanged('Tab1', 'tabEmployment');" html-data-id="chosenNotToProvideEmployments"
                                                                value="{!factFind.Chosen_Not_to_Provide_Employment_Details__c}"
                                                            />
                                                            <span class="slds-checkbox_faux"></span>
                                                        </label>
                                                        <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">You choose not to provide/update these details</span>
                                                    </div>
                                                </div>
                                                <div class="slds-grid">
                                                    <div class="slds-col slds-form-element__group" id="client1EmploymentDiv" style="padding-top: 10px;">
                                                        <div class="slds-form-element__row slds-border_bottom" style="height:28px;">
                                                            <div class="apex-half-width"></div>
                                                            <div class="apex-half-width">
                                                                <div class="slds-text-heading_small slds-align_absolute-center">{!IF(ISNULL(client1.account.Name), "Client 1", client1.account.Name)}</div>
                                                            </div>
                                                        </div>
                                                        <apex:outputPanel id="client1Employment">
                                                            <apex:repeat value="{!employment[client1Type]}" var="employmentRec">
                                                                <!-- Employment Status -->
                                                                <div class="slds-form-element__row">
                                                                    <div class="apex-half-width">
                                                                        <div class="slds-text-heading_small">Employment Status</div>
                                                                    </div>
                                                                    <div class="apex-half-width">
                                                                        <apex:inputField value="{!employmentRec.employment.Status__c}" styleClass="slds-select" onchange="markAsChanged('Tab1', 'tabEmployment');"
                                                                            style="width:97%;" />
                                                                    </div>
                                                                </div>
                                                                <!-- Job Title -->
                                                                <div class="slds-form-element__row">
                                                                    <div class="apex-half-width">
                                                                        <div class="slds-text-heading_small">Job Title</div>
                                                                    </div>
                                                                    <div class="apex-half-width">
                                                                        <apex:inputText value="{!employmentRec.employment.Job_Title__c}" styleClass="slds-input" onkeydown="handleKeyDown(event)"
                                                                            onchange="markAsChanged('Tab1', 'tabEmployment');"
                                                                            html-placeholder="{!IF(ISNULL(client1.account.Name), "
                                                                            Client 1 Job Title ", (client1.account.Name + "&#39;s
                                                                            Job Title "))}" style="width:97%;" />
                                                                    </div>
                                                                </div>
                                                                <!-- Employer Name -->
                                                                <div class="slds-form-element__row">
                                                                    <div class="apex-half-width">
                                                                        <div class="slds-text-heading_small">Employer Name</div>
                                                                    </div>
                                                                    <div class="apex-half-width">
                                                                        <apex:inputText value="{!employmentRec.employment.Employer__c}" styleClass="slds-input" onkeydown="handleKeyDown(event)"
                                                                            onchange="markAsChanged('Tab1', 'tabEmployment');"
                                                                            html-placeholder="{!IF(ISNULL(client1.account.Name), "
                                                                            Client 1 Employer Name
                                                                            ", (client1.account.Name + "&#39;s Employer Name "))}" style="width:97%;" />
                                                                    </div>
                                                                </div>
                                                                <!-- Main Source of Income -->
                                                                <div class="slds-form-element__row">
                                                                    <div class="apex-half-width">
                                                                        <div class="slds-text-heading_small">Main Source of Income</div>
                                                                    </div>
                                                                    <div class="apex-half-width">
                                                                        <apex:inputField value="{!employmentRec.employment.Main_Source_of_Income__c}" onchange="markAsChanged('Tab1', 'tabEmployment');"
                                                                            styleClass="slds-select" style="width:97%;" />
                                                                    </div>
                                                                </div>
                                                                <!--Start Date -->
                                                                <div class="slds-form-element__row">
                                                                    <div class="apex-half-width">
                                                                        <div class="slds-text-heading_small">Start Date</div>
                                                                    </div>
                                                                    <div class="slds-form-element" style="width:50%; padding-left: 0;">
                                                                        <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right" style="width:97%">
                                                                            <c:icon elementId="calEmp1Start-{!employmentRec.employment.Id}" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#event')}"
                                                                                classes="slds-input__icon slds-icon-text-default iconButton"
                                                                            />
                                                                            <apex:inputText value="{!employmentRec.startDate}" styleClass="slds-input date-start-{!employmentRec.employment.Id}" onkeydown="handleKeyDown(event)"
                                                                                onchange="markAsChanged('Tab1', 'tabEmployment');"
                                                                                html-placeholder="dd/MM/YYYY" />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!--End Date -->
                                                                <div class="slds-form-element__row">
                                                                    <div class="apex-half-width">
                                                                        <div class="slds-text-heading_small">End Date</div>
                                                                    </div>
                                                                    <div class="slds-form-element" style="width:50%; padding-left: 0;">
                                                                        <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right" style="width:97%">
                                                                            <c:icon elementId="calEmp1End-{!employmentRec.employment.Id}" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#event')}"
                                                                                classes="slds-input__icon slds-icon-text-default iconButton"
                                                                            />
                                                                            <apex:inputText value="{!employmentRec.endDate}" styleClass="slds-input date-end-{!employmentRec.employment.Id}" onkeydown="handleKeyDown(event)"
                                                                                onchange="markAsChanged('Tab1', 'tabEmployment');"
                                                                                html-placeholder="dd/MM/YYYY" />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- Current Occupation -->
                                                                <div class="slds-form-element__row">
                                                                    <div class="apex-half-width">
                                                                        <div class="slds-text-heading_small">Current Occupation</div>
                                                                    </div>
                                                                    <div class="apex-half-width slds-text-align_center">
                                                                        <label class="slds-checkbox">
                                                                            <apex:inputCheckbox styleClass="slds-input" onchange="markAsChanged('Tab1', 'tabEmployment');" value="{!employmentRec.employment.Current_Occupation__c}"
                                                                            />
                                                                            <span class="slds-checkbox_faux"></span>
                                                                            <span class="slds-form-element__label slds-assistive-text">Current Occupation?</span>
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                                <div class="slds-form-element__row">
                                                                    <div style="width: 100%">
                                                                        <c:icon elementId="delEmp1-{!employmentRec.employment.Id}" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#delete')}"
                                                                            classes="slds-float_right slds-m-right--small iconButton slds-icon--small icon-secondary"
                                                                            onclick="confirmDelete('Employment', '{!employmentRec.employment.Id}', '{!employmentRec.tempId}', 'Employment {!employmentRec.employment.Job_Title__c}'); return false;"
                                                                        />
                                                                    </div>
                                                                </div>
                                                                <div class="slds-m-top_x-large"></div>
                                                            </apex:repeat>
                                                            <apex:outputPanel rendered="{!client1EmploymentIsEmpty}">
                                                                <div class="slds-form-element__row" data-id="employmentClient1Empty">
                                                                    <div style="width:100%;">
                                                                        <div class="slds-text-heading_small slds-align_absolute-center">
                                                                            <i>No Employment Details Added</i>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:commandButton value="Add Employment" rerender="client1Employment" action="{!addEmployment}" styleClass="slds-button slds-button_brand slds-float_right active-btn"
                                                                title="Add Client 1 Employment" style="{!IF(client1EmploymentIsEmpty, 'margin-top:10px;', '')} margin-bottom:10px; margin-right:10px;"
                                                                onclick="showSpinner();" oncomplete="setDatePickers(); hideSpinner();">
                                                                <apex:param name="employmentKey1" value="Client 1" assignTo="{!keys}" />
                                                            </apex:commandButton>
                                                        </apex:outputPanel>
                                                    </div>
                                                    <div class="slds-col slds-form-element__group" id="client2EmploymentDiv" style="{!IF(single, 'display: none', 'padding-top: 10px; display: block')}">
                                                        <div class="slds-form-element__row slds-border_bottom" style="height:28px;">
                                                            <div class="apex-half-width"></div>
                                                            <div class="apex-half-width">
                                                                <div class="slds-text-heading_small slds-align_absolute-center">{!IF(ISNULL(client2.account.Name), "Client 2", client2.account.Name)}</div>
                                                            </div>
                                                        </div>
                                                        <apex:outputPanel id="client2Employment">
                                                            <apex:repeat value="{!employment[client2Type]}" var="employmentRec">
                                                                <!-- Employment Status -->
                                                                <div class="slds-form-element__row">
                                                                    <div class="apex-half-width">
                                                                        <div class="slds-text-heading_small">Employment Status</div>
                                                                    </div>
                                                                    <div class="apex-half-width">
                                                                        <apex:inputField value="{!employmentRec.employment.Status__c}" styleClass="slds-select" onchange="markAsChanged('Tab1', 'tabEmployment');"
                                                                            style="width:97%;" rendered="{!joint}" />
                                                                        <apex:inputField value="{!employmentRec.employment.Status__c}" styleClass="slds-select" style="width:97%;" rendered="{!single}"
                                                                            html-disabled="true" />
                                                                    </div>
                                                                </div>
                                                                <!-- Job Title -->
                                                                <div class="slds-form-element__row">
                                                                    <div class="apex-half-width">
                                                                        <div class="slds-text-heading_small">Job Title</div>
                                                                    </div>
                                                                    <div class="apex-half-width">
                                                                        <apex:inputText value="{!employmentRec.employment.Job_Title__c}" styleClass="slds-input" onkeydown="handleKeyDown(event)"
                                                                            onchange="markAsChanged('Tab1', 'tabEmployment');"
                                                                            html-placeholder="{!IF(ISNULL(client2.account.Name), "
                                                                            Client 2 Job Title ", (client2.account.Name + "&#39;s
                                                                            Job Title "))}" style="width:97%;" disabled="{!single}"
                                                                        />
                                                                    </div>
                                                                </div>
                                                                <!-- Employer Name -->
                                                                <div class="slds-form-element__row">
                                                                    <div class="apex-half-width">
                                                                        <div class="slds-text-heading_small">Employer Name</div>
                                                                    </div>
                                                                    <div class="apex-half-width">
                                                                        <apex:inputText value="{!employmentRec.employment.Employer__c}" styleClass="slds-input" onkeydown="handleKeyDown(event)"
                                                                            onchange="markAsChanged('Tab1', 'tabEmployment');"
                                                                            html-placeholder="{!IF(ISNULL(client2.account.Name), "
                                                                            Client 2 Employer Name
                                                                            ", (client2.account.Name + "&#39;s Employer Name "))}" style="width:97%;" disabled="{!single}"
                                                                        />
                                                                    </div>
                                                                </div>
                                                                <!-- Main Source of Income -->
                                                                <div class="slds-form-element__row">
                                                                    <div class="apex-half-width">
                                                                        <div class="slds-text-heading_small">Main Source of Income</div>
                                                                    </div>
                                                                    <div class="apex-half-width">
                                                                        <apex:inputField value="{!employmentRec.employment.Main_Source_of_Income__c}" onchange="markAsChanged('Tab1', 'tabEmployment');"
                                                                            styleClass="slds-select" style="width:97%;" rendered="{!joint}"
                                                                        />
                                                                        <apex:inputField value="{!employmentRec.employment.Main_Source_of_Income__c}" styleClass="slds-select" style="width:97%;"
                                                                            rendered="{!single}" html-disabled="true" />
                                                                    </div>
                                                                </div>
                                                                <!-- Start Date -->
                                                                <div class="slds-form-element__row">
                                                                    <div class="apex-half-width">
                                                                        <div class="slds-text-heading_small">Start Date</div>
                                                                    </div>
                                                                    <div class="slds-form-element" style="width:50%; padding-left: 0;">
                                                                        <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right" style="width:97%">
                                                                            <c:icon elementId="calEmp2Start-{!employmentRec.employment.Id}" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#event')}"
                                                                                classes="slds-input__icon slds-icon-text-default iconButton"
                                                                            />
                                                                            <apex:inputText value="{!employmentRec.startDate}" styleClass="slds-input date-{!employmentRec.employment.Id}" onkeydown="handleKeyDown(event)"
                                                                                onchange="markAsChanged('Tab1', 'tabEmployment');"
                                                                                html-placeholder="dd/MM/YYYY" />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- End Date -->
                                                                <div class="slds-form-element__row">
                                                                    <div class="apex-half-width">
                                                                        <div class="slds-text-heading_small">End Date</div>
                                                                    </div>
                                                                    <div class="slds-form-element" style="width:50%; padding-left: 0;">
                                                                        <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right" style="width:97%">
                                                                            <c:icon elementId="calEmp2End-{!employmentRec.employment.Id}" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#event')}"
                                                                                classes="slds-input__icon slds-icon-text-default iconButton"
                                                                            />
                                                                            <apex:inputText value="{!employmentRec.endDate}" styleClass="slds-input date-end-{!employmentRec.employment.Id}" onkeydown="handleKeyDown(event)"
                                                                                onchange="markAsChanged('Tab1', 'tabEmployment');"
                                                                                html-placeholder="dd/MM/YYYY" />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- Current Occupation -->
                                                                <div class="slds-form-element__row">
                                                                    <div class="apex-half-width">
                                                                        <div class="slds-text-heading_small">Current Occupation</div>
                                                                    </div>
                                                                    <div class="apex-half-width slds-text-align_center">
                                                                        <label class="slds-checkbox">
                                                                            <apex:inputCheckbox styleClass="slds-input" onchange="markAsChanged('Tab1', 'tabEmployment');" value="{!employmentRec.employment.Current_Occupation__c}"
                                                                                disabled="{!single}" />
                                                                            <span class="slds-checkbox_faux"></span>
                                                                            <span class="slds-form-element__label slds-assistive-text">Current Occupation?</span>
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                                <div class="slds-form-element__row">
                                                                    <div style="width: 100%">
                                                                        <c:icon elementId="delEmp2-{!employmentRec.employment.Id}" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#delete')}"
                                                                            classes="slds-float_right slds-m-right--small iconButton slds-icon--small icon-secondary"
                                                                            onclick="confirmDelete('Employment', '{!employmentRec.employment.Id}', '{!employmentRec.tempId}', 'Employment {!employmentRec.employment.Job_Title__c}'); return false;"
                                                                        />
                                                                    </div>
                                                                </div>
                                                                <div class="slds-m-top_x-large"></div>
                                                            </apex:repeat>
                                                            <apex:outputPanel rendered="{!client2EmploymentIsEmpty}">
                                                                <div class="slds-form-element__row" data-id="employmentClient2Empty">
                                                                    <div style="width:100%;">
                                                                        <div class="slds-text-heading_small slds-align_absolute-center">
                                                                            <i>No Employment Details Added</i>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:commandButton value="Add Employment" rerender="client2Employment" action="{!addEmployment}" styleClass="slds-button {!IF(single, 'slds-button_neutral', 'slds-button_brand')} slds-float_right client2-btn"
                                                                title="{!IF(single, 'Joint Type not selected', 'Add Client 2 Employment')}"
                                                                disabled="{!single}" style="{!IF(client2EmploymentIsEmpty, 'margin-top:10px;', '')} margin-bottom:10px; margin-right:10px;"
                                                                onclick="showSpinner();" oncomplete="setDatePickers(); hideSpinner();">
                                                                <apex:param name="employmentKey2" value="Client 2" assignTo="{!keys}" />
                                                            </apex:commandButton>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </fieldset>
                                        </apex:outputPanel>
                                    </div>
                                </div>
                            </div>

                            <!-- KNOW YOUR CLIENT - OTHER ENTITIES -->
                            <div id="tab-scoped-5" class="{!IF(selectedInternalTab == 'tabOtherEntities', 'slds-show', 'slds-hide')}" role="tabpanel"
                                aria-labelledby="tabOtherEntities">
                                <div class="slds-section slds-is-open slds-form--compound">
                                    <h3 class="slds-section__title">
                                        <span class="slds-button slds-section__title-action" title="Where do you work?">Other Entities</span>
                                    </h3>
                                    <div class="slds-section__content">
                                        <fieldset class="slds-box slds-theme_default slds-container slds-form-element">
                                            <legend class="slds-form-element__label slds-text-title_caps">Other Entity Details</legend>
                                            <div id="otherEntitiesChkBoxesContext" class="slds-form-element__control">
                                                <div class="slds-grid">
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox styleClass="slds-input" value="{!factFind.No_Other_Entities__c}" html-data-id="noOtherEntities" onchange="selectChkBox(this, true, 'otherEntitiesChkBoxesContext'); markAsChanged('Tab1', 'tabOtherEntities');"
                                                        />
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                    <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">You have no Other Entities</span>
                                                </div>
                                                <div class="slds-grid">
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox styleClass="slds-input limitedAdvice" value="{!factFind.Chosen_Not_to_Provide_Other_Entities__c}" html-data-id="chosenNotToProvideOtherEntities"
                                                            onchange="selectChkBox(this, true, 'otherEntitiesChkBoxesContext'); markAsChanged('Tab1', 'tabOtherEntities');"
                                                        />
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                    <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">You choose not to provide/update these details</span>
                                                </div>
                                            </div>
                                            <apex:outputPanel id="otherEntitiesPanel">
                                                <div class="slds-border--top slds-grid slds-m-top--medium slds-wrap">
                                                    <!-- Existing Entities -->
                                                    <apex:repeat value="{!otherEntitiesWrappers}" var="otherEntity">
                                                        <apex:outputPanel rendered="{!otherEntity.roles.size > 0}" styleClass="slds-box slds-medium-size--1-of-3 slds-size--1-of-1 slds-large-size--1-of-5 slds-p-around--small slds-m-around--small"
                                                            style="background-color: rgb(235, 235, 235);">
                                                            <div class="slds-form-element__row slds-p-around--xx-small">
                                                                <div class="slds-size--1-of-3">
                                                                    <span class="label">Type of Entity</span>
                                                                </div>
                                                                <div class="slds-size--2-of-3">
                                                                    <apex:outputText value="{!otherEntity.account.Type}"></apex:outputText>
                                                                </div>
                                                            </div>
                                                            <div class="slds-form-element__row slds-p-around--xx-small">
                                                                <div class="slds-size--1-of-3">
                                                                    <span class="label">Entity Name</span>
                                                                </div>
                                                                <div class="slds-size--2-of-3">
                                                                    <apex:outputText value="{!otherEntity.account.Name}"></apex:outputText>
                                                                </div>
                                                            </div>
                                                            <div class="slds-form-element__row slds-p-around--xx-small">
                                                                <div class="slds-size--1-of-3">
                                                                    <span class="label">Roles</span>
                                                                </div>
                                                                <div class="slds-size--2-of-3">
                                                                    <apex:repeat value="{!otherEntity.roles}" var="oeRoles">
                                                                        <div class="slds-form-element__row">
                                                                            <apex:outputText value="{!oeRoles.relationship.Account__r.Name} - {!oeRoles.relationship.Relationship_Type__c}" escape="false"></apex:outputText>
                                                                        </div>
                                                                    </apex:repeat>
                                                                </div>
                                                            </div>
                                                            <div class="slds-form-element__row slds-float--right">
                                                                <div class="slds-align_absolute-center slds-size--1-of-1">
                                                                    <apex:commandLink html-data-toggle="tooltip" html-data-placement="top" styleClass="slds-button slds-button_brand active-btn"
                                                                        title="Edit Entity" value="Edit Entity" action="{!addEditOtherEntity}"
                                                                        reRender="otherEntititiesDialog" onClick="showSpinner()"
                                                                        onComplete="hideSpinner(); openDialog('otherEntities');">
                                                                        <apex:param name="otherEntityAddEditType" value="edit" assignTo="{!otherEntityAddEditType}" />
                                                                        <apex:param name="otherEntityAccountId" value="{!otherEntity.account.Id}" />
                                                                    </apex:commandLink>
                                                                    <c:icon elementId="delOtherEntity-{!otherEntity.tempId}" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#delete')}"
                                                                        classes="slds-m-left--medium iconButton icon-secondary slds-icon--small"
                                                                        onclick="confirmDelete('Other Entity', null, '{!otherEntity.tempId}', 'roles related to entity {!otherEntity.account.Name}'); return false;"
                                                                    />
                                                                </div>
                                                            </div>
                                                        </apex:outputPanel>
                                                    </apex:repeat>
                                                </div>
                                                <apex:outputPanel rendered="{!otherEntitiesIsEmpty}">
                                                    <div class="slds-form-element__row" data-id="otherEntitiesEmpty">
                                                        <div class="slds-size--1-of-1">
                                                            <div class="slds-text-heading_small slds-align_absolute-center">
                                                                <i>No Entities Added</i>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </apex:outputPanel>
                                                <apex:commandLink html-data-toggle="tooltip" html-data-placement="top" styleClass="slds-button slds-button_brand slds-float_right active-btn"
                                                    title="Add Entity" value="Add Entity" action="{!addEditOtherEntity}" reRender="otherEntititiesDialog"
                                                    onClick="showSpinner()" onComplete="hideSpinner(); openDialog('otherEntities', true);">
                                                    <apex:param name="otherEntityAddEditType" value="add" assignTo="{!otherEntityAddEditType}" />
                                                    <apex:param name="otherEntityAccountId" value="" />
                                                </apex:commandLink>
                                            </apex:outputPanel>
                                        </fieldset>
                                    </div>
                                </div>
                            </div>

                            <!-- KNOW YOUR CLIENT - ASSETS AND LIABILITIES -->
                            <div id="tab-scoped-6" class="{!IF(selectedInternalTab == 'tabAssetsLiabilities', 'slds-show', 'slds-hide')}" role="tabpanel"
                                aria-labelledby="tabAssetsLiabilities">
                                <div class="slds-section slds-is-open slds-form--compound">
                                    <h3 class="slds-section__title">
                                        <span class="slds-button slds-section__title-action" title="Assets">Assets</span>
                                    </h3>
                                    <div class="slds-section__content">
                                        <fieldset class="slds-box slds-theme_default slds-container slds-form-element">
                                            <legend class="slds-form-element__label slds-text-title_caps">Asset Details</legend>
                                            <div id="assetsChkBoxesContext" class="slds-form-element__control">
                                                <div class="slds-grid">
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox styleClass="slds-input" value="{!factFind.No_Assets__c}" html-data-id="noAssets" onchange="selectChkBox(this, true, 'assetsChkBoxesContext'); markAsChanged('Tab1', 'tabAssetsLiabilities');"
                                                        />
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                    <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">You have no assets</span>
                                                </div>
                                                <div class="slds-grid">
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox styleClass="slds-input limitedAdvice" html-data-id="chosenNotToProvideAssets" value="{!factFind.Chosen_Not_to_Provide_Asset_Details__c}"
                                                            onchange="selectChkBox(this, true, 'assetsChkBoxesContext'); markAsChanged('Tab1', 'tabAssetsLiabilities');"
                                                        />
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                    <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">You choose not to provide/update these details</span>
                                                </div>
                                            </div>
                                            <div style="padding-bottom: 50px;">
                                                <div class="slds-form-element__group" style="padding-top: 10px;" id="assets">
                                                    <div class="slds-form-element__row slds-border_bottom">
                                                        <div class="slds-size--1-of-6"></div>
                                                        <div class="slds-size--1-of-7">
                                                            <div class="slds-text-heading_small slds-align_absolute-center">Provider</div>
                                                        </div>
                                                        <div class="slds-size--1-of-8">
                                                            <div class="slds-text-heading_small slds-align_absolute-center">Owner</div>
                                                        </div>
                                                        <div class="slds-size--1-of-8">
                                                            <div class="slds-text-heading_small slds-align_absolute-center">Value ($)</div>
                                                        </div>
                                                        <div class="slds-size--2-of-6">
                                                            <div class="slds-text-heading_small slds-align_absolute-center">Details</div>
                                                        </div>
                                                        <div class="slds-size--1-of-12"></div>
                                                    </div>
                                                    <apex:outputPanel id="clientAssetsPanel">
                                                        <apex:actionFunction name="rerenderHomeIcon" reRender="homeIcon" onComplete="return false;"></apex:actionFunction>

                                                        <!-- Existing assets -->
                                                        <apex:repeat value="{!assetRoleWrappers}" var="assetRoleWrapper">
                                                            <div class="slds-form-element__row">
                                                                <div class="slds-size--1-of-5">
                                                                    <apex:outputPanel rendered="{!ISBLANK(assetRoleWrapper.asset.Type__c)}">
                                                                        <apex:inputField styleClass="slds-select" style="width:97%;" onchange="showHideAssetDataIcon(this,'{!assetRoleWrapper.tempId}'); markAsChanged('Tab1', 'tabAssetsLiabilities');"
                                                                            value="{!assetRoleWrapper.asset.Type__c}" />
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel rendered="{!NOT(ISBLANK(assetRoleWrapper.asset.Type__c))}">
                                                                        <apex:outputField styleClass="slds-select" style="width:97%;" value="{!assetRoleWrapper.asset.Type__c}" />
                                                                    </apex:outputPanel>
                                                                </div>
                                                                <div class="slds-size--1-of-7 slds-m-right--x-small">
                                                                    <c:SLDSDynamicLookup SLDSResourceName="$Asset.SLDS" ObjectApiName="Account" AdditionalWHEREFilter="RecordType.Name = \'Provider Account\'"
                                                                        DisplayFieldApiNames="Name,Type" DisplayFieldsPattern="Name - Type"
                                                                        photo="url->/img/icon/t4v35/standard/person_account_120.png"
                                                                        OnKeyDown="handleKeyDown(event)" JSfunction="institutionSelected"
                                                                        LabelName="{!assetRoleWrapper.randomString}" PlaceholderText="Search Provider"
                                                                        SetValueToField="{!assetRoleWrapper.asset.Provider__c}"
                                                                    />
                                                                </div>
                                                                <c:icon path="{!URLFOR($Resource.Akina, 'icons/material/business-24px.svg')}" elementId="newInstitutionIcon-{!assetRoleWrapper.tempId}"
                                                                    classes="icon-secondary iconButton slds-icon--small slds-m-right--x-small slds-m-top--xxx-small"
                                                                    type="uxpin" title="Create New Institution" onclick="showSpinner(); assetWrapperTempId = '{!assetRoleWrapper.tempId}'; openNewInstitution(); return false;"
                                                                />
                                                                <div class="slds-size--1-of-8 slds-form-element__control">
                                                                    <apex:selectList size="1" value="{!assetRoleWrapper.strOwnerType}" onchange="markAsChanged('Tab1', 'tabAssetsLiabilities');"
                                                                        styleClass="slds-select" style="width:97%;">
                                                                        <apex:selectOptions value="{!ownerTypeList}" />
                                                                    </apex:selectList>
                                                                </div>
                                                                <div class="slds-size--1-of-8 slds-form-element__control" style="padding-left: 0;">
                                                                    <apex:inputField value="{!assetRoleWrapper.asset.Value__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input asset"
                                                                        style="width:97%; padding-left:1.5rem;" onchange="formatNumber(this, 'Asset'); markAsChanged('Tab1', 'tabAssetsLiabilities');"
                                                                    />
                                                                    <span class="currencysign">$</span>
                                                                </div>
                                                                <div class="slds-align-middle slds-size--2-of-6">
                                                                    <apex:outputPanel rendered="{!assetRoleWrapper.asset.Street__c != ''}">
                                                                        <apex:outputText value="{!assetRoleWrapper.asset.Street__c}" />
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel html-data-id="detailsAssetData-{!assetRoleWrapper.tempId}" styleClass="{!IF(AND(NOT(ISNULL(assetRoleWrapper.asset.Type__c)),mapAssetTypeLiabilityType[assetRoleWrapper.asset.Type__c] == 'None'), 'slds-visible', 'slds-hidden')}">
                                                                        <apex:inputField value="{!assetRoleWrapper.asset.Details__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input" style="width:97%;"
                                                                            onchange="markAsChanged('Tab1', 'tabAssetsLiabilities');"
                                                                        />
                                                                    </apex:outputPanel>
                                                                </div>
                                                                <div class="slds-grid slds-wrap">
                                                                    <div class="slds-form-element__control slds-m-right--small">
                                                                        <div id="iconAssetData-{!assetRoleWrapper.tempId}" class="{!IF(AND(NOT(ISNULL(assetRoleWrapper.asset.Type__c)),mapAssetTypeLiabilityType[assetRoleWrapper.asset.Type__c] != 'None'),'slds-visible','slds-hidden')}">
                                                                            <c:icon path="{!URLFOR($Resource.Akina, 'icons/uxpin/home-regular.svg')}" elementId="assetPopupIcon-{!assetRoleWrapper.tempId}"
                                                                                classes="iconButton icon-secondary slds-icon--small"
                                                                                type="uxpin" title="Asset Data" onclick="showSpinner(); openAssetDataPopup('{!assetRoleWrapper.tempId}'); return false;"
                                                                            />
                                                                        </div>
                                                                    </div>
                                                                    <div class="slds-form-element__control slds-size--1-of-8" style="padding-left: 0;">
                                                                        <c:icon elementId="delAsset-{!assetRoleWrapper.tempId}" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#delete')}"
                                                                            classes="iconButton icon-secondary slds-icon--small"
                                                                            onclick="confirmDelete('Asset', '{!assetRoleWrapper.asset.Id}', '{!assetRoleWrapper.tempId}', 'Asset {!assetRoleWrapper.asset.Type__c} (${!assetRoleWrapper.asset.Value__c})'); return false;"
                                                                        />
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </apex:repeat>

                                                        <apex:outputPanel rendered="{!assetsIsEmpty}">
                                                            <div class="slds-form-element__row" data-id="assetsEmpty">
                                                                <div style="width:100%;">
                                                                    <div class="slds-text-heading_small slds-align_absolute-center">
                                                                        <i>No Assets Added</i>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel rendered="{!NOT(assetsIsEmpty)}">
                                                            <!-- Total Assets -->
                                                            <div class="slds-form-element__row">
                                                                <div class="slds-size--1-of-5">
                                                                    <div class="slds-text-heading_small">Total Assets</div>
                                                                </div>
                                                                <div class="slds-size--2-of-7 slds-m-right--medium"></div>
                                                                <div class="slds-size--1-of-5">
                                                                    <span style="font-weight:bold;">$</span>
                                                                    <apex:outputText value="{!totals[4]}" escape="false" styleClass="totalAssets" />
                                                                </div>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:commandButton value="Add Asset" rerender="clientAssetsPanel" action="{!addAsset}" styleClass="slds-button slds-button_brand slds-float_right active-btn"
                                                            title="Add Asset" style="{!IF(assetsIsEmpty, 'margin-top:10px;', '')} margin-bottom:10px;"
                                                            onclick="showSpinner();" oncomplete="hideSpinner();" />
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                            <div class="slds-form-element">
                                                <label class="slds-form-element__label">Assets Notes</label>
                                                <div class="slds-form-element__control">
                                                    <apex:inputField styleClass="slds-textarea" value="{!factFind.Asset_Notes__c}" onchange="markAsChanged('Tab1', 'tabAssetsLiabilities');"
                                                        style="height: 150px;" />
                                                </div>
                                            </div>
                                        </fieldset>
                                    </div>
                                </div>
                                <div class="slds-section slds-is-open slds-form--compound">
                                    <h3 class="slds-section__title">
                                        <span class="slds-button slds-section__title-action" title="Liabilities">Liabilities</span>
                                    </h3>
                                    <div class="slds-section__content">
                                        <fieldset class="slds-box slds-theme_default slds-container slds-form-element">
                                            <legend class="slds-form-element__label slds-text-title_caps">Liability Details</legend>
                                            <div id="liabilitiesChkBoxesContext" class="slds-form-element__control">
                                                <div class="slds-grid">
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox styleClass="slds-input" value="{!factFind.No_Liabilities__c}" html-data-id="noLiabilities" onchange="selectChkBox(this, true, 'liabilitiesChkBoxesContext'); markAsChanged('Tab1', 'tabAssetsLiabilities');"
                                                        />
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                    <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">You have no Liabilities</span>
                                                </div>
                                                <div class="slds-grid">
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox styleClass="slds-input limitedAdvice" value="{!factFind.Chosen_Not_to_Provide_Liability_Details__c}"
                                                            html-data-id="chosenNotToProvideLiabilities" onchange="selectChkBox(this, true, 'liabilitiesChkBoxesContext'); markAsChanged('Tab1', 'tabAssetsLiabilities');"
                                                        />
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                    <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">You choose not to provide/update these details</span>
                                                </div>
                                            </div>
                                            <div class="slds-form-element__group slds-clearfix" style="margin-top: 10px;" id="liabilities">
                                                <div class="slds-form-element__row">
                                                    <div class="slds-size--2-of-8"></div>
                                                    <div class="slds-size--1-of-7">
                                                        <div class="slds-text-heading_small slds-align_absolute-center">Institution</div>
                                                    </div>
                                                    <div class="slds-size--1-of-7">
                                                        <div class="slds-text-heading_small slds-align_absolute-center">Owner</div>
                                                    </div>
                                                    <div class="slds-size--1-of-8">
                                                        <div class="slds-text-heading_small slds-align_absolute-center">Value ($)</div>
                                                    </div>
                                                    <div class="slds-size--2-of-8">
                                                        <div class="slds-text-heading_small slds-align_absolute-center">Related Asset</div>
                                                    </div>
                                                </div>
                                                <div class="slds-border_bottom" style="margin-bottom: 10px;"></div>
                                                <apex:outputPanel id="clientLiabilitiesPanel">
                                                    <!-- Existing Liabilities -->
                                                    <apex:repeat value="{!liabilityRoleWrappers}" var="liab">
                                                        <div class="slds-form-element__row">
                                                            <div class="slds-size--2-of-8">
                                                                <apex:outputPanel rendered="{!NOT(ISBLANK(liab.liability.Type__c))}">
                                                                    <div class="slds-text-heading_small">{!liab.liability.Type__c}</div>
                                                                </apex:outputPanel>
                                                                <apex:outputPanel rendered="{!ISBLANK(liab.liability.Type__c)}">
                                                                    <apex:inputField styleClass="slds-select" style="width:97%;" onchange="showHideRelatedAsset(this, '{!liab.tempId}'); markAsChanged('Tab1', 'tabAssetsLiabilities');"
                                                                        html-data-id="liabType-{!liab.tempId}" value="{!liab.liability.Type__c}"
                                                                    />
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="slds-size--1-of-7 slds-m-right--x-small">
                                                                <c:SLDSDynamicLookup SLDSResourceName="$Asset.SLDS" ObjectApiName="Account" AdditionalWHEREFilter="RecordType.Name = \'Provider Account\'"
                                                                    DisplayFieldApiNames="Name,Type" DisplayFieldsPattern="Name - Type"
                                                                    photo="url->/img/icon/t4v35/standard/person_account_120.png"
                                                                    OnKeyDown="handleKeyDown(event)" JSfunction="institutionSelected"
                                                                    LabelName="{!liab.randomString}" PlaceholderText="Search Institution"
                                                                    SetValueToField="{!liab.liability.Institution__c}" />
                                                            </div>
                                                            <c:icon path="{!URLFOR($Resource.Akina, 'icons/material/business-24px.svg')}" elementId="newInstitutionIcon-{!liab.tempId}"
                                                                classes="icon-secondary iconButton slds-icon--small slds-m-right--x-small slds-m-top--xxx-small"
                                                                type="uxpin" title="Create New Institution" onclick="showSpinner(); liabilityWrapperTempId = '{!liab.tempId}'; openNewInstitution(); return false;"
                                                            />
                                                            <div class="slds-size--1-of-7 slds-form-element__control">
                                                                <apex:selectList size="1" value="{!liab.strOwnerType}" onchange="markAsChanged('Tab1', 'tabAssetsLiabilities');" styleClass="slds-select"
                                                                    style="width:97%;">
                                                                    <apex:selectOptions value="{!ownerTypeList}" />
                                                                </apex:selectList>
                                                            </div>
                                                            <div class="slds-size--1-of-8 slds-form-element__control" style="padding-left: 0;">
                                                                <apex:inputField value="{!liab.liability.Current_Balance__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input liability"
                                                                    style="width:97%; padding-left:1.5rem;" onchange="formatNumber(this, 'Liability'); markAsChanged('Tab1', 'tabAssetsLiabilities');"
                                                                />
                                                                <span class="currencysign">$</span>
                                                            </div>
                                                            <div class="slds-align-middle slds-form-element__control slds-size--2-of-8">
                                                                <apex:inputHidden html-data-id="assetSelectedId-{!liab.tempId}" value="{!liab.liability.Asset__c}" />
                                                                <apex:inputHidden html-data-id="assetSelectedDisplayValue-{!liab.tempId}" value="{!liab.assetSelectedDisplayValue}" />
                                                                <apex:outputPanel rendered="{!ISBLANK(liab.liability.Asset__c)}">
                                                                    <div class="slds-select_container {!IF(AND(liab.liability.Type__c != null, ISBLANK(liab.liability.Id)), 'slds-show', 'slds-hide')}"
                                                                        id="selectRelatedAssetContainer-{!liab.tempId}">
                                                                        <select class="slds-select" id="selectRelatedAsset-{!liab.tempId}" onchange="setAssetSelected(this, '{!liab.tempId}'); markAsChanged('Tab1', 'tabAssetsLiabilities');">
                                                                            <option></option>
                                                                        </select>
                                                                    </div>
                                                                </apex:outputPanel>
                                                                <apex:outputPanel rendered="{!NOT(ISBLANK(liab.liability.Asset__c))}">
                                                                    <apex:outputText value="{!liab.assetSelectedDisplayValue}" />
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="slds-form-element__control slds-align--absolute-center" style="padding-left: 0;">
                                                                <c:icon elementId="delLiability-{!liab.tempId}" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#delete')}"
                                                                    classes="iconButton icon-secondary slds-icon--small" onclick="confirmDelete('Liability', '{!liab.liability.Id}', '{!liab.tempId}', 'Liability {!liab.liability.Type__c} (${!liab.liability.Current_Balance__c})'); return false;"
                                                                />
                                                            </div>
                                                        </div>
                                                    </apex:repeat>
                                                    <apex:outputPanel rendered="{!liabilitiesIsEmpty}">
                                                        <div class="slds-form-element__row" data-id="liabilitiesEmpty">
                                                            <div style="width:100%;">
                                                                <div class="slds-text-heading_small slds-align_absolute-center">
                                                                    <i>No Liabilities Added</i>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!NOT(liabilitiesIsEmpty)}">
                                                        <!-- Total Liabilities -->
                                                        <div class="slds-form-element__row">
                                                            <div class="slds-size--3-of-7">
                                                                <div class="slds-text-heading_small" style="margin-bottom:15px;">Total Liabilities</div>
                                                            </div>
                                                            <div class="slds-size--1-of-8 slds-m-left--xx-large slds-size--1-of-8">
                                                                <span style="font-weight:bold;">$</span>
                                                                <apex:outputText value="{!totals[5]}" escape="false" styleClass="totalLiabilities" />
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>
                                                    <apex:commandButton value="Add Liability" rerender="clientLiabilitiesPanel" action="{!addLiability}" styleClass="slds-button slds-button_brand slds-float_right active-btn"
                                                        title="Add Liability" style="{!IF(liabilitiesIsEmpty, 'margin-top: 10px;', '')} margin-bottom:10px;"
                                                        onclick="showSpinner();" oncomplete="hideSpinner();" />
                                                </apex:outputPanel>
                                                <div class="slds-grid">
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox styleClass="slds-input" onchange="markAsChanged('Tab1', 'tabAssetsLiabilities'); missingFieldAlert('Information Missing', 'email', '{!client1.account.Name}', this);"
                                                            value="{!opp.Send_Mortgage_Monitoring_Service_Doc__c}" />
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                    <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular" style="padding-bottom: 10px;">Do you want to send a Mortgage Monitoring Service Document to the client?
                                                        <div class="slds-form-element__icon" onmouseover="showTooltip('helpMortgageMonitoring');" onmouseout="hideTooltip('helpMortgageMonitoring');"
                                                            style="padding-left: 0.4rem; padding-top: 0;">
                                                            <div class="slds-button slds-button_icon slds-button slds-button_icon" aria-describedby="helpMortgageMonitoring">
                                                                <c:icon elementId="infoMortgageMonitoring" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#info')}"
                                                                    classes="slds-button__icon" />
                                                            </div>
                                                        </div>
                                                        <div class="slds-popover slds-popover_tooltip slds-nubbin_left slds-fall-into-ground" role="tooltip" id="helpMortgageMonitoring"
                                                            style="position: absolute; margin-top: -35px; margin-left: 10px;">
                                                            <div class="slds-popover__body">
                                                                Ticking this box will send a fillable PDF to {!client1.account.Name}. The client will need to fill this out, print and then
                                                                sign in ink before returning the form to mortgages@apexgroup.co.nz.
                                                            </div>
                                                        </div>
                                                    </span>
                                                </div>
                                            </div>
                                            <div class="slds-form-element__control">
                                                <div class="slds-text-heading_medium" style="margin-bottom:15px;">Contingent Liability</div>
                                                <div class="slds-form-element__control">
                                                    <div class="slds-grid">
                                                        <label class="slds-checkbox">
                                                            <apex:inputCheckbox styleClass="slds-input" onchange="markAsChanged('Tab1', 'tabAssetsLiabilities');" value="{!factFind.No_Contingent_Liabilities__c}"
                                                            />
                                                            <span class="slds-checkbox_faux"></span>
                                                        </label>
                                                        <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">You have no Contingent Liabilities</span>
                                                    </div>
                                                </div>
                                                <div class="slds-text-body_regular" style="padding-top:15px;">Are you a guarantor for finance taken by anyone else? &nbsp;
                                                </div>
                                                <div class="slds-form-element__group slds-clearfix" style="padding-top: 10px;" id="conLiabilities">
                                                    <div class="slds-form-element__row">
                                                        <div class="apex-firstcol"></div>
                                                        <div class="apex-othercol">
                                                            <div class="slds-text-heading_small slds-align_absolute-center">Amount ($)</div>
                                                        </div>
                                                        <div class="apex-othercol">
                                                            <div class="slds-text-heading_small slds-align_absolute-center">Personal Guarantees</div>
                                                        </div>
                                                        <div class="apex-deletecol" />
                                                    </div>
                                                    <div class="slds-border_bottom" style="margin-bottom: 10px;"></div>
                                                    <apex:outputPanel id="conLiabilitiesPanel">
                                                        <!-- Existing Con Liabilities -->
                                                        <apex:repeat value="{!contingentLiabilityWrappers}" var="contLiab">
                                                            <div class="slds-form-element__row">
                                                                <div class="apex-firstcol">
                                                                    <apex:outputPanel rendered="{!NOT(ISBLANK(contLiab.liability.Type__c))}">
                                                                        <div class="slds-text-heading_small">{!contLiab.liability.Type__c}</div>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel rendered="{!ISBLANK(contLiab.liability.Type__c)}">
                                                                        <apex:inputField styleClass="slds-select" style="width:97%;" onchange="markAsChanged('Tab1', 'tabAssetsLiabilities');" value="{!contLiab.liability.Type__c}"
                                                                        />
                                                                    </apex:outputPanel>
                                                                </div>
                                                                <div class="apex-othercol slds-form-element__control" style="padding-left: 0;">
                                                                    <apex:inputField value="{!contLiab.liability.Current_Balance__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input conLiab"
                                                                        style="width:97%; padding-left:1.5rem;" onchange="formatNumber(this, 'ConLiability'); markAsChanged('Tab1', 'tabAssetsLiabilities');"
                                                                    />
                                                                    <span class="currencysign">$</span>
                                                                </div>
                                                                <div class="apex-othercol slds-form-element__control">
                                                                    <apex:selectList size="1" value="{!contLiab.liability.Personal_Guarantees__c}" onchange="markAsChanged('Tab1', 'tabAssetsLiabilities');"
                                                                        styleClass="slds-select" style="width:97%;">
                                                                        <apex:selectOptions value="{!personalGuaranteeList}" />
                                                                    </apex:selectList>
                                                                </div>
                                                                <div class="slds-form-element__control slds-align--absolute-center" style="padding-left: 0;">
                                                                    <c:icon elementId="delContLiability-{!contLiab.tempId}" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#delete')}"
                                                                        classes="iconButton icon-secondary slds-icon--small"
                                                                        onclick="confirmDelete('Contingent Liability', '{!contLiab.liability.Id}', '{!contLiab.tempId}', 'Contingent Liability {!contLiab.liability.Type__c} (${!contLiab.liability.Current_Balance__c})'); return false;"
                                                                    />
                                                                </div>
                                                            </div>
                                                        </apex:repeat>

                                                        <apex:outputPanel rendered="{!conLiabilitiesIsEmpty}">
                                                            <div class="slds-form-element__row">
                                                                <div style="width:100%;">
                                                                    <div class="slds-text-heading_small slds-align_absolute-center">
                                                                        <i>No Contingent Liabilities Added</i>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel rendered="{!NOT(conLiabilitiesIsEmpty)}">
                                                            <!-- Total Contingent Liabilities -->
                                                            <div class="slds-form-element__row">
                                                                <div class="apex-firstcol">
                                                                    <div class="slds-text-heading_small">Total Contingent Liabilities</div>
                                                                </div>
                                                                <div class="apex-othercol">
                                                                    <span style="font-weight:bold;">$</span>
                                                                    <apex:outputText value="{!totals[6]}" escape="false" styleClass="totalConLiabilities" />
                                                                </div>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:commandButton value="Add Contingent Liability" rerender="conLiabilitiesPanel" action="{!addConLiability}" styleClass="slds-button slds-button_brand slds-float_right active-btn"
                                                            title="Add Contingent Liability" style="{!IF(conLiabilitiesIsEmpty, 'margin-top: 10px;', '')} margin-bottom:10px;"
                                                            onclick="showSpinner();" oncomplete="hideSpinner();" />
                                                    </apex:outputPanel>
                                                </div>
                                                <div class="slds-form-element">
                                                    <label class="slds-form-element__label">Liabilities Notes</label>
                                                    <div class="slds-form-element__control">
                                                        <apex:inputField styleClass="slds-textarea" value="{!factFind.Assets_and_Liabilities_Notes__c}" onchange="markAsChanged('Tab1', 'tabAssetsLiabilities');"
                                                            style="height: 150px;" />
                                                    </div>
                                                </div>
                                            </div>
                                        </fieldset>
                                    </div>
                                </div>
                            </div>

                            <!-- KNOW YOUR CLIENT - INCOME AND EXPENSES -->
                            <div id="tab-scoped-7" class="{!IF(selectedInternalTab == 'tabIncomeExpenses', 'slds-show', 'slds-hide')}" role="tabpanel"
                                aria-labelledby="tabIncomeExpenses">
                                <div class="slds-section slds-is-open slds-form--compound">
                                    <h3 class="slds-section__title">
                                        <span class="slds-button slds-section__title-action" title="Your Income">Your Income</span>
                                    </h3>
                                    <div class="slds-section__content">
                                        <apex:outputPanel id="incomeExpensePanel">
                                            <fieldset class="slds-box slds-theme_default slds-container slds-form-element">
                                                <legend class="slds-form-element__label slds-text-title_caps">Income Details</legend>
                                                <div class="slds-form-element__control">
                                                    <div class="slds-grid">
                                                        <label class="slds-checkbox">
                                                            <apex:inputCheckbox styleClass="slds-input limitedAdvice" onchange="markAsChanged('Tab1', 'tabIncomeExpenses');" html-data-id="chosenNotToProvideIncome"
                                                                value="{!factFind.Chosen_Not_to_Provide_Income_Details__c}" />
                                                            <span class="slds-checkbox_faux"></span>
                                                        </label>
                                                        <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">You choose not to provide/update these details</span>
                                                    </div>
                                                    <apex:outputLink value="https://www.paye.net.nz/calculator.html" id="payeLink" style="margin-top:10px; margin-bottom:10px;"
                                                        styleClass="slds-m-top_xx-small slds-button slds-button_brand btnSubmit">PAYE Calculator</apex:outputLink>
                                                </div>
                                                <div class="slds-grid">
                                                    <div class="slds-col slds-form-element__group slds-m-right--medium" style="padding-top: 10px;" id="client1income">
                                                        <div class="slds-form-element__row slds-border_bottom" style="height:28px;">
                                                            <div class="slds-size--1-of-2">
                                                                <div class="slds-text-heading_small slds-align_absolute-center">Earned Income</div>
                                                            </div>
                                                            <div class="slds-size--1-of-2">
                                                                <div class="slds-text-heading_small slds-align_absolute-center">Annual Gross  {!IF(ISNULL(client1.account.Name), "Client
                                                                    1", (client1.account.Name))}</div>
                                                            </div>
                                                        </div>
                                                        <apex:outputPanel id="client1IncomePanel">
                                                            <!-- Existing Income/s -->
                                                            <apex:repeat value="{!incomeAndExpenses['Client 1 - Income']}" var="income">
                                                                <div class="slds-form-element__row">
                                                                    <div class="slds-size--1-of-2">
                                                                        <apex:outputPanel rendered="{!NOT(ISBLANK(income.incomeExpense.Type__c))}">
                                                                            <div class="slds-text-heading_small">{!income.incomeExpense.Type__c}</div>
                                                                        </apex:outputPanel>
                                                                        <apex:outputPanel rendered="{!ISBLANK(income.incomeExpense.Type__c)}">
                                                                            <apex:inputField value="{!income.incomeExpense.Type__c}" styleClass="slds-select" style="width:97%;" onchange="markAsChanged('Tab1', 'tabIncomeExpenses');"
                                                                            />
                                                                        </apex:outputPanel>
                                                                    </div>
                                                                    <div class="slds-size--1-of-2 slds-form-element__control">
                                                                        <apex:inputField value="{!income.incomeExpense.Amount__c}" styleClass="slds-input income1" onkeydown="handleKeyDown(event)"
                                                                            html-placeholder="{!IF(ISNULL(client1.account.Name), "
                                                                            Client 1 Income ", (client1.account.Name + "&lsquo;s
                                                                            Income "))}" style="width:97%; padding-left:1.5rem;"
                                                                            onchange="formatNumber(this, 'Income,Client1'); markAsChanged('Tab1', 'tabIncomeExpenses');"
                                                                        />
                                                                        <span class="currencysign">$</span>
                                                                    </div>
                                                                    <div class="slds-form-element__control slds-align--absolute-center" style="padding-left: 0;margin-left: -10px;">
                                                                        <c:icon elementId="delIncome1-{!income.tempId}" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#delete')}"
                                                                            classes="iconButton icon-secondary slds-icon--small"
                                                                            onclick="confirmDelete('Income/Expense', '{!income.incomeExpense.Id}', '{!income.tempId}', 'Income {!income.incomeExpense.Type__c} (${!income.incomeExpense.Amount__c})'); return false;"
                                                                        />
                                                                    </div>
                                                                </div>
                                                            </apex:repeat>
                                                            <apex:outputPanel rendered="{!client1IncomeIsEmpty}">
                                                                <div class="slds-form-element__row" data-id="incomeClient1Empty">
                                                                    <div style="width:100%;">
                                                                        <div class="slds-text-heading_small slds-align_absolute-center">
                                                                            <i>No Income Added</i>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="{!NOT(client1IncomeIsEmpty)}">
                                                                <div class="slds-form-element__row slds-border_bottom"></div>
                                                                <!-- Total Income -->
                                                                <div class="slds-form-element__row">
                                                                    <div class="slds-size--1-of-2">
                                                                        <div class="slds-text-heading_small">Total Income</div>
                                                                    </div>
                                                                    <div class="slds-size--1-of-2 slds-form-element__control">
                                                                        <span style="font-weight:bold;">$</span>
                                                                        <apex:outputText value="{!totals[0]}" escape="false" styleClass="totalIncome1" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:commandButton value="Add Income" rerender="client1IncomePanel" action="{!addIncome}" styleClass="slds-button slds-button_brand slds-float_right active-btn"
                                                                title="Add Client 1 Income" style="{!IF(client1IncomeIsEmpty, 'margin-top:10px;', '')} margin-bottom:10px; margin-right:10px;"
                                                                onclick="showSpinner();" oncomplete="hideSpinner();">
                                                                <apex:param name="incomeKey1" value="Client 1 - Income" assignTo="{!keys}" />
                                                            </apex:commandButton>
                                                        </apex:outputPanel>
                                                    </div>
                                                    <div class="slds-col slds-form-element__group" id="client2income" style="{!IF(single, 'display: none', 'padding-top: 10px; display: block')}">
                                                        <div class="slds-form-element__row slds-border_bottom" style="height:28px;">
                                                            <div class="slds-size--1-of-2">
                                                                <div class="slds-text-heading_small slds-align_absolute-center">Earned Income</div>
                                                            </div>
                                                            <div class="slds-size--1-of-2">
                                                                <div class="slds-text-heading_small slds-align_absolute-center">Annual Gross  {!IF(ISNULL(client2.account.Name), "Client
                                                                    2", (client2.account.Name))}</div>
                                                            </div>
                                                        </div>
                                                        <apex:outputPanel id="client2IncomePanel">
                                                            <!-- Existing Income/s -->
                                                            <apex:repeat value="{!incomeAndExpenses[client2Type]}" var="income">
                                                                <div class="slds-form-element__row">
                                                                    <div class="slds-size--1-of-2">
                                                                        <apex:outputPanel rendered="{!NOT(ISBLANK(income.incomeExpense.Type__c))}">
                                                                            <div class="slds-text-heading_small">{!income.incomeExpense.Type__c}</div>
                                                                        </apex:outputPanel>
                                                                        <apex:outputPanel rendered="{!ISBLANK(income.incomeExpense.Type__c)}">
                                                                            <apex:inputField value="{!income.incomeExpense.Type__c}" styleClass="slds-select" style="width:97%;" onchange="markAsChanged('Tab1', 'tabIncomeExpenses');"
                                                                            />
                                                                        </apex:outputPanel>
                                                                    </div>
                                                                    <div class="slds-size--1-of-2 slds-form-element__control" style="padding-left: 0;">
                                                                        <apex:inputField value="{!income.incomeExpense.Amount__c}" styleClass="slds-input income2" onkeydown="handleKeyDown(event)"
                                                                            html-placeholder="{!IF(ISNULL(client2.account.Name), "
                                                                            Client 2 Income ", (client2.account.Name + "&lsquo;s
                                                                            Income "))}" style="width:97%; padding-left:1.5rem;"
                                                                            rendered="{!joint}" onchange="formatNumber(this, 'Income,Client2'); markAsChanged('Tab1', 'tabIncomeExpenses');"
                                                                        />
                                                                        <apex:inputField value="{!income.incomeExpense.Amount__c}" styleClass="slds-input" onkeydown="handleKeyDown(event)" html-placeholder="{!IF(ISNULL(client2.account.Name), "
                                                                            Client 2 Income ", (client2.account.Name + "&lsquo;s
                                                                            Income "))}" style="width:97%; padding-left:1.5rem;"
                                                                            rendered="{!single}" html-disabled="true" />
                                                                        <span class="currencysign">$</span>
                                                                    </div>
                                                                    <div class="slds-form-element__control" style="padding-left: 0;margin-left: -10px;">
                                                                        <c:icon elementId="delIncome2-{!income.tempId}" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#delete')}"
                                                                            classes="iconButton icon-secondary slds-icon--small"
                                                                            onclick="confirmDelete('Income/Expense', '{!income.incomeExpense.Id}', '{!income.tempId}', 'Income {!income.incomeExpense.Type__c} (${!income.incomeExpense.Amount__c})'); return false;"
                                                                        />
                                                                    </div>
                                                                </div>
                                                            </apex:repeat>
                                                            <apex:outputPanel rendered="{!client2IncomeIsEmpty}">
                                                                <div class="slds-form-element__row" data-id="incomeClient2Empty">
                                                                    <div style="width:100%;">
                                                                        <div class="slds-text-heading_small slds-align_absolute-center">
                                                                            <i>No Income Added</i>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="{!NOT(client2IncomeIsEmpty)}">
                                                                <div class="slds-form-element__row slds-border_bottom"></div>
                                                                <!-- Total Income -->
                                                                <div class="slds-form-element__row">
                                                                    <div class="slds-size--1-of-2">
                                                                        <div class="slds-text-heading_small">Total Income</div>
                                                                    </div>
                                                                    <div class="slds-size--1-of-2 slds-form-element__control" style="padding-left: 0;">
                                                                        <span style="font-weight:bold;">$</span>
                                                                        <apex:outputText value="{!totals[1]}" escape="false" styleClass="totalIncome2" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:commandButton value="Add Income" rerender="client2IncomePanel" action="{!addIncome}" styleClass="slds-button {!IF(single, 'slds-button_neutral', 'slds-button_brand')} slds-float_right client2-btn"
                                                                title="{!IF(joint, 'Add Client 2 Income', 'Joint Type not selected')}"
                                                                disabled="{!single}" style="{!IF(client2IncomeIsEmpty, 'margin-top:10px;', '')} margin-bottom:10px; margin-right:10px;"
                                                                onclick="showSpinner();" oncomplete="hideSpinner();">
                                                                <apex:param name="incomeKey2" value="Client 2" assignTo="{!keys}" />
                                                            </apex:commandButton>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                                <div class="slds-form-element">
                                                    <label class="slds-form-element__label">Your Income Notes</label>
                                                    <div class="slds-form-element__control">
                                                        <apex:inputField styleClass="slds-textarea" value="{!factFind.Income_Notes__c}" onchange="markAsChanged('Tab1', 'tabIncomeExpenses');"
                                                            style="height: 150px;" />
                                                    </div>
                                                </div>
                                            </fieldset>
                                        </apex:outputPanel>
                                    </div>
                                </div>
                                <div class="slds-section slds-is-open slds-form--compound">
                                    <h3 class="slds-section__title">
                                        <span class="slds-button slds-section__title-action" title="Your Expenses">Your Expenses</span>
                                    </h3>
                                    <div class="slds-section__content">
                                        <fieldset class="slds-box slds-theme_default slds-container slds-form-element">
                                            <legend class="slds-form-element__label slds-text-title_caps">Expenses Details</legend>
                                            <div id="expensesChkBoxesContext" class="slds-form-element__control">
                                                <div class="slds-grid">
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox styleClass="slds-input" value="{!factFind.Do_not_Know_What_Are_My_Expenses__c}" html-data-id="noExpenses"
                                                            onchange="selectChkBox(this, true, 'expensesChkBoxesContext'); markAsChanged('Tab1', 'tabIncomeExpenses');"
                                                        />
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                    <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">You do not know what your expenses are</span>
                                                </div>
                                                <div class="slds-grid">
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox styleClass="slds-input limitedAdvice" value="{!factFind.Chosen_Not_to_Provide_Expense_Details__c}" html-data-id="chosenNotToProvideExpenses"
                                                            onchange="selectChkBox(this, true, 'expensesChkBoxesContext'); markAsChanged('Tab1', 'tabIncomeExpenses');"
                                                        />
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                    <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">You choose not to provide/update this information</span>
                                                </div>
                                            </div>
                                            <div class="slds-form-element__group" id="clientExpenses">
                                                <div class="slds-border_bottom slds-form-element__row slds-p-bottom--xx-small">
                                                    <div class="slds-size--1-of-1">
                                                        <div class="slds-text-heading_small slds-align_absolute-center">Monthly Expenses (combined)
                                                        </div>
                                                    </div>
                                                </div>
                                                <apex:outputPanel id="clientExpensesPanel">
                                                    <!-- Existing Expenses -->
                                                    <apex:repeat value="{!incomeAndExpenses['Client 1 - Expenses']}" var="expense">
                                                        <div class="slds-form-element__row">
                                                            <div class="slds-size--2-of-5">
                                                                <apex:outputPanel rendered="{!NOT(ISBLANK(expense.incomeExpense.Type__c))}">
                                                                    <div class="slds-text-heading_small">{!expense.incomeExpense.Type__c}</div>
                                                                </apex:outputPanel>
                                                                <apex:outputPanel rendered="{!ISBLANK(expense.incomeExpense.Type__c)}">
                                                                    <apex:inputField value="{!expense.incomeExpense.Type__c}" styleClass="slds-select slds-size--11-of-12" onchange="markAsChanged('Tab1', 'tabIncomeExpenses');"
                                                                    />
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="slds-size--2-of-5 slds-form-element__control">
                                                                <span class="slds-is-absolute slds-m-left--x-small slds-m-top--xx-small slds-p-top slds-p-top--xxx-small slds-text-color--inverse-weak slds-text-heading--small">$</span>
                                                                <apex:inputField value="{!expense.incomeExpense.Amount__c}" html-placeholder="Enter expense value" onkeydown="handleKeyDown(event)"
                                                                    styleClass="slds-input expense slds-p-left--large" onchange="formatNumber(this, 'Expense'); markAsChanged('Tab1', 'tabIncomeExpenses');"
                                                                />
                                                            </div>
                                                            <div class="slds-form-element__control">
                                                                <c:icon elementId="delExpense-{!expense.tempId}" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#delete')}"
                                                                    classes="iconButton icon-secondary slds-icon--small" onclick="confirmDelete('Income/Expense', '{!expense.incomeExpense.Id}', '{!expense.tempId}', 'Expense {!expense.incomeExpense.Type__c} (${!expense.incomeExpense.Amount__c})'); return false;"
                                                                />
                                                            </div>
                                                        </div>
                                                    </apex:repeat>
                                                    <apex:outputPanel rendered="{!expensesIsEmpty}">
                                                        <div class="slds-form-element__row" data-id="expensesEmpty">
                                                            <div class="slds-size--1-of-1">
                                                                <div class="slds-text-heading_small slds-align_absolute-center">
                                                                    <i>No Expenses Added</i>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!NOT(expensesIsEmpty)}">
                                                        <!-- Total monthly combined expenses -->
                                                        <div class="slds-border--top slds-form-element__row slds-m-top--small slds-p-top--small">
                                                            <div class="slds-size--2-of-5">
                                                                <div class="slds-text-heading_small">Total monthly combined expenses</div>
                                                            </div>
                                                            <div class="slds-size--2-of-5">
                                                                <span class="slds-text-title_bold">$</span>
                                                                <apex:outputText value="{!totals[2]}" escape="false" styleClass="totalExpense slds-m-left--x-small slds-text-title_bold"
                                                                />
                                                            </div>
                                                        </div>
                                                        <div class="slds-form-element__row">
                                                            <div class="slds-size--2-of-5">
                                                                <div class="slds-text-heading_small">Total annual combined expenses</div>
                                                            </div>
                                                            <div class="slds-size--2-of-5">
                                                                <span class="slds-text-title_bold">$</span>
                                                                <apex:outputText value="{!totals[2] * 12}" escape="false" styleClass="totalExpenseAnnual slds-m-left--x-small slds-text-title_bold"
                                                                />
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>
                                                    <apex:commandButton value="Add Expense" rerender="clientExpensesPanel" action="{!addExpense}" styleClass="slds-button slds-button_brand slds-float_right active-btn"
                                                        title="Add Expense" onclick="showSpinner();" oncomplete="hideSpinner();">
                                                        <apex:param name="expenseKey" value="Client 1 - Expenses" assignTo="{!keys}" />
                                                    </apex:commandButton>
                                                </apex:outputPanel>
                                            </div>
                                        </fieldset>
                                    </div>
                                </div>
                            </div>

                            <!-- KNOW YOUR CLIENT - LEGAL -->
                            <div id="tab-scoped-8" class="{!IF(selectedInternalTab == 'tabLegalDocuments', 'slds-show', 'slds-hide')}" role="tabpanel"
                                aria-labelledby="tabLegalDocuments">
                                <div class="slds-section slds-is-open slds-form--compound">
                                    <h3 class="slds-section__title">
                                        <span class="slds-button slds-section__title-action" title="Do you have your legal documents sorted?">Do you have your legal documents sorted?</span>
                                    </h3>
                                    <div class="slds-section__content">
                                        <fieldset class="slds-box slds-theme_default slds-container slds-form-element">
                                            <legend class="slds-form-element__label slds-text-title_caps">Estate Planning Details</legend>
                                            <div class="slds-form-element__group" style="padding-top: 10px;">
                                                <div class="slds-form-element__row slds-border_bottom" style="height:28px;">
                                                    <div class="apex-firstcol"></div>
                                                    <div class="apex-othercol">
                                                        <div class="slds-text-heading_small slds-align_absolute-center">{!IF(ISNULL(client1.account.Name), "Client 1", client1.account.Name)}</div>
                                                    </div>
                                                    <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                        <div class="slds-text-heading_small slds-align_absolute-center">{!IF(ISNULL(client2.account.Name), "Client 2", client2.account.Name)}</div>
                                                    </div>
                                                </div>
                                                <!-- Do you have a will? -->
                                                <div class="slds-form-element__row">
                                                    <div class="apex-firstcol">
                                                        <div class="slds-text-heading_small">Do you have a will?</div>
                                                    </div>
                                                    <div class="apex-othercol">
                                                        <apex:inputField value="{!estatePlanning[client1Type].Will__c}" styleClass="slds-select" onchange="markAsChanged('Tab1', 'tabLegalDocuments');"
                                                            style="width:97%;" />
                                                        <div class="slds-text-body_regular" style="padding-top: 10px;">If no, is referral required?
                                                        </div>
                                                        <apex:inputField value="{!estatePlanning[client1Type].Referral_Required_No_Will__c}" onchange="markAsChanged('Tab1', 'tabLegalDocuments');"
                                                            styleClass="slds-select" style="width:97%;" />
                                                    </div>
                                                    <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                        <apex:inputField value="{!estatePlanning[client2Type].Will__c}" styleClass="slds-select" onchange="markAsChanged('Tab1', 'tabLegalDocuments');"
                                                            style="width:97%;" rendered="{!joint}" />
                                                        <apex:inputField value="{!estatePlanning[client2Type].Will__c}" styleClass="slds-select" style="width:97%;" rendered="{!single}"
                                                            html-disabled="true" />
                                                        <div class="slds-text-body_regular" style="padding-top: 10px;">If no, is referral required?
                                                        </div>
                                                        <apex:inputField value="{!estatePlanning[client2Type].Referral_Required_No_Will__c}" onchange="markAsChanged('Tab1', 'tabLegalDocuments');"
                                                            styleClass="slds-select" style="width:97%;" rendered="{!joint}" />
                                                        <apex:inputField value="{!estatePlanning[client2Type].Referral_Required_No_Will__c}" styleClass="slds-select" style="width:97%;"
                                                            rendered="{!single}" html-disabled="true" />
                                                    </div>
                                                </div>
                                                <!-- Is your will up to date? -->
                                                <div class="slds-form-element__row">
                                                    <div class="apex-firstcol">
                                                        <div class="slds-text-heading_small">Is your will up to date?</div>
                                                    </div>
                                                    <div class="apex-othercol">
                                                        <apex:inputField value="{!estatePlanning[client1Type].Will_Up_to_Date__c}" onchange="markAsChanged('Tab1', 'tabLegalDocuments');"
                                                            styleClass="slds-select" style="width:97%;" />
                                                    </div>
                                                    <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                        <apex:inputField value="{!estatePlanning[client2Type].Will_Up_to_Date__c}" onchange="markAsChanged('Tab1', 'tabLegalDocuments');"
                                                            styleClass="slds-select" style="width:97%;" rendered="{!joint}" />
                                                        <apex:inputField value="{!estatePlanning[client2Type].Will_Up_to_Date__c}" styleClass="slds-select" style="width:97%;" rendered="{!single}"
                                                            html-disabled="true" />
                                                    </div>
                                                </div>
                                                <!-- Where is your will held? -->
                                                <div class="slds-form-element__row">
                                                    <div class="apex-firstcol">
                                                        <div class="slds-text-heading_small">Where is your will held?</div>
                                                    </div>
                                                    <div class="apex-othercol">
                                                        <apex:inputText value="{!estatePlanning[client1Type].Where_is_your_Will_Held__c}" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabLegalDocuments');"
                                                            styleClass="slds-input" style="width:97%;" />
                                                    </div>
                                                    <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                        <apex:inputText value="{!estatePlanning[client2Type].Where_is_your_Will_Held__c}" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabLegalDocuments');"
                                                            styleClass="slds-input" style="width:97%;" disabled="{!single}" />
                                                    </div>
                                                </div>
                                                <!-- Have you granted a Power of Attorney? -->
                                                <div class="slds-form-element__row">
                                                    <div class="apex-firstcol">
                                                        <div class="slds-text-heading_small">Have you granted a Power of Attorney?</div>
                                                    </div>
                                                    <div class="apex-othercol">
                                                        <apex:inputField value="{!estatePlanning[client1Type].Granted_Power_of_Attorney__c}" onchange="markAsChanged('Tab1', 'tabLegalDocuments');"
                                                            styleClass="slds-select" style="width:97%;" />
                                                    </div>
                                                    <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                        <apex:inputField value="{!estatePlanning[client2Type].Granted_Power_of_Attorney__c}" onchange="markAsChanged('Tab1', 'tabLegalDocuments');"
                                                            styleClass="slds-select" style="width:97%;" rendered="{!joint}" />
                                                        <apex:inputField value="{!estatePlanning[client2Type].Granted_Power_of_Attorney__c}" styleClass="slds-select" style="width:97%;"
                                                            rendered="{!single}" html-disabled="true" />
                                                    </div>
                                                </div>
                                                <!-- Do you have a trust? -->
                                                <div class="slds-form-element__row">
                                                    <div class="apex-firstcol">
                                                        <div class="slds-text-heading_small">Do you have a trust?</div>
                                                    </div>
                                                    <div class="apex-othercol">
                                                        <apex:inputField value="{!estatePlanning[client1Type].Do_you_have_a_trust__c}" onchange="markAsChanged('Tab1', 'tabLegalDocuments');"
                                                            styleClass="slds-select" style="width:97%;" />
                                                    </div>
                                                    <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                        <apex:inputField value="{!estatePlanning[client2Type].Do_you_have_a_trust__c}" onchange="markAsChanged('Tab1', 'tabLegalDocuments');"
                                                            styleClass="slds-select" style="width:97%;" rendered="{!joint}" />
                                                        <apex:inputField value="{!estatePlanning[client2Type].Do_you_have_a_trust__c}" styleClass="slds-select" style="width:97%;"
                                                            rendered="{!single}" html-disabled="true" />
                                                    </div>
                                                </div>
                                                <!-- What is the name of your Trust? -->
                                                <div class="slds-form-element__row">
                                                    <div class="apex-firstcol">
                                                        <div class="slds-text-heading_small">What is the name of your Trust?</div>
                                                    </div>
                                                    <div class="apex-othercol">
                                                        <apex:inputText value="{!estatePlanning[client1Type].Trust_Name__c}" styleClass="slds-input" onkeydown="handleKeyDown(event)"
                                                            onchange="markAsChanged('Tab1', 'tabLegalDocuments');" style="width:97%;"
                                                        />
                                                    </div>
                                                    <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                        <apex:inputText value="{!estatePlanning[client2Type].Trust_Name__c}" styleClass="slds-input" onkeydown="handleKeyDown(event)"
                                                            onchange="markAsChanged('Tab1', 'tabLegalDocuments');" style="width:97%;"
                                                            disabled="{!single}" />
                                                    </div>
                                                </div>
                                                <!-- Notes -->
                                                <div class="slds-form-element__row">
                                                    <div class="apex-firstcol">
                                                        <div class="slds-text-heading_small">Notes</div>
                                                    </div>
                                                    <div class="apex-othercol">
                                                        <apex:inputField value="{!estatePlanning[client1Type].Notes__c}" styleClass="slds-textarea" onchange="markAsChanged('Tab1', 'tabLegalDocuments');"
                                                            style="width:97%;" />
                                                    </div>
                                                    <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                        <apex:inputField value="{!estatePlanning[client2Type].Notes__c}" styleClass="slds-textarea" onchange="markAsChanged('Tab1', 'tabLegalDocuments');"
                                                            style="width:97%;" rendered="{!joint}" />
                                                        <apex:inputField value="{!estatePlanning[client2Type].Notes__c}" styleClass="slds-textarea" style="width:97%;" rendered="{!single}"
                                                            html-disabled="true" />
                                                    </div>
                                                </div>
                                            </div>
                                            <br/>
                                            <div class="slds-text-heading_medium">Existing Professionals/Advisers</div>
                                            <div class="slds-form-element__group" style="padding-top: 10px;">
                                                <div class="slds-form-element__row slds-border_bottom" style="height:28px;">
                                                    <div style="width: 25%;"></div>
                                                    <div style="width: 50%;">
                                                        <div class="slds-text-heading_small slds-align_absolute-center">Name</div>
                                                    </div>
                                                    <div style="width: 25%;">
                                                        <div class="slds-text-heading_small slds-align_absolute-center">Firm</div>
                                                    </div>
                                                </div>
                                                <!-- Accountant / Tax Agent -->
                                                <div class="slds-form-element__row">
                                                    <div style="width: 25%;">
                                                        <div class="slds-text-heading_small">Accountant / Tax Agent</div>
                                                    </div>
                                                    <div style="width: 25%;">
                                                        <div style="width:97%;">
                                                            <c:SLDSDynamicLookup SLDSResourceName="$Asset.SLDS" ObjectApiName="Contact" AdditionalWHEREFilter="AccountId != null" DisplayFieldApiNames="Name"
                                                                DisplayFieldsPattern="Name" photo="url->/img/icon/t4v35/standard/contact_120.png"
                                                                LabelName="Accountant" JSfunction="legalSLDSSelected" SetValueToField="{!contactRoles['Accountant/Tax Agent'].ContactId}"
                                                            />
                                                        </div>
                                                    </div>
                                                    <div style="width: 25%;">
                                                        <apex:inputText value="{!professionals['Accountant/Tax Agent'].LastName}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                            style="width:97%;" onchange="markAsChanged('Tab1', 'tabLegalDocuments');"
                                                            html-placeholder="If Accountant/Tax Agent does not exist" />
                                                    </div>
                                                    <div style="width: 25%;">
                                                        <apex:inputText styleClass="slds-input" value="{!contactRoles['Accountant/Tax Agent'].Firm__c}" onkeydown="handleKeyDown(event)"
                                                            style="width:97%;" onchange="markAsChanged('Tab1', 'tabLegalDocuments');"
                                                            html-placeholder="This field is required when you need to create a new contact."
                                                            title="{!IF(ISBLANK(contactRoles['Accountant/Tax Agent'].Firm__c), 'This field is required when you need to create a new contact.', '')}"
                                                        />
                                                    </div>
                                                </div>
                                                <!-- Solicitor -->
                                                <div class="slds-form-element__row">
                                                    <div style="width: 25%;">
                                                        <div class="slds-text-heading_small">Solicitor</div>
                                                    </div>
                                                    <div style="width: 25%;">
                                                        <div style="width:97%;">
                                                            <c:SLDSDynamicLookup SLDSResourceName="$Asset.SLDS" ObjectApiName="Contact" AdditionalWHEREFilter="AccountId != null" DisplayFieldApiNames="Name"
                                                                DisplayFieldsPattern="Name" photo="url->/img/icon/t4v35/standard/contact_120.png"
                                                                LabelName="Solicitor" JSfunction="legalSLDSSelected" SetValueToField="{!contactRoles['Solicitor'].ContactId}"
                                                            />
                                                        </div>
                                                    </div>
                                                    <div style="width: 25%;">
                                                        <apex:inputText value="{!professionals['Solicitor'].LastName}" styleClass="slds-input" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabLegalDocuments');"
                                                            style="width:97%;" html-placeholder="If Solicitor does not exist"
                                                        />
                                                    </div>
                                                    <div style="width: 25%;">
                                                        <apex:inputText styleClass="slds-input" value="{!contactRoles['Solicitor'].Firm__c}" onkeydown="handleKeyDown(event)" onchange="markAsChanged('Tab1', 'tabLegalDocuments');"
                                                            style="width:97%;" html-placeholder="This field is required when you need to create a new contact."
                                                            title="{!IF(ISBLANK(contactRoles['Solicitor'].Firm__c), 'This field is required when you need to create a new contact.', '')}"
                                                        />
                                                    </div>
                                                </div>
                                                <!-- Other Adviser -->
                                                <div class="slds-form-element__row">
                                                    <div style="width: 25%;">
                                                        <div class="slds-text-heading_small">Other Adviser</div>
                                                    </div>
                                                    <div style="width: 25%;">
                                                        <div style="width:97%;">
                                                            <c:SLDSDynamicLookup SLDSResourceName="$Asset.SLDS" ObjectApiName="Contact" AdditionalWHEREFilter="AccountId != null" DisplayFieldApiNames="Name"
                                                                DisplayFieldsPattern="Name" photo="url->/img/icon/t4v35/standard/contact_120.png"
                                                                LabelName="OtherAdviser" JSfunction="legalSLDSSelected" SetValueToField="{!contactRoles['Other Adviser'].ContactId}"
                                                            />
                                                        </div>
                                                    </div>
                                                    <div style="width: 25%;">
                                                        <apex:inputText value="{!professionals['Other Adviser'].LastName}" styleClass="slds-input" onkeydown="handleKeyDown(event)"
                                                            onchange="markAsChanged('Tab1', 'tabLegalDocuments');" style="width:97%;"
                                                            html-placeholder="If Adviser does not exist" />
                                                    </div>
                                                    <div style="width: 25%;">
                                                        <apex:inputText styleClass="slds-input" value="{!contactRoles['Other Adviser'].Firm__c}" onkeydown="handleKeyDown(event)"
                                                            onchange="markAsChanged('Tab1', 'tabLegalDocuments');" style="width:97%;"
                                                            html-placeholder="This field is required when you need to create a new contact."
                                                            title="{!IF(ISBLANK(contactRoles['Other Adviser'].Firm__c), 'This field is required when you need to create a new contact.', '')}"
                                                        />
                                                    </div>
                                                </div>
                                            </div>
                                        </fieldset>
                                    </div>
                                </div>
                            </div>
                            <!-- KNOW YOUR CLIENT - EXISTING COVER -->

                            <div id="tab-scoped-11" class="{!IF(selectedInternalTab == 'tabExistingCover', 'slds-show', 'slds-hide')}" role="tabpanel"
                                aria-labelledby="tabExistingCover">
                                <!-- KNOW YOUR CLIENT - EXISTING COVER -->
                                <div class="slds-section slds-is-open slds-form--compound">
                                    <h3 class="slds-section__title">
                                        <span class="slds-button slds-section__title-action" title="Existing Cover">Existing Cover</span>
                                    </h3>
                                    <div class="slds-section__content">
                                        <fieldset class="slds-box slds-theme_default slds-container slds-form-element">
                                            <div class="slds-text-heading_small">{!IF(ISNULL(client1.account.Name), "Client 1", client1.account.Name)}</div>
                                            <div id="existingRisks1ChkBoxesContext" class="slds-form-element__control">
                                                <div class="slds-grid">
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox styleClass="slds-input" value="{!existingRisks[client1Type].option1}" onchange="selectChkBox(this, true, 'existingRisks1ChkBoxesContext'); markAsChanged('Tab1', 'tabExistingCover');"
                                                        />
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                    <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">You have no personal risk policies at this time</span>
                                                </div>
                                                <div class="slds-grid">
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox styleClass="slds-input" value="{!existingRisks[client1Type].option2}" onchange="selectChkBox(this, true, 'existingRisks1ChkBoxesContext'); markAsChanged('Tab1', 'tabExistingCover');"
                                                        />
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                    <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">You have indicated that you have current personal insurance policies
                                                        that Apex does not advise on, and have completed the letter of authority
                                                        to allow us access to these policies. (Please identify the Insurers
                                                        in the Non-Apex Serviced Section)</span>
                                                </div>
                                                <div class="slds-grid">
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox styleClass="slds-input" value="{!existingRisks[client1Type].option3}" onchange="selectChkBox(this, true, 'existingRisks1ChkBoxesContext'); markAsChanged('Tab1', 'tabExistingCover');"
                                                        />
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                    <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">All Policies are serviced by Apex</span>
                                                </div>
                                                <div class="slds-grid">
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox styleClass="slds-input" value="{!existingRisks[client1Type].option4}" onchange="selectChkBox(this, true, 'existingRisks1ChkBoxesContext'); markAsChanged('Tab1', 'tabExistingCover');"
                                                        />
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                    <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">You have current personal insurance policies that Apex does not advise
                                                        on
                                                    </span>
                                                </div>
                                            </div>

                                            <br/>
                                            <div class="slds-text-heading_small" style="{!IF(single, 'display: none', 'display: block')}">{!IF(ISNULL(client2.account.Name), "Client 2", client2.account.Name)}</div>
                                            <div id="existingRisks2ChkBoxesContext" class="slds-form-element__control" style="{!IF(single, 'display: none', 'display: block')}">
                                                <div class="slds-grid">
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox styleClass="slds-input" value="{!existingRisks[client2Type].option1}" onchange="selectChkBox(this, true, 'existingRisks2ChkBoxesContext'); markAsChanged('Tab1', 'tabExistingCover');"
                                                            disabled="{!single}" />
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                    <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">You have no personal risk policies at this time</span>
                                                </div>
                                                <div class="slds-grid">
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox styleClass="slds-input" value="{!existingRisks[client2Type].option2}" onchange="selectChkBox(this, true, 'existingRisks2ChkBoxesContext'); markAsChanged('Tab1', 'tabExistingCover');"
                                                            disabled="{!single}" />
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                    <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">You have indicated that you have current personal insurance policies
                                                        that Apex does not advise on, and have completed the letter of authority
                                                        to allow us access to these policies. (Please identify the Insurers
                                                        in the Adviser Notes)</span>
                                                </div>
                                                <div class="slds-grid">
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox styleClass="slds-input" value="{!existingRisks[client2Type].option3}" onchange="selectChkBox(this, true, 'existingRisks2ChkBoxesContext'); markAsChanged('Tab1', 'tabExistingCover');"
                                                            disabled="{!single}" />
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                    <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">All Policies are serviced by Apex</span>
                                                </div>
                                                <div class="slds-grid">
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox styleClass="slds-input" value="{!existingRisks[client2Type].option4}" onchange="selectChkBox(this, true, 'existingRisks2ChkBoxesContext'); markAsChanged('Tab1', 'tabExistingCover');"
                                                            disabled="{!single}" />
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                    <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">You have current personal insurance policies that Apex does not advise
                                                        on
                                                    </span>
                                                </div>
                                            </div>
                                            <br/>
                                        </fieldset>
                                    </div>
                                </div>
                                <!-- KNOW YOUR CLIENT - APEX SERVICED COVER -->
                                <div class="slds-section slds-is-open slds-form--compound">
                                    <h3 class="slds-section__title">
                                        <span class="slds-button slds-section__title-action" title="Apex Advice Serviced Cover">Apex Advice Serviced Cover</span>
                                    </h3>
                                    <div class="slds-section__content">
                                        <fieldset class="slds-box slds-theme_default slds-container slds-form-element">
                                            <apex:outputPanel id="AAServicedCoverEmpty" rendered="{!apexServicedCoverList.size ==0}">
                                                <div class="slds-form-element__row slds-size--1-of-1 slds-align--absolute-center slds-text-heading_small" style="padding: 20px;">
                                                    <i>We haven't captured any Apex serviced cover at this point.</i>
                                                    <br/>
                                                </div>
                                            </apex:outputPanel>
                                            <apex:outputPanel id="AAServicedCover" rendered="{!apexServicedCoverList.size != 0}">
                                                <div class="slds-form-element__row slds-border_bottom" style="height:28px;">
                                                    <div class="slds-size--2-of-8">
                                                        <div class="slds-text-heading_small">Who</div>
                                                    </div>
                                                    <div class="slds-size--2-of-8">
                                                        <div class="slds-text-heading_small">Benefit Name</div>
                                                    </div>
                                                    <div class="slds-size--2-of-8">
                                                        <div class="slds-text-heading_small">Policy Number</div>
                                                    </div>
                                                    <div class="slds-size--1-of-8">
                                                        <div class="slds-text-heading_small">Value</div>
                                                    </div>
                                                    <div class="slds-size--1-of-8">
                                                        <div class="slds-text-heading_small">Provider</div>
                                                    </div>
                                                </div>
                                                <apex:repeat value="{!apexServicedCoverList}" var="pb">
                                                    <div class="slds-form-element__row slds-size--1-of-1">
                                                        <div class="slds-m-top--xx-small slds-size--2-of-8">
                                                            {!pb.Account__r.Client_Preferred_Name__c}
                                                        </div>
                                                        <div class="slds-m-top--xx-small slds-size--2-of-8">
                                                            {!pb.Name}
                                                        </div>
                                                        <div class="slds-m-top--xx-small slds-size--2-of-8">
                                                            {!pb.Policy__r.Name}
                                                        </div>
                                                        <div class="slds-m-top--xx-small slds-size--1-of-8">
                                                            <apex:outputText value="${0, Number, ###,###,###}">
                                                                <apex:param value="{!pb.Sum_Insured__c}" />
                                                            </apex:outputText>
                                                        </div>
                                                        <div class="slds-m-top--xx-small slds-size--1-of-8">
                                                            {!pb.Policy__r.Provider__r.Name}
                                                        </div>
                                                    </div>
                                                </apex:repeat>
                                            </apex:outputPanel>
                                        </fieldset>
                                    </div>
                                </div>
                                <!-- KNOW YOUR CLIENT - NON APEX SERVICED COVER -->
                                <div class="slds-section slds-is-open slds-form--compound">
                                    <h3 class="slds-section__title">
                                        <span class="slds-button slds-section__title-action" title="Non Apex Serviced Cover">Non Apex Serviced Cover</span>
                                    </h3>
                                    <div class="slds-section__content">
                                        <fieldset class="slds-box slds-theme_default slds-container slds-form-element">
                                            <div class="slds-form-element__row slds-border_bottom" style="height:28px;">
                                                <div class="slds-size--2-of-8">
                                                    <div class="slds-text-heading_small">Who</div>
                                                </div>
                                                <div class="slds-size--1-of-8">
                                                    <div class="slds-text-heading_small">Provider</div>
                                                </div>
                                                <div class="slds-size--1-of-8">
                                                    <div class="slds-text-heading_small">Policy Number</div>
                                                </div>
                                                <div class="slds-size--2-of-8">
                                                    <div class="slds-text-heading_small">Benefit Type</div>
                                                </div>
                                                <div class="slds-size--1-of-8">
                                                    <div class="slds-text-heading_small">Value</div>
                                                </div>
                                            </div>
                                            <apex:outputPanel id="NonApexCover">
                                                <apex:repeat value="{!nonApexCoverWrappers}" var="nac">
                                                    <div class="slds-form-element__row slds-size--1-of-1" style="padding-left: 20px;padding-right: 20px;">
                                                        <div class="slds-m-top--xx-small slds-size--2-of-8">
                                                            <div class="slds-form-element" style="padding-right: 10px;">
                                                                <div class="slds-form-element__control">
                                                                    <div class="slds-select_container">
                                                                        <apex:selectList value="{!nac.nonApexCover.Person_Insured__c}" multiselect="false" size="1" styleClass="slds-select" onchange="markAsChanged('Tab1', 'tabExistingCover');">
                                                                            <apex:selectOptions value="{!whoListNonApexServicedCover}" />
                                                                        </apex:selectList>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="slds-m-top--xx-small slds-size--1-of-8">
                                                            <div class="slds-form-element" style="padding-right: 10px;">
                                                                <div class="slds-form-element__control">
                                                                    <div class="slds-select_container">
                                                                        <apex:inputField value="{!nac.nonApexCover.Provider__c}" styleClass="slds-select slds-input slds-input--small" onchange="markAsChanged('Tab1', 'tabExistingCover');"
                                                                        />
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="slds-m-top--xx-small slds-size--1-of-8">
                                                            <div class="slds-form-element" style="padding-right: 10px;">
                                                                <div class="slds-form-element__control">
                                                                    <apex:inputField value="{!nac.nonApexCover.Policy_Number__c}" styleClass="slds-input slds-input--small" onchange="markAsChanged('Tab1', 'tabExistingCover');"
                                                                    />
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="slds-m-top--xx-small slds-size--2-of-8">
                                                            <div class="slds-form-element" style="padding-right: 10px;">
                                                                <div class="slds-form-element__control">
                                                                    <div class="slds-select_container">
                                                                        <apex:inputField value="{!nac.nonApexCover.Benefit_Type__c}" styleClass="slds-select slds-input slds-input--small" onchange="markAsChanged('Tab1', 'tabExistingCover');"
                                                                        />
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="slds-m-top--xx-small slds-size--1-of-8">
                                                            <div class="slds-form-element" style="padding-right: 10px;">
                                                                <div class="slds-form-element__control">
                                                                    <apex:inputField value="{!nac.nonApexCover.Value__c}" styleClass="slds-input slds-input--small" onkeydown="handleKeyDown(event)"
                                                                        style="width:97%; padding-left:1.5rem;" onchange="formatNumber(this, 'Non Apex Cover'); markAsChanged('Tab1', 'tabExistingCover');"
                                                                    />
                                                                    <span class="currencysign">$</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="slds-m-top--xx-small slds-size--1-of-8">
                                                            <div class="slds-form-element__control slds-align--absolute-center" style="padding-left: 0;">
                                                                <c:icon elementId="delNonApex-{!nac.tempId}" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#delete')}"
                                                                    classes="iconButton icon-secondary slds-icon--small" onclick="confirmDelete('Non Apex Cover', '{!nac.nonApexCover.Id}', '{!nac.tempId}', '{!nac.nonApexCover.Benefit_Type__c} Policy - Number {!nac.nonApexCover.Policy_Number__c} for {!nac.nonApexCover.Person_Insured__r.Name}'); return false;"
                                                                />
                                                            </div>
                                                        </div>
                                                    </div>
                                                </apex:repeat>
                                                <apex:outputPanel rendered="{!nonApexCoverIsEmpty}">
                                                    <div class="slds-form-element__row" data-id="nonApexCoverEmpty">
                                                        <div style="width:100%;">
                                                            <div class="slds-text-heading_small slds-align_absolute-center">
                                                                <i>No Non Apex Serviced Cover Added</i>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </apex:outputPanel>
                                            </apex:outputPanel>
                                            <apex:commandButton value="Add Policy" rerender="NonApexCover" action="{!addNonApexPolicy}" styleClass="slds-button slds-button_brand slds-float_right active-btn"
                                                title="Add Policy" style="{!IF(nonApexCoverIsEmpty, 'margin-top:10px;', '')} margin-bottom:10px; margin-right:10px;"
                                                onclick="showSpinner();" oncomplete="hideSpinner();">
                                            </apex:commandButton>
                                        </fieldset>
                                    </div>
                                </div>
                            </div>

                            <!-- KNOW YOUR CLIENT - GOALS AND REFERRALS -->
                            <div id="tab-scoped-9" class="{!IF(selectedInternalTab == 'tabCoverGoals', 'slds-show', 'slds-hide')}" role="tabpanel" aria-labelledby="tabCoverGoals">
                                <div class="slds-section slds-is-open slds-form--compound">
                                    <h3 class="slds-section__title">
                                        <span class="slds-button slds-section__title-action" title="Referrals">Client Expectations</span>
                                    </h3>

                                    <br/>
                                    <apex:inputTextArea id="factFindClientExp" rows="10" styleClass="slds-textarea" value="{!factFind.Client_Expectations__c}"
                                    />
                                </div>
                                <div class="slds-section slds-is-open slds-form--compound">
                                    <h3 class="slds-section__title">
                                        <span class="slds-button slds-section__title-action" title="Goals">Goals</span>
                                    </h3>
                                    <div class="slds-section__content">
                                        <apex:outputPanel id="goalsPanel">
                                            <apex:repeat value="{!listPersonalGoalTypes}" var="goalType">
                                                <fieldset class="slds-box slds-theme_default slds-container slds-form-element slds-m-bottom--small">
                                                    <legend class="slds-form-element__label slds-text-title_caps">{!goalType}</legend>
                                                    <apex:outputPanel rendered="{!mapPersonalGoals[goalType].ListSize > 0}">
                                                        <apex:repeat value="{!mapPersonalGoals[goalType].goals}" var="goalWrap">
                                                            <div class="slds-form-element__row slds-m-top--small slds-m-right--x-large">
                                                                <div class="slds-size--1-of-3 slds-form-element__control slds-p-right--x-small">
                                                                    <apex:selectList html-data-id="goalType-{!goalWrap.tempId}" size="1" value="{!goalWrap.goal.Name}" onchange="markAsChanged('Tab1', 'tabCoverGoals');"
                                                                        styleClass="slds-select">
                                                                        <apex:selectOptions value="{!mapPersonalGoalTypes[goalType]}" />
                                                                    </apex:selectList>
                                                                </div>
                                                                <div class="slds-size--2-of-3 slds-p-right--x-small slds-form-element__control">
                                                                    <apex:inputField styleClass="slds-textarea" value="{!goalWrap.goal.Comments__c}" html-placeholder="Place goal details/comments here."
                                                                        onchange="markAsChanged('Tab1', 'tabCoverGoals');" />
                                                                </div>
                                                                <div class="slds-form-element__control slds-align--absolute-center" style="padding-left: 0;">
                                                                    <c:icon elementId="delgoal-{!goalWrap.tempId}" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#delete')}"
                                                                        classes="iconButton icon-secondary slds-icon--small"
                                                                        onclick="confirmDelete('Goal', '{!goalWrap.goal.Id}', '{!goalWrap.tempId}', 'Goal {!goalWrap.goal.Name}'); return false;"
                                                                    />
                                                                </div>
                                                            </div>
                                                        </apex:repeat>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!mapPersonalGoals[goalType].ListSize == 0}">
                                                        <div class="slds-form-element__row slds-m-top--small">
                                                            <div class="slds-size--1-of-1">
                                                                <div class="slds-text-heading_small slds-align_absolute-center">
                                                                    <i>No {!LEFT(goalType,IF(FIND("-",goalType) = 0, LEN(goalType),
                                                                        FIND("-",goalType ) -1 ))} Added</i>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>

                                                    <apex:commandButton value="Add another Goal" action="{!addGoal}" reRender="goalsPanel" styleClass="slds-button slds-button_brand slds-float_right active-btn"
                                                        title="Add another Goal" onClick="showSpinner()" onComplete="hideSpinner()">
                                                        <apex:param name="goalTypeToAdd" value="{!goalType}" assignTo="{!goalTypeToAdd}" />
                                                    </apex:commandButton>
                                                </fieldset>
                                            </apex:repeat>
                                        </apex:outputPanel>
                                    </div>
                                </div>
                                <div class="slds-section slds-is-open slds-form--compound">
                                    <h3 class="slds-section__title">
                                        <span class="slds-button slds-section__title-action" title="Referrals">Referrals</span>
                                    </h3>
                                    <div class="slds-section__content">
                                        <fieldset class="slds-box slds-theme_default slds-container slds-form-element slds-m-bottom--small">
                                            <legend class="slds-form-element__label slds-text-title_caps">Please provide the referral with:</legend>
                                            <div class="slds-form-element__control">
                                                <div class="slds-grid">
                                                    <label class="slds-checkbox slds-m-right--x-small">
                                                        <apex:inputCheckbox styleClass="slds-input" value="{!factFind.Referral_Contact_Financial_Details__c}" onchange="markAsChanged('Tab1', 'tabCoverGoals');"
                                                        />
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                    <span class="slds-form-element__label slds-size--11-of-12 slds-text-body--regular">Contact &amp; Financial details</span>
                                                </div>
                                                <div class="slds-grid">
                                                    <label class="slds-checkbox slds-m-right--x-small">
                                                        <apex:inputCheckbox styleClass="slds-input" value="{!factFind.Referral_Disclosure__c}" onchange="markAsChanged('Tab1', 'tabCoverGoals');"
                                                        />
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                    <span class="slds-form-element__label slds-size--11-of-12 slds-text-body--regular">
                                                        {!IF(joint,'We are','I am')} happy for the above named to receive {!IF(joint,'our','my')} details. {!IF(joint,'We','I')}
                                                        understand that the Referral will contact {!IF(joint,'us','me')}
                                                        to discuss {!IF(joint,'our','my')} further planning needs.
                                                    </span>
                                                </div>
                                            </div>
                                        </fieldset>
                                        <fieldset class="slds-box slds-theme_default slds-container slds-form-element slds-m-bottom--small">
                                            <legend class="slds-form-element__label slds-text-title_caps">Internal</legend>
                                            <apex:repeat value="{!referralTypes['Internal']}" var="refType">
                                                <div class="slds-form-element__row">
                                                    <div class="slds-size--1-of-5 slds-m-right--large">
                                                        <label class="slds-form-element__label">{!refType.referralType.MasterLabel}</label>
                                                        <c:SLDSDynamicLookup SLDSResourceName="$Asset.SLDS" ObjectApiName="User" JSfunction="referralSLDSSelected" DisplayFieldApiNames="Name"
                                                            DisplayFieldsPattern="Name" recordId="{!refType.tempId}" AdditionalWHEREFilter="IsActive = true"
                                                            photo="url->/img/icon/t4v35/standard/user_120.png" LabelName="{!refType.referralType.MasterLabel}"
                                                            PlaceholderText="Search {!refType.referralType.MasterLabel}" SetValueToField="{!refType.internalUserIdSelected}"
                                                        />
                                                    </div>
                                                    <div class="slds-size--1-of-2 slds-m-left--large slds-form-element__control">
                                                        <label class="slds-form-element__label" />
                                                        <apex:inputTextarea rows="1" styleClass="slds-textarea" value="{!refType.notes}" html-placeholder="Place referral details/comments here."
                                                            onchange="markAsChanged('Tab1', 'tabCoverGoals');" />
                                                    </div>
                                                    <apex:inputHidden html-data-id="userChanged-{!refType.tempId}" value="{!refType.userInternalIdChanged}" />
                                                </div>
                                            </apex:repeat>
                                        </fieldset>
                                        <fieldset class="slds-box slds-theme_default slds-container slds-form-element">
                                            <legend class="slds-form-element__label slds-text-title_caps">External</legend>
                                            <apex:repeat value="{!referralTypes['External']}" var="refType">
                                                <div class="slds-form-element__row">
                                                    <div class="slds-size--1-of-8 slds-m-right--large">
                                                        <label class="slds-form-element__label">{!refType.referralType.MasterLabel}</label>
                                                    </div>
                                                    <div class="slds-form-element__control">
                                                        <label class="slds-checkbox">
                                                            <apex:inputCheckbox styleClass="slds-input" value="{!refType.externalChecked}" onchange="markAsChanged('Tab1', 'tabCoverGoals'); enableRowFields('{!refType.tempId}');"
                                                            />
                                                            <span class="slds-checkbox_faux"></span>
                                                        </label>
                                                    </div>
                                                    <div class="slds-size--1-of-7 slds-m-left--large slds-form-element__control">
                                                        <apex:outputPanel rendered="{!refType.providerSelectOptions.size > 0}">
                                                            <apex:selectList html-data-id="external-refType-{!refType.tempId}" size="1" value="{!refType.externalProviderSelected}" styleClass="slds-select slds-is-disabled"
                                                                onchange="markAsChanged('Tab1', 'tabCoverGoals');">
                                                                <apex:selectOptions value="{!refType.providerSelectOptions}" />
                                                            </apex:selectList>
                                                        </apex:outputPanel>
                                                    </div>
                                                    <div class="slds-size--1-of-2 slds-m-left--large slds-form-element__control">
                                                        <apex:inputTextarea rows="1" html-data-id="external-refNote-{!refType.tempId}" styleClass="slds-textarea slds-is-disabled"
                                                            value="{!refType.notes}" html-placeholder="Place referral details/comments here."
                                                            onchange="markAsChanged('Tab1', 'tabCoverGoals');" />
                                                    </div>
                                                </div>
                                            </apex:repeat>
                                            <apex:outputPanel id="tasksCreated" styleClass="slds-border--top slds-p-top--medium slds-m-top--medium" layout="block">
                                                <div class="slds-text-heading--label">Tasks Created</div>
                                                <apex:outputPanel rendered="{!listExternalReferralTasks.size > 0}">
                                                    <apex:repeat value="{!listExternalReferralTasks}" var="task">
                                                        <div class="slds-form-element__row slds-m-top--x-small">
                                                            <div class="slds-size--2-of-8 slds-form-element__control">
                                                                <apex:outputLink value="/{!task.Id}">{!task.Subject}</apex:outputLink>
                                                            </div>
                                                            <div class="slds-size--1-of-8 slds-form-element__control">
                                                                <apex:outputField styleClass="slds-input" value="{!task.Status}" />
                                                            </div>
                                                            <div class="slds-size--1-of-8 slds-form-element__control">
                                                                <apex:outputField styleClass="slds-input" value="{!task.CreatedDate}" />
                                                            </div>
                                                        </div>
                                                    </apex:repeat>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!listExternalReferralTasks.size == 0}">
                                                    <div class="slds-form-element__row slds-m-top--x-small">
                                                        <div class="slds-size--1-of-1">No External Referral Tasks Created</div>
                                                    </div>
                                                </apex:outputPanel>
                                            </apex:outputPanel>
                                        </fieldset>
                                    </div>
                                </div>
                            </div>

                            <!-- KNOW YOUR CLIENT - SUMMARY -->
                            <div id="tab-scoped-10" class="{!IF(selectedInternalTab == 'tabSummary', 'slds-show', 'slds-hide')}" role="tabpanel" aria-labelledby="tabSummary">
                                <c:factFindingSummary mainAccount="{!client1.account.Id}" partnerAccount="{!client2.account.Id}" factFind="{!factFind}" allFamilyMembers="{!listAllFamily}"
                                    accounts="{!listAccounts}" legalEntities="{!listAllLegalEntities}" goals="{!listPersonalGoals}"
                                    assets="{!assetRoleWrappers}" liabilities="{!liabilityRoleWrappers}" incomesExpenses="{!listIncomeExpense}"
                                />
                            </div>
                        </apex:outputPanel>
                    </div>
                    <!--SLDS Section Start-->
                    <div class="slds-form slds-form_compound" style="padding: 0 10px;">
                        <div id="hiddenInput">
                            <apex:inputHidden value="{!totals[0]}" id="client1Income" />
                            <apex:inputHidden value="{!totals[1]}" id="client2Income" />
                            <apex:inputHidden value="{!totals[2]}" id="clientExpenses" />
                            <apex:inputHidden value="{!totals[4]}" id="clientAssets" />
                            <apex:inputHidden value="{!totals[5]}" id="clientLiab" />
                            <apex:inputHidden value="{!totals[6]}" id="clientConLiab" />
                        </div>
                    </div>
                    <!--SLDS Section End-->
                </div>
                <!-- Know Your Client Tab - End -->
                <!-- Needs Analysis Tab -->
                <div class="slds-tabs__content tabsContent {!IF(selectedTab == 'Tab2', 'slds-show', 'slds-hide')}" role="tabpanel" aria-labelledby="Tab2"
                    id="divTab2">
                    <div class="slds-form slds-form_compound" style="padding: 10px;">
                        <apex:outputPanel id="needsPanel">

                            <fieldset class="slds-box slds-theme_default slds-container slds-form-element">
                                <!--Personal Protection Requirement-->
                                <div class="slds-text-heading_medium">Personal Protection Requirements</div>
                                <div class="slds-form-element__row slds-border_bottom" style="height:28px;">
                                    <div class="apex-firstcol"></div>
                                    <div class="apex-othercol">
                                        <div class="slds-text-heading_small slds-align_absolute-center">{! IF(ISNULL(client1.account.Name), "Client 1", client1.account.Name)}</div>
                                    </div>
                                    <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                        <div class="slds-text-heading_small slds-align_absolute-center">{! IF(ISNULL(client2.account.Name), "Client 2", client2.account.Name)}</div>
                                    </div>
                                </div>

                                <div class="slds-form-element__row">
                                    <div class="apex-firstcol">
                                        <div class="slds-text-heading_small">Do you currently have any personal health issues that may affect personal insurance?</div>
                                    </div>
                                    <div class="apex-othercol">
                                        <apex:inputField value="{!analysis[client1Type]['Health Insurance'].Personal_Health_Issues__c}" styleClass="slds-select"
                                            style="width:97%;" onchange="displayOrHideOtherDetails1(this); markAsChanged('Tab2');"
                                            id="phi1" />
                                    </div>
                                    <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                        <apex:inputField value="{!analysis[client2Type]['Health Insurance'].Personal_Health_Issues__c}" styleClass="slds-select"
                                            style="width:97%;" onchange="displayOrHideOtherDetails2(this); markAsChanged('Tab2');"
                                            rendered="{!joint}" id="phi2" />
                                    </div>
                                </div>
                                <!--Other Details for Personal Helath Issues-->
                                <div class="slds-form-element__row {!IF((analysis[client1Type]['Health Insurance'].Personal_Health_Issues__c != 'No' || (AND(joint, analysis[client2Type]['Health Insurance'].Personal_Health_Issues__c != 'No'))), 'slds-show', 'slds-hide')}">
                                    <div class="apex-firstcol">
                                    </div>
                                    <div class="apex-othercol">
                                        <div style="padding-top:10px;" class="slds-form-element divotherdetails1 {!IF(analysis[client1Type]['Health Insurance'].Personal_Health_Issues__c != 'No', 'slds-show', 'slds-hide')}">
                                            <div class="slds-text-body_regular">Other details:</div>
                                            <div class="slds-form-element__control" style="margin-top:5px;">
                                                <apex:inputField styleClass="slds-textarea otherdetails1" onchange="markAsChanged('Tab2');" value="{!analysis[client1Type]['Health Insurance'].Personal_Health_Issues_Other__c}"
                                                    style="width:50%;" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                        <div style="padding-top:10px;" class="slds-form-element divotherdetails2 {!IF(analysis[client2Type]['Health Insurance'].Personal_Health_Issues__c != 'No', 'slds-show', 'slds-hide')}">
                                            <div class="slds-text-body_regular">Other details:</div>
                                            <div class="slds-form-element__control" style="margin-top:5px;">
                                                <apex:inputField styleClass="slds-textarea otherdetails2" onchange="markAsChanged('Tab2');" value="{!analysis[client2Type]['Health Insurance'].Personal_Health_Issues_Other__c}"
                                                    style="width:50%;" rendered="{!joint}" />
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="slds-form-element__row">
                                    <div class="apex-firstcol">
                                        <div class="slds-text-heading_small">Have you smoked in the last 12 months?</div>
                                    </div>
                                    <div class="apex-othercol">
                                        <apex:inputField value="{!analysis[client1Type]['Health Insurance'].Smoker__c}" styleClass="slds-select" onchange="markAsChanged('Tab2');"
                                            style="width:50%; margin-top:5px;" />
                                    </div>
                                    <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                        <apex:inputField value="{!analysis[client2Type]['Health Insurance'].Smoker__c}" styleClass="slds-select" onchange="markAsChanged('Tab2');"
                                            style="width:50%; margin-top:5px;" />
                                    </div>
                                </div>

                                <div class="slds-form-element__row">
                                    <div class="apex-firstcol">
                                        <div class="slds-text-heading_small">Family History</div>
                                    </div>
                                    <div class="apex-othercol">
                                        <div class="slds-form-element__control" style="margin-top:5px;">
                                            <apex:inputField styleClass="slds-textarea" value="{!analysis[client1Type]['Health Insurance'].Family_History_Notes__c}"
                                                onchange="markAsChanged('Tab2');" style="width:50%;" />
                                        </div>
                                    </div>
                                    <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                        <div class="slds-form-element__control" style="margin-top:5px;">
                                            <apex:inputField styleClass="slds-textarea" value="{!analysis[client2Type]['Health Insurance'].Family_History_Notes__c}"
                                                onchange="markAsChanged('Tab2');" style="width:50%;" />
                                        </div>
                                    </div>
                                </div>


                                <!-- Major Medical Event -->
                                <div style="padding-top:25px;">
                                    <div class="slds-text-heading_medium">Major Medical Event</div>
                                    <div class="slds-form-element__group" style="padding-top: 10px;">
                                        <div class="slds-form-element__row slds-border_bottom" style="height:28px;">
                                            <div class="apex-firstcol"></div>
                                            <div class="apex-othercol">
                                                <div class="slds-text-heading_small slds-align_absolute-center">{! IF(ISNULL(client1.account.Name), "Client 1", client1.account.Name)}</div>
                                            </div>
                                            <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                <div class="slds-text-heading_small slds-align_absolute-center">{! IF(ISNULL(client2.account.Name), "Client 2", client2.account.Name)}</div>
                                            </div>
                                        </div>
                                        <!-- Do you have private health insurance? -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Do you have private health insurance?</div>
                                            </div>
                                            <div class="apex-othercol">
                                                <apex:inputField onchange="markAsChanged('Tab2');" value="{!analysis[client1Type]['Health Insurance'].Existing_Private_Health_Insurance__c}"
                                                    styleClass="slds-select" style="width:97%;" />
                                            </div>
                                            <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                <apex:inputField onchange="markAsChanged('Tab2');" value="{!analysis[client2Type]['Health Insurance'].Existing_Private_Health_Insurance__c}"
                                                    styleClass="slds-select" style="width:97%;" rendered="{!joint}" />
                                                <apex:inputField value="{!analysis[client2Type]['Health Insurance'].Existing_Private_Health_Insurance__c}" styleClass="slds-select"
                                                    style="width:97%;" rendered="{!single}" html-disabled="true" />
                                            </div>
                                        </div>
                                        <!-- Benefits Required: -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Benefits Required:</div>
                                            </div>
                                            <div class="apex-othercol">
                                                <div class="slds-grid">
                                                    <div class="slds-form-element__control slds-grid">
                                                        <label class="slds-checkbox">
                                                            <apex:inputCheckbox styleClass="slds-input" value="{!clientBenefits[client1Type].option1}" onchange="markAsChanged('Tab2');"
                                                            />
                                                            <span class="slds-checkbox_faux"></span>
                                                        </label>
                                                        <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">Hospital</span>
                                                    </div>
                                                    <div class="slds-form-element__control slds-grid">
                                                        <label class="slds-checkbox">
                                                            <apex:inputCheckbox styleClass="slds-input" value="{!clientBenefits[client1Type].option2}" onchange="markAsChanged('Tab2');"
                                                            />
                                                            <span class="slds-checkbox_faux"></span>
                                                        </label>
                                                        <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">Specialists and tests</span>
                                                    </div>
                                                    <div class="slds-form-element__control slds-grid">
                                                        <label class="slds-checkbox">
                                                            <apex:inputCheckbox styleClass="slds-input" value="{!clientBenefits[client1Type].option3}" onchange="markAsChanged('Tab2');"
                                                            />
                                                            <span class="slds-checkbox_faux"></span>
                                                        </label>
                                                        <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">Doctors and prescriptions</span>
                                                    </div>
                                                </div>
                                                <div class="slds-grid" style="margin-top: 10px;">
                                                    <div class="slds-form-element__control slds-grid">
                                                        <label class="slds-checkbox">
                                                            <apex:inputCheckbox styleClass="slds-input" value="{!clientBenefits[client1Type].option4}" onchange="markAsChanged('Tab2');"
                                                            />
                                                            <span class="slds-checkbox_faux"></span>
                                                        </label>
                                                        <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">Optical and dental</span>
                                                    </div>
                                                    <div class="slds-form-element__control slds-grid">
                                                        <label class="slds-checkbox">
                                                            <apex:inputCheckbox styleClass="slds-input" value="{!clientBenefits[client1Type].option5}" onchange="markAsChanged('Tab2');"
                                                            />
                                                            <span class="slds-checkbox_faux"></span>
                                                        </label>
                                                        <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">Childrens Cover</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                <div class="slds-grid">
                                                    <div class="slds-form-element__control slds-grid">
                                                        <label class="slds-checkbox">
                                                            <apex:inputCheckbox styleClass="slds-input" value="{!clientBenefits[client2Type].option1}" onchange="markAsChanged('Tab2');"
                                                                disabled="{!single}" />
                                                            <span class="slds-checkbox_faux"></span>
                                                        </label>
                                                        <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">Hospital</span>
                                                    </div>
                                                    <div class="slds-form-element__control slds-grid">
                                                        <label class="slds-checkbox">
                                                            <apex:inputCheckbox styleClass="slds-input" value="{!clientBenefits[client2Type].option2}" onchange="markAsChanged('Tab2');"
                                                                disabled="{!single}" />
                                                            <span class="slds-checkbox_faux"></span>
                                                        </label>
                                                        <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">Specialists and tests</span>
                                                    </div>
                                                    <div class="slds-form-element__control slds-grid">
                                                        <label class="slds-checkbox">
                                                            <apex:inputCheckbox styleClass="slds-input" value="{!clientBenefits[client2Type].option3}" onchange="markAsChanged('Tab2');"
                                                                disabled="{!single}" />
                                                            <span class="slds-checkbox_faux"></span>
                                                        </label>
                                                        <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">Doctors and prescriptions</span>
                                                    </div>
                                                </div>
                                                <div class="slds-grid" style="margin-top: 10px;">
                                                    <div class="slds-form-element__control slds-grid">
                                                        <label class="slds-checkbox">
                                                            <apex:inputCheckbox styleClass="slds-input" value="{!clientBenefits[client2Type].option4}" onchange="markAsChanged('Tab2');"
                                                                disabled="{!single}" />
                                                            <span class="slds-checkbox_faux"></span>
                                                        </label>
                                                        <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">Optical and dental</span>
                                                    </div>
                                                    <div class="slds-form-element__control slds-grid">
                                                        <label class="slds-checkbox">
                                                            <apex:inputCheckbox styleClass="slds-input" value="{!clientBenefits[client2Type].option5}" onchange="markAsChanged('Tab2');"
                                                                disabled="{!single}" />
                                                            <span class="slds-checkbox_faux"></span>
                                                        </label>
                                                        <span class="slds-form-element__label slds-m-top--xxx-small slds-size--11-of-12 slds-text-body--regular">Childrens Cover</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Excess Required? -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Excess Required?</div>
                                            </div>
                                            <div class="apex-othercol">
                                                <apex:inputField value="{!analysis[client1Type]['Health Insurance'].Excess_Required__c}" onchange="markAsChanged('Tab2');"
                                                    styleClass="slds-select" style="width:97%;" />
                                            </div>
                                            <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                <apex:inputField value="{!analysis[client2Type]['Health Insurance'].Excess_Required__c}" onchange="markAsChanged('Tab2');"
                                                    styleClass="slds-select" style="width:97%;" rendered="{!joint}" />
                                                <apex:inputField value="{!analysis[client2Type]['Health Insurance'].Excess_Required__c}" styleClass="slds-select" style="width:97%;"
                                                    rendered="{!single}" html-disabled="true" />
                                            </div>
                                        </div>
                                        <!-- Notes -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Notes</div>
                                            </div>
                                            <div class="apex-othercol">
                                                <apex:inputField value="{!analysis[client1Type]['Health Insurance'].Notes__c}" onchange="markAsChanged('Tab2');" styleClass="slds-textarea"
                                                    style="width:97%;" />
                                            </div>
                                            <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                <apex:inputField value="{!analysis[client2Type]['Health Insurance'].Notes__c}" onchange="markAsChanged('Tab2');" styleClass="slds-textarea"
                                                    style="width:97%;" rendered="{!joint}" />
                                                <apex:inputField value="{!analysis[client2Type]['Health Insurance'].Notes__c}" styleClass="slds-textarea" style="width:97%;"
                                                    rendered="{!single}" html-disabled="true" />
                                            </div>
                                        </div>
                                        <div class="slds-grid" style="padding-top: 20px;">
                                            <div class="slds-text-heading_small" style="margin-right: 10px;">Children included?</div>
                                            <div class="slds-form-element__control">
                                                <label class="slds-checkbox">
                                                    <apex:inputCheckbox styleClass="slds-input" onchange="markAsChanged('Tab2');" value="{!analysis[client1Type]['Health Insurance'].Children_Included__c}"
                                                    />
                                                    <span class="slds-checkbox_faux"></span>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="slds-grid" style="padding-top:20px;">
                                            <apex:repeat value="{!familyMemberWrappers}" var="member">
                                                <apex:outputPanel rendered="{!(member.stringDate != '' && member.stringDate != null)}">
                                                    <div style="padding-right:30px;" class="slds-grid">
                                                        <label class="slds-checkbox">
                                                            <apex:inputCheckbox styleClass="slds-input" value="{!member.includeInAnalysis}" />
                                                            <span class="slds-checkbox_faux"></span>
                                                        </label>
                                                        <apex:outputText value="{!member.account.LastName}, {!member.account.FirstName}<br/>{!member.stringDate}" escape="false"
                                                        />
                                                    </div>
                                                </apex:outputPanel>
                                            </apex:repeat>
                                        </div>
                                    </div>
                                </div>
                                <!-- Making Sure the bills are paid -->
                                <div style="padding-top:25px;">
                                    <div class="slds-text-heading_medium">Making sure the bills are paid</div>
                                    <div class="slds-form-element__group" style="padding-top: 10px;">
                                        <div class="slds-form-element__row slds-border_bottom" style="height:28px;">
                                            <div class="apex-firstcol"></div>
                                            <div class="apex-othercol">
                                                <div class="slds-text-heading_small slds-align_absolute-center">{! IF(ISNULL(client1.account.Name), "Client 1", client1.account.Name)}</div>
                                            </div>
                                            <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                <div class="slds-text-heading_small slds-align_absolute-center">{! IF(ISNULL(client2.account.Name), "Client 2", client2.account.Name)}</div>
                                            </div>
                                        </div>
                                        <!-- Monthly mortgage repayments ($) (OR) -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Monthly mortgage repayments ($) (OR)</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['Income and Mortgage Protection'].Monthly_mortgage_repayments__c}" styleClass="slds-input"
                                                    html-placeholder="Client 1 mortgage repayments" onkeydown="handleKeyDown(event)"
                                                    style="width:97%; padding-left:1.5rem;" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['Income and Mortgage Protection'].Monthly_mortgage_repayments__c}" styleClass="slds-input"
                                                    html-placeholder="Client 2 mortgage repayments" onkeydown="handleKeyDown(event)"
                                                    style="width:97%; padding-left:1.5rem;" rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Income and Mortgage Protection'].Monthly_mortgage_repayments__c}" styleClass="slds-input"
                                                    html-placeholder="Client 2 mortgage repayments" onkeydown="handleKeyDown(event)"
                                                    style="width:97%; padding-left:1.5rem;" rendered="{!single}" html-disabled="true"
                                                />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- Annual Income -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Annual Income</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['Income and Mortgage Protection'].Annual_Income__c}" styleClass="slds-input annualIncome1"
                                                    html-placeholder="Client 1 annual income" onkeydown="handleKeyDown(event)"
                                                    style="width:97%; padding-left:1.5rem;" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['Income and Mortgage Protection'].Annual_Income__c}" styleClass="slds-input annualIncome2"
                                                    html-placeholder="Client 2 annual income" onkeydown="handleKeyDown(event)"
                                                    style="width:97%; padding-left:1.5rem;" rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Income and Mortgage Protection'].Annual_Income__c}" styleClass="slds-input annualIncome2"
                                                    html-placeholder="Client 2 annual income" onkeydown="handleKeyDown(event)"
                                                    style="width:97%; padding-left:1.5rem;" rendered="{!single}" html-disabled="true"
                                                />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- Sum to be ensure assured ($) -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Sum to be ensure assured ($)</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['Income and Mortgage Protection'].Sum_to_be_ensure_assured__c}" styleClass="slds-input"
                                                    html-placeholder="Client 1 sum to be ensured" onkeydown="handleKeyDown(event)"
                                                    style="width:97%; padding-left:1.5rem;" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['Income and Mortgage Protection'].Sum_to_be_ensure_assured__c}" styleClass="slds-input"
                                                    html-placeholder="Client 2 sum to be ensured" onkeydown="handleKeyDown(event)"
                                                    style="width:97%; padding-left:1.5rem;" rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Income and Mortgage Protection'].Sum_to_be_ensure_assured__c}" styleClass="slds-input"
                                                    html-placeholder="Client 2 sum to be ensured" onkeydown="handleKeyDown(event)"
                                                    style="width:97%; padding-left:1.5rem;" rendered="{!single}" html-disabled="true"
                                                />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- Waiting period (Weeks)-->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Waiting period (Weeks)</div>
                                            </div>
                                            <div class="apex-othercol">
                                                <apex:inputField value="{!analysis[client1Type]['Income and Mortgage Protection'].Waiting_Period_Weeks__c}" onkeydown="handleKeyDown(event)"
                                                    onChange="markAsChanged('Tab2');" styleClass="slds-input" html-placeholder="Client 1 waiting period in weeks"
                                                    style="width:97%;" />
                                            </div>
                                            <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['Income and Mortgage Protection'].Waiting_Period_Weeks__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" html-placeholder="Client 2 waiting period in weeks"
                                                    style="width:97%;" onChange="markAsChanged('Tab2');" rendered="{!joint}"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Income and Mortgage Protection'].Waiting_Period_Weeks__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" html-placeholder="Client 2 waiting period in weeks"
                                                    style="width:97%;" rendered="{!single}" html-disabled="true" />
                                            </div>
                                        </div>
                                        <!-- Benefit period -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Benefit period</div>
                                            </div>
                                            <div class="apex-othercol">
                                                <apex:inputField value="{!analysis[client1Type]['Income and Mortgage Protection'].Benefit_Period__c}" onChange="markAsChanged('Tab2');"
                                                    styleClass="slds-select" style="width:97%;" />
                                            </div>
                                            <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['Income and Mortgage Protection'].Benefit_Period__c}" onChange="markAsChanged('Tab2');"
                                                    styleClass="slds-select" style="width:97%;" rendered="{!joint}" />
                                                <apex:inputField value="{!analysis[client2Type]['Income and Mortgage Protection'].Benefit_Period__c}" styleClass="slds-select"
                                                    style="width:97%;" rendered="{!single}" html-disabled="true" />
                                            </div>
                                        </div>
                                        <!-- Existing insurance -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Existing insurance</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['Income and Mortgage Protection'].Existing_Insurance__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" html-placeholder="Client 1 existing insurance amount"
                                                    style="width:97%; padding-left:1.5rem;" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['Income and Mortgage Protection'].Existing_Insurance__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" html-placeholder="Client 2 existing insurance amount"
                                                    style="width:97%; padding-left:1.5rem;" rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Income and Mortgage Protection'].Existing_Insurance__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" html-placeholder="Client 2 existing insurance amount"
                                                    style="width:97%; padding-left:1.5rem;" rendered="{!single}" html-disabled="true"
                                                />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- Cash, savings or disposable assets -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Cash, savings or disposable assets</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['Income and Mortgage Protection'].Cash_savings_or_disposable_assets__c}"
                                                    onkeydown="handleKeyDown(event)" styleClass="slds-input" html-placeholder="Client 1 disposable assets"
                                                    style="width:97%; padding-left:1.5rem;" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['Income and Mortgage Protection'].Cash_savings_or_disposable_assets__c}"
                                                    onkeydown="handleKeyDown(event)" styleClass="slds-input" html-placeholder="Client 2 disposable assets"
                                                    style="width:97%; padding-left:1.5rem;" rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Income and Mortgage Protection'].Cash_savings_or_disposable_assets__c}"
                                                    onkeydown="handleKeyDown(event)" styleClass="slds-input" html-placeholder="Client 2 disposable assets"
                                                    style="width:97%; padding-left:1.5rem;" rendered="{!single}" html-disabled="true"
                                                />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- Details -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Details:</div>
                                            </div>
                                            <div class="apex-othercol">
                                                <apex:inputField value="{!analysis[client1Type]['Income and Mortgage Protection'].Notes__c}" onChange="markAsChanged('Tab2');"
                                                    styleClass="slds-textarea" style="width:97%;" />
                                            </div>
                                            <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                <apex:inputField value="{!analysis[client2Type]['Income and Mortgage Protection'].Notes__c}" onChange="markAsChanged('Tab2');"
                                                    styleClass="slds-textarea" style="width:97%;" rendered="{!joint}" />
                                                <apex:inputField value="{!analysis[client2Type]['Income and Mortgage Protection'].Notes__c}" styleClass="slds-textarea" style="width:97%;"
                                                    rendered="{!single}" html-disabled="true" />
                                            </div>
                                        </div>
                                        <!-- Total Requirements -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Total Requirements</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['Income and Mortgage Protection'].Total_Requirements__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" html-placeholder="Client 1 total requirements" style="width:97%; padding-left:1.5rem;"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');" />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['Income and Mortgage Protection'].Total_Requirements__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" html-placeholder="Client 2 total requirements" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Income and Mortgage Protection'].Total_Requirements__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" html-placeholder="Client 2 total requirements" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!single}" html-disabled="true" />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- If you are too sick to work -->
                                <div style="padding-top:25px;">
                                    <div class="slds-text-heading_medium">If you are too sick to work</div>
                                    <div class="slds-form-element__group" style="padding-top: 10px;">
                                        <div class="slds-form-element__row slds-border_bottom" style="height:28px;">
                                            <div class="apex-firstcol"></div>
                                            <div class="apex-othercol">
                                                <div class="slds-text-heading_small slds-align_absolute-center">{! IF(ISNULL(client1.account.Name), "Client 1", client1.account.Name)}</div>
                                            </div>
                                            <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                <div class="slds-text-heading_small slds-align_absolute-center">{! IF(ISNULL(client2.account.Name), "Client 2", client2.account.Name)}</div>
                                            </div>
                                        </div>
                                        <!-- Liabilities to be paid out (e.g. mortgage, personal loans) ($) -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Liabilities to be paid out (e.g. mortgage, personal loans) ($)
                                                </div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['Trauma'].Liabilities_to_be_paid_out__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input analysis-liab1" html-placeholder="Client 1 liabilities to be paid out"
                                                    style="width:97%; padding-left:1.5rem;" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['Trauma'].Liabilities_to_be_paid_out__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input analysis-liab2" html-placeholder="Client 2 liabilities to be paid out"
                                                    style="width:97%; padding-left:1.5rem;" rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Trauma'].Liabilities_to_be_paid_out__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input analysis-liab2" html-placeholder="Client 2 liabilities to be paid out"
                                                    style="width:97%; padding-left:1.5rem;" rendered="{!single}" html-disabled="true"
                                                />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!--Emergency fund ($) -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Emergency fund ($)</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['Trauma'].Emergency_Fund__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 1 emergency fund" style="width:97%; padding-left:1.5rem;"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');" />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['Trauma'].Emergency_Fund__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 emergency fund" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Trauma'].Emergency_Fund__c}" styleClass="slds-input" html-placeholder="Client 2 emergency fund"
                                                    style="width:97%; padding-left:1.5rem;" rendered="{!single}" html-disabled="true"
                                                />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- Income to be replaced ($ pa) -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Income to be replaced ($ pa)</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['Trauma'].Income_to_be_replaced__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 1 income to be replaced" style="width:97%; padding-left:1.5rem;"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');" />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['Trauma'].Income_to_be_replaced__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 income to be replaced" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Trauma'].Income_to_be_replaced__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 income to be replaced" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!single}" html-disabled="true" />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- For how long would you want your income to be replaced? -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">For how long would you want your income to be replaced?</div>
                                            </div>
                                            <div class="apex-othercol">
                                                <apex:inputField value="{!analysis[client1Type]['Trauma'].Income_Replaced_Months__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 1 income replaced in months" onChange="markAsChanged('Tab2');"
                                                    style="width:97%;" />
                                            </div>
                                            <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                <apex:inputField value="{!analysis[client2Type]['Trauma'].Income_Replaced_Months__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 income replaced in months" onChange="markAsChanged('Tab2');"
                                                    style="width:97%;" rendered="{!joint}" />
                                                <apex:inputField value="{!analysis[client2Type]['Trauma'].Income_Replaced_Months__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 income replaced in months" style="width:97%;"
                                                    rendered="{!single}" html-disabled="true" />
                                            </div>
                                        </div>
                                        <!-- Medical Costs/Recovery -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Medical Costs/Recovery</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['Trauma'].Medical_Costs_Recovery__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 1 medical costs/recovery" style="width:97%; padding-left:1.5rem;"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');" />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['Trauma'].Medical_Costs_Recovery__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 medical costs/recovery" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Trauma'].Medical_Costs_Recovery__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 medical costs/recovery" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!single}" html-disabled="true" />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- Less funds available to meet shortfall -->
                                        <div class="slds-form-element__row" style="padding-top:20px;">
                                            <div class="slds-text-heading_small">Less funds available to meet shortfall</div>
                                        </div>
                                        <!-- Existing insurance  -->
                                        <div class="slds-form-element__row" style="padding-top:10px;">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Existing insurance</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['Trauma'].Existing_Insurance__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 1 existing insurance amount" style="width:97%; padding-left:1.5rem;"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');" />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['Trauma'].Existing_Insurance__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 existing insurance amount" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Trauma'].Existing_Insurance__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 existing insurance amount" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!single}" html-disabled="true" />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- Cash, savings or disposable assets -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Cash, savings or disposable assets</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['Trauma'].Cash_savings_or_disposable_assets__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" html-placeholder="Client 1 disposable assets" style="width:97%; padding-left:1.5rem;"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');" />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['Trauma'].Cash_savings_or_disposable_assets__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" html-placeholder="Client 2 disposable assets" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Trauma'].Cash_savings_or_disposable_assets__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" html-placeholder="Client 2 disposable assets" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!single}" html-disabled="true" />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- Reasoning -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Reasoning</div>
                                            </div>
                                            <div class="apex-othercol">
                                                <apex:inputField value="{!analysis[client1Type]['Trauma'].Notes__c}" styleClass="slds-textarea" onChange="markAsChanged('Tab2');"
                                                    style="width:97%;" />
                                            </div>
                                            <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                <apex:inputField value="{!analysis[client2Type]['Trauma'].Notes__c}" styleClass="slds-textarea" onChange="markAsChanged('Tab2');"
                                                    style="width:97%;" rendered="{!joint}" />
                                                <apex:inputField value="{!analysis[client2Type]['Trauma'].Notes__c}" styleClass="slds-textarea" style="width:97%;" rendered="{!single}"
                                                    html-disabled="true" />
                                            </div>
                                        </div>
                                        <!-- Total Requirements -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Total Requirements</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['Trauma'].Total_Requirements__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 1 total requirements" style="width:97%; padding-left:1.5rem;"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');" />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['Trauma'].Total_Requirements__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 total requirements" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Trauma'].Total_Requirements__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 total requirements" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!single}" html-disabled="true" />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Injury and Permanent Disability -->
                                <div style="padding-top:25px;">
                                    <div class="slds-text-heading_medium">Injury and Permanent Disability</div>
                                    <div class="slds-form-element__group" style="padding-top: 10px;">
                                        <div class="slds-form-element__row slds-border_bottom" style="height:28px;">
                                            <div class="apex-firstcol"></div>
                                            <div class="apex-othercol">
                                                <div class="slds-text-heading_small slds-align_absolute-center">{! IF(ISNULL(client1.account.Name), "Client 1", client1.account.Name)}</div>
                                            </div>
                                            <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                <div class="slds-text-heading_small slds-align_absolute-center">{! IF(ISNULL(client2.account.Name), "Client 2", client2.account.Name)}</div>
                                            </div>
                                        </div>
                                        <!-- Own or Any occupation? -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Own or Any occupation?</div>
                                            </div>
                                            <div class="apex-othercol">
                                                <div class="slds-form-element__control">
                                                    <div class="slds-media">
                                                        <div class="slds-media__figure">
                                                            <label class="slds-checkbox">
                                                                <apex:inputCheckbox styleClass="slds-input" onChange="markAsChanged('Tab2');" value="{!analysis[client1Type]['TPD'].Own_or_Any_Occupation__c}"
                                                                />
                                                                <span class="slds-checkbox_faux"></span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                <div class="slds-form-element__control">
                                                    <div class="slds-media">
                                                        <div class="slds-media__figure">
                                                            <label class="slds-checkbox">
                                                                <apex:inputCheckbox styleClass="slds-input" onChange="markAsChanged('Tab2');" value="{!analysis[client2Type]['TPD'].Own_or_Any_Occupation__c}"
                                                                    disabled="{!single}" />
                                                                <span class="slds-checkbox_faux"></span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!--Liabilities to be paid out (e.g. mortgage, personal loans) ($) -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Liabilities to be paid out (e.g. mortgage, personal loans) ($)
                                                </div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['TPD'].Liabilities_to_be_paid_out__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input analysis-liab1"
                                                    html-placeholder="Client 1 liabilities to be paid out" style="width:97%; padding-left:1.5rem;"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');" />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['TPD'].Liabilities_to_be_paid_out__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input analysis-liab2"
                                                    html-placeholder="Client 2 liabilities to be paid out" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['TPD'].Liabilities_to_be_paid_out__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input analysis-liab2"
                                                    html-placeholder="Client 2 liabilities to be paid out" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!single}" html-disabled="true" />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- Income to be replaced ($ pa) -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Income to be replaced ($ pa)</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['TPD'].Income_to_be_replaced__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 1 income to be replaced" style="width:97%; padding-left:1.5rem;"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');" />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['TPD'].Income_to_be_replaced__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 income to be replaced" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['TPD'].Income_to_be_replaced__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 income to be replaced" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!single}" html-disabled="true" />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- For how long do you need income replacement? -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">For how long do you need income replacement?</div>
                                            </div>
                                            <div class="apex-othercol">
                                                <apex:inputField value="{!analysis[client1Type]['TPD'].Income_Replaced_Months__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 1 income replaced in months" onChange="markAsChanged('Tab2');"
                                                    style="width:97%;" />
                                            </div>
                                            <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                <apex:inputField value="{!analysis[client2Type]['TPD'].Income_Replaced_Months__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 income replaced in months" onChange="markAsChanged('Tab2');"
                                                    style="width:97%;" rendered="{!joint}" />
                                                <apex:inputField value="{!analysis[client2Type]['TPD'].Income_Replaced_Months__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 income replaced in months" style="width:97%;"
                                                    rendered="{!single}" html-disabled="true" />
                                            </div>
                                        </div>
                                        <!-- Medical Costs/Recovery/Emergency fund  -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Medical Costs/Recovery/ Emergency fund</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['TPD'].Medical_Costs_Recovery__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 1 medical costs/recovery" style="width:97%; padding-left:1.5rem;"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');" />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['TPD'].Medical_Costs_Recovery__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 medical costs/recovery" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['TPD'].Medical_Costs_Recovery__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 medical costs/recovery" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!single}" html-disabled="true" />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- Less funds available to meet shortfall -->
                                        <div class="slds-form-element__row" style="padding-top:20px;">
                                            <div class="slds-text-heading_small">Less funds available to meet shortfall</div>
                                        </div>
                                        <!-- Existing insurance -->
                                        <div class="slds-form-element__row" style="padding-top:10px;">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Existing insurance</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['TPD'].Existing_Insurance__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 1 existing insurance amount" style="width:97%; padding-left:1.5rem;"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');" />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['TPD'].Existing_Insurance__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 existing insurance amount" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['TPD'].Existing_Insurance__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 existing insurance amount" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!single}" html-disabled="true" />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- Cash, savings or disposable assets -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Cash, savings or disposable assets</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['TPD'].Cash_savings_or_disposable_assets__c}" styleClass="slds-input" html-placeholder="Client 1 disposable assets"
                                                    onkeydown="handleKeyDown(event)" style="width:97%; padding-left:1.5rem;"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');" />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['TPD'].Cash_savings_or_disposable_assets__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" html-placeholder="Client 2 disposable assets" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['TPD'].Cash_savings_or_disposable_assets__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" html-placeholder="Client 2 disposable assets" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!single}" html-disabled="true" />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- Reasoning -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Reasoning</div>
                                            </div>
                                            <div class="apex-othercol">
                                                <apex:inputField value="{!analysis[client1Type]['TPD'].Notes__c}" styleClass="slds-textarea" onChange="markAsChanged('Tab2');"
                                                    style="width:97%;" />
                                            </div>
                                            <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                <apex:inputField value="{!analysis[client2Type]['TPD'].Notes__c}" styleClass="slds-textarea" onChange="markAsChanged('Tab2');"
                                                    style="width:97%;" rendered="{!joint}" />
                                                <apex:inputField value="{!analysis[client2Type]['TPD'].Notes__c}" styleClass="slds-textarea" style="width:97%;" rendered="{!single}"
                                                    html-disabled="true" />
                                            </div>
                                        </div>
                                        <!-- Total Requirements -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Total Requirements</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['TPD'].Total_Requirements__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 1 total requirements" style="width:97%; padding-left:1.5rem;"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');" />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['TPD'].Total_Requirements__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 total requirements" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['TPD'].Total_Requirements__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 total requirements" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!single}" html-disabled="true" />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Premature Death -->
                                <div style="padding-top:25px;">
                                    <div class="slds-text-heading_medium">Premature Death</div>
                                    <div class="slds-form-element__group" style="padding-top: 10px;">
                                        <div class="slds-form-element__row slds-border_bottom" style="height:28px;">
                                            <div class="apex-firstcol"></div>
                                            <div class="apex-othercol">
                                                <div class="slds-text-heading_small slds-align_absolute-center">{! IF(ISNULL(client1.account.Name), "Client 1", client1.account.Name)}</div>
                                            </div>
                                            <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                <div class="slds-text-heading_small slds-align_absolute-center">{! IF(ISNULL(client2.account.Name), "Client 2", client2.account.Name)}</div>
                                            </div>
                                        </div>
                                        <!-- Own or Any occupation? -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Liabilities to be paid out (eg mortgage, personal loans $)
                                                </div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['Life Cover'].Liabilities_to_be_paid_out__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input analysis-liab1" html-placeholder="Client 1 liabilities to be paid out"
                                                    style="width:97%; padding-left:1.5rem;" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['Life Cover'].Liabilities_to_be_paid_out__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input analysis-liab2" html-placeholder="Client 2 liabilities to be paid out"
                                                    style="width:97%; padding-left:1.5rem;" rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Life Cover'].Liabilities_to_be_paid_out__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input analysis-liab2" html-placeholder="Client 2 liabilities to be paid out"
                                                    style="width:97%; padding-left:1.5rem;" rendered="{!single}" html-disabled="true"
                                                />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- Emergency fund ($) -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Emergency fund ($)</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['Life Cover'].Emergency_Fund__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 1 emergency fund" style="width:97%; padding-left:1.5rem;"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');" />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['Life Cover'].Emergency_Fund__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 emergency fund" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Life Cover'].Emergency_Fund__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 emergency fund" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!single}" html-disabled="true" />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- Funeral expenses ($) -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Funeral expenses ($)</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['Life Cover'].Funeral_Expenses__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 1 funeral expenses" style="width:97%; padding-left:1.5rem;"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');" />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['Life Cover'].Funeral_Expenses__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 funeral expenses" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Life Cover'].Funeral_Expenses__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 funeral expenses" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!single}" html-disabled="true" />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- Income to be replaced ($ pa) -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Income to be replaced ($ pa)</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['Life Cover'].Income_to_be_replaced__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" html-placeholder="Client 1 income to be replaced"
                                                    style="width:97%; padding-left:1.5rem;" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['Life Cover'].Income_to_be_replaced__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" html-placeholder="Client 2 income to be replaced"
                                                    style="width:97%; padding-left:1.5rem;" rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Life Cover'].Income_to_be_replaced__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" html-placeholder="Client 2 income to be replaced"
                                                    style="width:97%; padding-left:1.5rem;" rendered="{!single}" html-disabled="true"
                                                />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- For how long do you need income replacement? -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">For how long do you need income replacement?</div>
                                            </div>
                                            <div class="apex-othercol">
                                                <apex:inputField value="{!analysis[client1Type]['Life Cover'].Income_Replaced_Months__c}" onkeydown="handleKeyDown(event)"
                                                    onChange="markAsChanged('Tab2');" styleClass="slds-input" html-placeholder="Client 1 income replaced in months"
                                                    style="width:97%;" />
                                            </div>
                                            <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                <apex:inputField value="{!analysis[client2Type]['Life Cover'].Income_Replaced_Months__c}" onkeydown="handleKeyDown(event)"
                                                    onChange="markAsChanged('Tab2');" styleClass="slds-input" html-placeholder="Client 2 income replaced in months"
                                                    style="width:97%;" rendered="{!joint}" />
                                                <apex:inputField value="{!analysis[client2Type]['Life Cover'].Income_Replaced_Months__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" html-placeholder="Client 2 income replaced in months"
                                                    style="width:97%;" rendered="{!single}" html-disabled="true" />
                                            </div>
                                        </div>
                                        <!-- Less funds available to meet shortfall -->
                                        <div class="slds-form-element__row" style="padding-top:20px;">
                                            <div class="slds-text-heading_small">Less funds available to meet shortfall</div>
                                        </div>
                                        <!-- Existing insurance -->
                                        <div class="slds-form-element__row" style="padding-top:10px;">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Existing insurance</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['Life Cover'].Existing_Insurance__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 1 existing insurance amount" style="width:97%; padding-left:1.5rem;"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');" />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['Life Cover'].Existing_Insurance__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 existing insurance amount" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Life Cover'].Existing_Insurance__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 existing insurance amount" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!single}" html-disabled="true" />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- Cash, savings or disposable assets -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Cash, savings or disposable assets</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['Life Cover'].Cash_savings_or_disposable_assets__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" html-placeholder="Client 1 disposable assets" style="width:97%; padding-left:1.5rem;"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');" />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['Life Cover'].Cash_savings_or_disposable_assets__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" html-placeholder="Client 2 disposable assets" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Life Cover'].Cash_savings_or_disposable_assets__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" html-placeholder="Client 2 disposable assets" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!single}" html-disabled="true" />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- Reasoning -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Reasoning</div>
                                            </div>
                                            <div class="apex-othercol">
                                                <apex:inputField value="{!analysis[client1Type]['Life Cover'].Notes__c}" styleClass="slds-textarea" onChange="markAsChanged('Tab2');"
                                                    style="width:97%;" />
                                            </div>
                                            <div class="apex-othercol" style="{!IF(single, 'display: none', 'display: block')}">
                                                <apex:inputField value="{!analysis[client2Type]['Life Cover'].Notes__c}" styleClass="slds-textarea" onChange="markAsChanged('Tab2');"
                                                    style="width:97%;" rendered="{!joint}" />
                                                <apex:inputField value="{!analysis[client2Type]['Life Cover'].Notes__c}" styleClass="slds-textarea" style="width:97%;" rendered="{!single}"
                                                    html-disabled="true" />
                                            </div>
                                        </div>
                                        <!-- Total Requirements -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Total Requirements</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['Life Cover'].Total_Requirements__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 1 total requirements" style="width:97%; padding-left:1.5rem;"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');" />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="{!IF(single, 'display: none', 'display: block; padding-left:0')}">
                                                <apex:inputField value="{!analysis[client2Type]['Life Cover'].Total_Requirements__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 total requirements" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!joint}" onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab2');"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Life Cover'].Total_Requirements__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input"
                                                    html-placeholder="Client 2 total requirements" style="width:97%; padding-left:1.5rem;"
                                                    rendered="{!single}" html-disabled="true" />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </fieldset>
                        </apex:outputPanel>
                    </div>
                </div>
                <!-- Needs Analysis Tab - End -->
                <!-- Risk Analysis Tab -->
                <div class="slds-tabs__content tabsContent {!IF(selectedTab == 'Tab3', 'slds-show', 'slds-hide')}" role="tabpanel" aria-labelledby="Tab3"
                    id="divTab3" style="margin-top: {!IF(CONTAINS(opp.Type, 'Investment'), '', 'display:none;')}">
                    <div class="slds-form slds-form_compound" style="padding: 10px;">
                        <apex:outputPanel id="riskAnalysisPanel">
                            <fieldset class="slds-box slds-theme_default slds-container slds-form-element">
                                <div class="slds-text-heading_medium">Understanding you as a Potential Investor</div>
                                <div class="slds-text-body_regular" style="padding-top: 20px;">
                                    Not all investments behave the same way. Some provide returns that are more variable than others. Your investment portfolio
                                    should be diversified, having a mix of investments so that, overall, you are comfortable
                                    with the degree of volatility you might experience to achieve the return you expect.
                                </div>
                                <div class="slds-text-heading_small" style="padding-top:20px;">Understanding you</div>
                                <div class="slds-text-body_regular" style="padding-top:20px;">Are you a tax resident of any country other than New Zealand?</div>
                                <apex:selectList size="1" id="has-tax-resident-country" value="{!factFind.Tax_Resident_Country_Other_Than_NZ__c}" styleClass="slds-select" style="width: 50%;">
                                    <apex:selectOptions value="{!taxesResidentCountry}" />
                                    <apex:actionSupport action="{!changeTaxResidentCountry}" 
                                    					event="onchange" onsubmit="showSpinner();"  
                                    					reRender="internalTabs,pageNotif,riskAnalysisPanel" 
                                                        onComplete="markAsChanged('Tab3');  hideSpinner(); hideMessages();"/>
                                </apex:selectList> 
                                <apex:outputPanel id="tax-information" rendered="{!isRequiredCountryTaxes}">
                                    <div class="slds-text-body_regular" style="padding-top:20px;">What is your tax resident country?</div>
                                    <apex:inputField id="country-resident-tax" value="{!factFind.Tax_Resident_Country_Name__c}" onchange="markAsChanged('Tab3'); " styleClass="slds-select" style="width:50%; margin-top:5px;" />    
                                    <div class="slds-text-body_regular" style="padding-top:20px;">What is the tax number?</div>
                                    <apex:inputField value="{!factFind.Tax_Resident_Number__c}" onchange="markAsChanged('Tab3');" styleClass="slds-select" style="width:50%; margin-top:5px;" />    
                                </apex:outputPanel> 
                                
                                <div class="slds-text-body_regular" style="padding-top:20px;">Which statement best describes your understanding of financial markets and investments?
                                </div>
                                <apex:inputField value="{!analysis[client1Type]['Risk Analysis'].Client_Investment_Knowledge__c}" onchange="markAsChanged('Tab3');"
                                    styleClass="slds-select" style="width:50%; margin-top:5px;" />
                                <div class="slds-text-body_regular" style="padding-top:20px;">Which of the following best describes your investment experience to date?
                                </div>
                                <apex:inputField value="{!analysis[client1Type]['Risk Analysis'].Client_Investment_Experience__c}" onchange="markAsChanged('Tab3');"
                                    styleClass="slds-select" style="width:50%; margin-top:5px;" />
                                <div class="slds-form-element" style="padding-top:20px;">
                                    <div class="slds-text-body_regular">Comments:</div>
                                    <div class="slds-form-element__control" style="margin-top:5px;">
                                        <apex:inputField styleClass="slds-textarea" onchange="markAsChanged('Tab3');" value="{!analysis[client1Type]['Risk Analysis'].Investment_Notes__c}"
                                        />
                                    </div>
                                </div>
                                <div class="slds-text-heading_medium" style="padding-top:20px;">Investment Specific Goals</div>
                                <div class="slds-text-body_regular" style="padding: 10px 0;">This guide below will assist us to identify the most appropriate investment solution for
                                    your needs.
                                </div>
                                <div class="slds-form-element__group" style="padding-top: 10px;">
                                    <div class="slds-form-element__row">
                                        <div class="slds-size--1-of-5">
                                            <div class="slds-text-heading_small">What are you saving for?</div>
                                        </div>
                                        <div class="slds-size--1-of-5">
                                            <div class="slds-text-heading_small slds-align_absolute-center">Term</div>
                                        </div>
                                        <div class="slds-size--1-of-5">
                                            <div class="slds-text-heading_small slds-align_absolute-center">Description</div>
                                        </div>
                                        <div class="slds-size--1-of-5">
                                            <div class="slds-text-heading_small slds-align_absolute-center">Amount</div>
                                        </div>
                                        <div class="slds-size--1-of-5">
                                            <div class="slds-text-heading_small slds-align_absolute-center">Date Required</div>
                                        </div>
                                    </div>
                                    <div class="slds-border_bottom"></div>

                                    <apex:repeat value="{!mapInvestmentGoals['Investment Specific Goals'].goals}" var="goalWrap">
                                        <div class="slds-form-element__row slds-m-top--small slds-m-right--x-large">
                                            <div class="slds-size--1-of-5 slds-form-element__control slds-p-right--x-small">
                                                <apex:outputText value="{!goalWrap.goal.Name}" />
                                            </div>
                                            <div class="slds-size--1-of-5 slds-p-right--x-small slds-form-element__control">
                                                <apex:inputField styleClass="slds-select" value="{!goalWrap.goal.Term__c}" onchange="markAsChanged('Tab3');" />
                                            </div>
                                            <div class="slds-size--1-of-5 slds-p-right--x-small slds-form-element__control">
                                                <apex:inputField styleClass="slds-textarea" value="{!goalWrap.goal.Comments__c}" onchange="markAsChanged('Tab3');" html-placeholder="Place goal description/details here."
                                                />
                                            </div>
                                            <div class="slds-size--1-of-5 slds-p-right--x-small slds-form-element__control">
                                                <apex:inputField styleClass="slds-input" value="{!goalWrap.goal.Amount__c}" onkeydown="handleKeyDown(event)" style="padding-left:1.5rem;"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab3');" html-placeholder="{!goalWrap.goal.Name} amount"
                                                />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="slds-form-element" style="padding-left: 0;">
                                                <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                                                    <c:icon elementId="calDate1" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#event')}" classes="slds-input__icon slds-icon-text-default iconButton"
                                                    />
                                                    <apex:inputText id="date7" value="{!goalWrap.stringDate}" styleClass="slds-input date7" onkeydown="handleKeyDown(event)"
                                                        onchange="markAsChanged('Tab3');" html-placeholder="dd/MM/YYYY" />
                                                </div>
                                            </div>
                                        </div>
                                    </apex:repeat>
                                </div>
                                <div style="padding-top:25px;">
                                    <div class="slds-text-heading_medium">Retirement planning considerations</div>
                                    <div class="slds-form-element__group" style="padding-top: 10px;">
                                        <div class="slds-form-element__row slds-border_bottom" style="height:28px;">
                                            <div class="apex-firstcol"></div>
                                            <div class="apex-othercol">
                                                <div class="slds-text-heading_small slds-align_absolute-center">{! IF(ISNULL(client1.account.Name), "Client 1", client1.account.Name)}</div>
                                            </div>
                                            <div class="apex-othercol">
                                                <div class="slds-text-heading_small slds-align_absolute-center">{! IF(ISNULL(client2.account.Name), "Client 2", client2.account.Name)}</div>
                                            </div>
                                        </div>
                                        <!-- When do you plan to retire? -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">When do you plan to retire?</div>
                                            </div>
                                            <div class="apex-othercol">
                                                <apex:inputField value="{!analysis[client1Type]['Risk Analysis'].Retirement_Planning__c}" onkeydown="handleKeyDown(event)"
                                                    onchange="markAsChanged('Tab3');" styleClass="slds-input" html-placeholder="Age in years"
                                                    style="width:97%;" />
                                            </div>
                                            <div class="apex-othercol">
                                                <apex:inputField value="{!analysis[client2Type]['Risk Analysis'].Retirement_Planning__c}" onkeydown="handleKeyDown(event)"
                                                    onchange="markAsChanged('Tab3');" styleClass="slds-input" html-placeholder="Age in years"
                                                    style="width:97%;" rendered="{!joint}" />
                                                <apex:inputField value="{!analysis[client2Type]['Risk Analysis'].Retirement_Planning__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" html-placeholder="Age in years" style="width:97%;"
                                                    rendered="{!single}" html-disabled="true" />
                                            </div>
                                        </div>
                                        <!-- How much income per annum (in todays dollars) do you estimate you will require in retirement? -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">How much income per annum (in todays dollars) do you estimate you will require
                                                    in retirement?
                                                </div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['Risk Analysis'].Retirement_Income_Estimate__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" style="width:97%; padding-left:1.5rem;" html-placeholder="Client 1 Retirement Income Estimate"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab3');" />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="padding-left: 0;">
                                                <apex:inputField value="{!analysis[client2Type]['Risk Analysis'].Retirement_Income_Estimate__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" style="width:97%; padding-left:1.5rem;" html-placeholder="Client 2 Retirement Income Estimate"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab3');" rendered="{!joint}"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Risk Analysis'].Retirement_Income_Estimate__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" style="width:97%; padding-left:1.5rem;" html-placeholder="Client 2 Retirement Income Estimate"
                                                    rendered="{!single}" html-disabled="true" />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- How much cash do you require to retain for an Emergency fund? -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">How much cash do you require to retain for an Emergency fund?
                                                </div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField value="{!analysis[client1Type]['Risk Analysis'].Emergency_Fund_Planning__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" style="width:97%; padding-left:1.5rem;" html-placeholder="Client 1 Emergency Fund Planning"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab3');" />
                                                <span class="currencysign">$</span>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="padding-left: 0;">
                                                <apex:inputField value="{!analysis[client2Type]['Risk Analysis'].Emergency_Fund_Planning__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" style="width:97%; padding-left:1.5rem;" html-placeholder="Client 2 Emergency Fund Planning"
                                                    onchange="formatNumber(this, 'Analysis'); markAsChanged('Tab3');" rendered="{!joint}"
                                                />
                                                <apex:inputField value="{!analysis[client2Type]['Risk Analysis'].Emergency_Fund_Planning__c}" onkeydown="handleKeyDown(event)"
                                                    styleClass="slds-input" style="width:97%; padding-left:1.5rem;" html-placeholder="Client 2 Emergency Fund Planning"
                                                    rendered="{!single}" html-disabled="true" />
                                                <span class="currencysign">$</span>
                                            </div>
                                        </div>
                                        <!-- Retirement Notes -->
                                        <div class="slds-form-element__row">
                                            <div class="apex-firstcol">
                                                <div class="slds-text-heading_small">Retirement Notes</div>
                                            </div>
                                            <div class="apex-othercol slds-form-element__control">
                                                <apex:inputField styleClass="slds-textarea" value="{!analysis[client1Type]['Risk Analysis'].Notes__c}" onChange="markAsChanged('Tab3');"
                                                    html-placeholder="Client 1 retirement notes." style="width:97%;" />
                                            </div>
                                            <div class="apex-othercol slds-form-element__control" style="padding-left: 0;">
                                                <apex:inputField styleClass="slds-textarea" value="{!analysis[client2Type]['Risk Analysis'].Notes__c}" onChange="markAsChanged('Tab3');"
                                                    html-placeholder="Client 2 retirement notes." style="width:97%;" rendered="{!joint}"
                                                />
                                                <apex:inputField styleClass="slds-textarea" value="{!analysis[client2Type]['Risk Analysis'].Notes__c}" html-placeholder="Client 2 retirement notes."
                                                    style="width:97%;" rendered="{!single}" html-disabled="true" />
                                            </div>
                                        </div>
                                    </div>
                                    <apex:outputPanel rendered="{!NOT(assetsIsEmpty)}">
                                        <div class="slds-form-element__group" style="padding-top: 50px;">
                                            <div class="slds-form-element__row">
                                                <!-- Do you wish to dispose of any assets when you retire? -->
                                                <div style="width:25%;">
                                                    <div class="slds-text-heading_small">Do you wish to dispose of any assets when you retire?</div>
                                                </div>
                                                <div style="width:25%;">
                                                    <div class="slds-text-heading_small slds-align_absolute-center">Asset details</div>
                                                </div>
                                                <!-- Do you wish to gift any assets or money when you retire? -->
                                                <div style="width:25%;">
                                                    <div class="slds-text-heading_small">Do you wish to gift any assets or money when you retire?
                                                    </div>
                                                </div>
                                                <div style="width:25%;">
                                                    <div class="slds-text-heading_small slds-align_absolute-center">Gift details</div>
                                                </div>
                                            </div>
                                            <div class="slds-form-element__row">
                                                <div style="width: 50%;">
                                                    <apex:repeat value="{!assetRoleWrappers}" var="assetWrapper">
                                                        <apex:outputPanel rendered="{!AND(assetWrapper.strOwnerType != '', assetWrapper.asset.Type__c != '')}">
                                                            <div class="slds-grid" style="margin-top:10px;">
                                                                <div style="width:50%;">
                                                                    <apex:outputText value="{!assetWrapper.asset.Name}" escape="false" />
                                                                </div>
                                                                <div class="slds-align_absolute-center slds-form-element__control" style="width:50%;">
                                                                    <label class="slds-checkbox">
                                                                        <apex:inputCheckbox styleClass="slds-input" value="{!assetWrapper.asset.Disposable__c}" onChange="markAsChanged('Tab3');"
                                                                        />
                                                                        <span class="slds-checkbox_faux"></span>
                                                                    </label>
                                                                </div>
                                                            </div>
                                                        </apex:outputPanel>
                                                    </apex:repeat>
                                                </div>
                                                <div style="width: 50%;">
                                                    <apex:repeat value="{!assetRoleWrappers}" var="assetWrapper">
                                                        <apex:outputPanel rendered="{!AND(assetWrapper.strOwnerType != '', assetWrapper.asset.Type__c != '')}">
                                                            <div class="slds-grid" style="margin-top:10px;">
                                                                <div style="width:50%;">
                                                                    <apex:outputText value="{!assetWrapper.asset.Name}" escape="false" />
                                                                </div>
                                                                <div class="slds-align_absolute-center slds-form-element__control" style="width:50%;">
                                                                    <label class="slds-checkbox">
                                                                        <apex:inputCheckbox styleClass="slds-input" value="{!assetWrapper.asset.Gift_Asset__c}" onChange="markAsChanged('Tab3');"
                                                                        />
                                                                        <span class="slds-checkbox_faux"></span>
                                                                    </label>
                                                                </div>
                                                            </div>
                                                        </apex:outputPanel>
                                                    </apex:repeat>
                                                </div>
                                            </div>
                                        </div>
                                    </apex:outputPanel>
                                </div>
                                <!-- Investment Investor Profile Questionnaire -->
                                <div class="slds-section" style="margin-top:20px;">
                                    <h3 class="slds-section__title">
                                        <button class="slds-button slds-section__title-action" onclick="openSection(this, ''); return false;">
                                            <c:icon elementId="switchInvestorProfile" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#switch')}"
                                                classes="slds-section__title-action-icon slds-button__icon slds-button__icon_left"
                                            />
                                            <span class="slds-truncate" title="Investment Investor Profile">Investment Investor Profile</span>
                                        </button>
                                    </h3>
                                    <div aria-hidden="true" class="slds-section__content" style="display:none;">
                                        <fieldset class="slds-box slds-theme_default slds-container slds-form-element">
                                            <div class="slds-text-heading_medium">Investment Investor Profile Questionnaire</div>
                                            <div class="slds-text-body_regular" style="padding: 10px 0;">Use this risk assent questionnaire to discover the right investment portfolio
                                                for you.
                                            </div>
                                            <div style="padding-top:10px;">
                                                <div class="slds-form-element__group">
                                                    <div class="slds-form-element__row">
                                                        <div style="width: 50%; padding-right: 30px;">
                                                            <div class="slds-text-heading_small">A. THE FIRST THREE QUESTIONS CONCERN YOUR TIME HORIZON FOR THIS
                                                                PORTFOLIO
                                                            </div>
                                                            <div class="slds-text-body_regular" style="color: rgb(255,0,0);">(Please tick which answer applies best)
                                                            </div>
                                                            <div style="margin-top: 20px;">
                                                                <apex:repeat value="{!questionnaire}" var="dirKey">
                                                                    <apex:outputPanel rendered="{!questionnaire[dirKey].Order__c < 4}">
                                                                        <div class="slds-text-body_regular">{!questionnaire[dirKey].Question__c}</div>
                                                                        <br/>
                                                                        <div id="{!questionnaire[dirKey].DeveloperName}ChkBoxesContext">
                                                                            <apex:repeat value="{!questionnaire[dirKey].Question_Answers__r}" var="answer">
                                                                                <div class="slds-grid">
                                                                                    <div class="slds-form-element__control">
                                                                                        <label class="slds-checkbox">
                                                                                            <apex:inputCheckbox styleClass="slds-input {!questionnaire[dirKey].DeveloperName}_{!answer.Sort_Order__c}" onchange="selectChkBox(this, true, '{!questionnaire[dirKey].DeveloperName}ChkBoxesContext'); calculateRiskScore(); markAsChanged('Tab3');"
                                                                                                value="{!investmentRiskQ[dirKey].option1}"
                                                                                                rendered="{!answer.Sort_Order__c == 1}"
                                                                                            />
                                                                                            <apex:inputCheckbox styleClass="slds-input {!questionnaire[dirKey].DeveloperName}_{!answer.Sort_Order__c}" onchange="selectChkBox(this, true, '{!questionnaire[dirKey].DeveloperName}ChkBoxesContext'); calculateRiskScore(); markAsChanged('Tab3');"
                                                                                                value="{!investmentRiskQ[dirKey].option2}"
                                                                                                rendered="{!answer.Sort_Order__c == 2}"
                                                                                            />
                                                                                            <apex:inputCheckbox styleClass="slds-input {!questionnaire[dirKey].DeveloperName}_{!answer.Sort_Order__c}" onchange="selectChkBox(this, true, '{!questionnaire[dirKey].DeveloperName}ChkBoxesContext'); calculateRiskScore(); markAsChanged('Tab3');"
                                                                                                value="{!investmentRiskQ[dirKey].option3}"
                                                                                                rendered="{!answer.Sort_Order__c == 3}"
                                                                                            />
                                                                                            <apex:inputCheckbox styleClass="slds-input {!questionnaire[dirKey].DeveloperName}_{!answer.Sort_Order__c}" onchange="selectChkBox(this, true, '{!questionnaire[dirKey].DeveloperName}ChkBoxesContext'); calculateRiskScore(); markAsChanged('Tab3');"
                                                                                                value="{!investmentRiskQ[dirKey].option4}"
                                                                                                rendered="{!answer.Sort_Order__c == 4}"
                                                                                            />
                                                                                            <apex:inputCheckbox styleClass="slds-input {!questionnaire[dirKey].DeveloperName}_{!answer.Sort_Order__c}" onchange="selectChkBox(this, true, '{!questionnaire[dirKey].DeveloperName}ChkBoxesContext'); calculateRiskScore(); markAsChanged('Tab3');"
                                                                                                value="{!investmentRiskQ[dirKey].option5}"
                                                                                                rendered="{!answer.Sort_Order__c == 5}"
                                                                                            />
                                                                                            <span class="slds-checkbox_faux"></span>
                                                                                        </label>
                                                                                    </div>
                                                                                    <apex:outputText value="{!answer.Answer_Value__c}. {!answer.Answer__c}<br/>" escape="false" style="margin-top:2px;" />
                                                                                </div>
                                                                            </apex:repeat>
                                                                        </div>
                                                                        <br/>
                                                                    </apex:outputPanel>
                                                                </apex:repeat>
                                                            </div>
                                                        </div>
                                                        <div style="width: 50%;">
                                                            <div class="slds-text-heading_small">B. GOALS AND EXPECTATIONS</div>
                                                            <div class="slds-text-body_regular" style="color: rgb(255,0,0);">(Please tick which answer applies best)
                                                            </div>
                                                            <div style="margin-top:20px;">
                                                                <apex:repeat value="{!questionnaire}" var="dirKey">
                                                                    <apex:outputPanel rendered="{!questionnaire[dirKey].Order__c > 3}">
                                                                        <div class="slds-text-body_regular">{!questionnaire[dirKey].Question__c}</div>
                                                                        <br/>
                                                                        <div id="{!questionnaire[dirKey].DeveloperName}ChkBoxesContext">
                                                                            <apex:repeat value="{!questionnaire[dirKey].Question_Answers__r}" var="answer">
                                                                                <div class="slds-grid">
                                                                                    <div class="slds-form-element__control">
                                                                                        <label class="slds-checkbox">
                                                                                            <apex:inputCheckbox styleClass="slds-input {!questionnaire[dirKey].DeveloperName}_{!answer.Sort_Order__c}" onchange="selectChkBox(this, true, '{!questionnaire[dirKey].DeveloperName}ChkBoxesContext'); calculateRiskScore(); markAsChanged('Tab3');"
                                                                                                value="{!investmentRiskQ[dirKey].option1}"
                                                                                                rendered="{!answer.Sort_Order__c == 1}"
                                                                                            />
                                                                                            <apex:inputCheckbox styleClass="slds-input {!questionnaire[dirKey].DeveloperName}_{!answer.Sort_Order__c}" onchange="selectChkBox(this, true, '{!questionnaire[dirKey].DeveloperName}ChkBoxesContext'); calculateRiskScore(); markAsChanged('Tab3');"
                                                                                                value="{!investmentRiskQ[dirKey].option2}"
                                                                                                rendered="{!answer.Sort_Order__c == 2}"
                                                                                            />
                                                                                            <apex:inputCheckbox styleClass="slds-input {!questionnaire[dirKey].DeveloperName}_{!answer.Sort_Order__c}" onchange="selectChkBox(this, true, '{!questionnaire[dirKey].DeveloperName}ChkBoxesContext'); calculateRiskScore(); markAsChanged('Tab3');"
                                                                                                value="{!investmentRiskQ[dirKey].option3}"
                                                                                                rendered="{!answer.Sort_Order__c == 3}"
                                                                                            />
                                                                                            <apex:inputCheckbox styleClass="slds-input {!questionnaire[dirKey].DeveloperName}_{!answer.Sort_Order__c}" onchange="selectChkBox(this, true, '{!questionnaire[dirKey].DeveloperName}ChkBoxesContext'); calculateRiskScore(); markAsChanged('Tab3');"
                                                                                                value="{!investmentRiskQ[dirKey].option4}"
                                                                                                rendered="{!answer.Sort_Order__c == 4}"
                                                                                            />
                                                                                            <apex:inputCheckbox styleClass="slds-input {!questionnaire[dirKey].DeveloperName}_{!answer.Sort_Order__c}" onchange="selectChkBox(this, true, '{!questionnaire[dirKey].DeveloperName}ChkBoxesContext'); calculateRiskScore(); markAsChanged('Tab3');"
                                                                                                value="{!investmentRiskQ[dirKey].option5}"
                                                                                                rendered="{!answer.Sort_Order__c == 5}"
                                                                                            />
                                                                                            <span class="slds-checkbox_faux"></span>
                                                                                        </label>
                                                                                    </div>
                                                                                    <apex:outputText value="{!answer.Answer_Value__c}. {!answer.Answer__c}<br/>" escape="false" style="margin-top:2px;" />
                                                                                </div>
                                                                            </apex:repeat>
                                                                        </div>
                                                                        <br/>
                                                                    </apex:outputPanel>
                                                                </apex:repeat>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="margin-top:20px;">
                                                <div class="slds-text-heading_medium">Investment Investor Profile Results</div>
                                                <div style="margin-top: 10px;" class="slds-grid">
                                                    <div style="width:50%; padding-right: 30px;">
                                                        <apex:repeat value="{!scoring}" var="scoring_var">
                                                            <div class="slds-text-heading_small">{!scoring_var.MasterLabel}</div>
                                                            <div class="slds-text-body_regular">{!scoring_var.Profile_Description__c}</div>
                                                            <br/>
                                                        </apex:repeat>
                                                    </div>
                                                    <div style="width:50%;">
                                                        <apex:outputPanel id="riskScore">
                                                            <div class="slds-text-heading_small">Investor Profile Score:&nbsp;
                                                                <apex:outputText value="{!totals[3]}" />
                                                            </div>
                                                            <div style="margin-top: 10px;">
                                                                <div class="slds-text-heading_small" style="padding-top: 5px; margin-right:10px;">Investor Profile Type:
                                                                </div>
                                                                <apex:inputField value="{!analysis[client1Type]['Risk Analysis'].Risk_Profile_Type__c}" onChange="markAsChanged('Tab3');"
                                                                    styleClass="slds-select" style="width: 50%; margin-top:5px;"
                                                                />
                                                            </div>
                                                            <div style="margin-top: 10px;">
                                                                <div class="slds-text-heading_small" style="padding-top: 5px; margin-right:10px;">Agree to Investor Profile Score:
                                                                </div>
                                                                <apex:inputField value="{!analysis[client1Type]['Risk Analysis'].Agree_to_Risk_Profile_Score__c}" onChange="markAsChanged('Tab3');"
                                                                    styleClass="slds-select" style="width: 50%; margin-top:5px;"
                                                                />
                                                            </div>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </div>
                                        </fieldset>
                                    </div>
                                </div>
                            </fieldset>
                        </apex:outputPanel>
                    </div>
                </div>
                <!-- Risk Analysis Tab - End -->
                <!-- Letter of Authority Tab -->
                <div class="slds-tabs__content tabsContent {!IF(selectedTab == 'Tab4', 'slds-show', 'slds-hide')}" role="tabpanel" aria-labelledby="Tab4"
                    id="divTab4">
                    <div class="slds-form slds-form_compound" style="padding: 10px;">
                        <apex:outputPanel id="letterOfAuthorityPanel">
                            <c:vf_picklistAsOptions containerId="LetterofAuthority" fieldName="Letter_of_Authority_Scope__c" defaultChecked="Letter_of_Authority_Scope__c:all"
                                resetValues="{!resetLetterOfEngagement}" saveEnabled="false" resetEnabled="false" allowSelectAll="false"
                                objectApiName="Opportunity" sectionLabel="Make enquires on my/our behalf and be given copies of any:"
                                recordId="{!opp.Id}" setValueToField="{!opp.Letter_of_Authority_Scope__c}" OnChange="markAsChanged('Tab4')"
                            />
                            <div class="slds-text-heading_small" style="padding-bottom: 10px;">Servicing Adviser Authority:</div>
                            <div class="slds-form-element__control" style="padding-bottom: 10px;">
                                <div class="slds-grid">
                                    <label class="slds-checkbox">
                                        <apex:inputCheckbox styleClass="slds-input" value="{!opp.Servicing_Adviser__c}" onchange="markAsChanged('Tab4');" />
                                        <span class="slds-checkbox_faux"></span>
                                    </label>
                                    <span class="slds-form-element__label slds-m-left--x-small slds-size--11-of-12 slds-text-body--regular">I agree that {!opp.Owner.Name} will become my Servicing Adviser.</span>
                                </div>
                            </div>
                        </apex:outputPanel>
                    </div>
                </div>
                <!-- Letter of Authority - End -->
                <!-- Scope of Engagement Tab -->
                <div class="slds-tabs__content tabsContent {!IF(selectedTab == 'Tab5', 'slds-show', 'slds-hide')}" role="tabpanel" aria-labelledby="Tab5"
                    id="divTab5">
                    <div class="slds-form slds-form_compound" style="padding: 10px;">
                        <apex:outputPanel id="scopeOfEngagement">
                            <c:vf_picklistAsOptions containerId="services" fieldName="Services__c" sectionLabel="Services" objectApiName="Opportunity"
                                enforcePicklistDependencies="true" recordId="{!opp.Id}" setValueToField="{!opp.Services__c}"
                                saveEnabled="false" resetEnabled="false" allowSelectAll="false" resetValues="{!resetScopeOfEngagement}"
                                OnChange="markAsChanged('Tab5')" />

                            <fieldset class="slds-box slds-theme_default slds-container slds-form-element" style="margin-bottom: 15px;">
                                <legend class="slds-form-element__label slds-text-title_caps">Product Providers</legend>
                                <c:vf_picklistAsOptions containerId="risk" fieldName="Risk_Providers__c" sectionLabel="Risk" objectApiName="Opportunity"
                                    rendered="{!opp.Show_Risk_Providers__c}" recordId="{!opp.Id}" setValueToField="{!opp.Risk_Providers__c}"
                                    saveEnabled="false" resetEnabled="false" allowSelectAll="false" resetValues="{!resetScopeOfEngagement}"
                                    OnChange="markAsChanged('Tab5')" />
                                <c:vf_picklistAsOptions containerId="kiwisaver" fieldName="Kiwisaver_Providers__c" sectionLabel="Kiwisaver" objectApiName="Opportunity"
                                    rendered="{!opp.Show_Kiwisaver_Providers__c}" recordId="{!opp.Id}" setValueToField="{!opp.Kiwisaver_Providers__c}"
                                    saveEnabled="false" resetEnabled="false" allowSelectAll="false" resetValues="{!resetScopeOfEngagement}"
                                    OnChange="markAsChanged('Tab5')" />
                                <c:vf_picklistAsOptions containerId="investments" fieldName="Investment_Providers__c" sectionLabel="Investments" objectApiName="Opportunity"
                                    rendered="{!opp.Show_Investment_Providers__c}" recordId="{!opp.Id}" setValueToField="{!opp.Investment_Providers__c}"
                                    saveEnabled="false" resetEnabled="false" allowSelectAll="false" resetValues="{!resetScopeOfEngagement}"
                                    OnChange="markAsChanged('Tab5')" />
                                <c:vf_picklistAsOptions containerId="mortgage" fieldName="Mortgage_Providers__c" sectionLabel="Mortgage" objectApiName="Opportunity"
                                    rendered="{!opp.Show_Mortgage_Providers__c}" recordId="{!opp.Id}" setValueToField="{!opp.Mortgage_Providers__c}"
                                    saveEnabled="false" resetEnabled="false" allowSelectAll="false" resetValues="{!resetScopeOfEngagement}"
                                    OnChange="markAsChanged('Tab5')" />
                            </fieldset>

                            <c:vf_picklistAsOptions containerId="benefits" fieldName="Benefits__c" sectionLabel="Benefits" objectApiName="Opportunity"
                                rendered="{!opp.Show_Benefits__c}" recordId="{!opp.Id}" setValueToField="{!opp.Benefits__c}"
                                saveEnabled="false" resetEnabled="false" allowSelectAll="false" resetValues="{!resetScopeOfEngagement}"
                                OnChange="markAsChanged('Tab5')" />
                        </apex:outputPanel>
                    </div>
                </div>
                <!-- Scope of Engagement - End -->
                <!-- Next Steps Tab -->
                <div class="slds-tabs__content tabsContent {!IF(selectedTab == 'Tab6', 'slds-show', 'slds-hide')}" role="tabpanel" aria-labelledby="Tab6"
                    id="divTab6" style="height: calc(100% - 40px)">
                    <div class="slds-form slds-form_compound" style="padding: 10px;">
                        <apex:outputPanel id="nextStepPanel">
                            <fieldset class="slds-box slds-theme_default slds-container slds-form-element">
                                <div class="slds-text-heading_medium">Declarations</div>
                                <div class="slds-text-heading_small" style="padding-top: 10px;">Client Declaration</div>
                                <div class="slds-text-body_regular" style="padding-top: 20px;">
                                    <apex:repeat value="{!declaration}" var="declare">
                                        <div class="slds-text-body_regular">{!declare.Order__c}. {!declare.Content__c}</div>
                                        <br/>
                                    </apex:repeat>
                                </div>
                                <apex:outputPanel id="signaturePanel">
                                    <div class="slds-grid" style="margin-top:20px;">
                                        <div style="width:50%;">
                                            <div class="slds-text-heading_small slds-align_absolute-center" style="padding-top: 5px; margin-right: 10px;">{!client1.account.Name} Signature:
                                            </div>
                                            <div style="margin-top: 10px;">
                                                <apex:image alt="Client 1 Signature" styleClass="slds-align_absolute-center" rendered="{!NOT(ISBLANK(opp.Client_1_Signature__c))}"
                                                    title="Client 1 Signature" url="/sfc/servlet.shepherd/version/download/{!opp.Client_1_Signature__c}"
                                                />
                                                <apex:commandButton action="{!removeClient1Signature}" value="Delete Signature" rerender="signaturePanel" style="margin-top:10px;"
                                                    rendered="{!NOT(ISBLANK(opp.Client_1_Signature__c))}" styleClass="slds-button slds-button_brand active-btn slds-align_absolute-center"
                                                    title="Delete Signature" onclick="showSpinner();" oncomplete="hideSpinner();"
                                                />
                                                <c:SignatureComponent OpptyId="{!opp.Id}" CanvasId="Client1Sig" SignatureName="Client 1 Signature" rendered="{!ISBLANK(opp.Client_1_Signature__c)}"
                                                />
                                            </div>
                                        </div>
                                        <div style="width:50%;{!IF(OR(single, ISBLANK(factFind.Joint_Owner__c)), 'display:none;', '')}">
                                            <div class="slds-text-heading_small slds-align_absolute-center" style="padding-top: 5px; margin-right: 10px;">{!client2.account.Name} Signature:
                                            </div>
                                            <div style="margin-top: 10px;">
                                                <apex:image alt="Client 2 Signature" styleClass="slds-align_absolute-center" rendered="{!NOT(ISBLANK(opp.Client_2_Signature__c))}"
                                                    title="Client 2 Signature" url="/sfc/servlet.shepherd/version/download/{!opp.Client_2_Signature__c}"
                                                />
                                                <apex:commandButton action="{!removeClient2Signature}" value="Delete Signature" rerender="signaturePanel" style="margin-top:10px;"
                                                    rendered="{!NOT(ISBLANK(opp.Client_2_Signature__c))}" styleClass="slds-button slds-button_brand active-btn slds-align_absolute-center"
                                                    title="Delete Signature" onclick="showSpinner();" oncomplete="hideSpinner();"
                                                />
                                                <c:SignatureComponent OpptyId="{!opp.Id}" CanvasId="Client2Sig" SignatureName="Client 2 Signature" rendered="{!ISBLANK(opp.Client_2_Signature__c)}"
                                                />
                                            </div>
                                        </div>
                                    </div>
                                </apex:outputPanel>

                                <div style="height: 72px; padding:20px 0;">
                                    <div style="position: relative;">
                                        <div class="slds-form-element">
                                            <c:vf_congaButton containerId="signed" recordId="{!opp.Id}" objectName="Opportunity" buttonLabel="Save Signed Documents"
                                                buttonVariant="brand" buttonDisabled="{!ISNULL(factFind.Id)}" congaTemplates="{!congaTemplates}"
                                                congaQueries="{!congaQueries}" congaAttributes="{!congaAttributes}" />

                                            <div class="slds-form-element__icon" onmouseover="showTooltip('help2');" onmouseout="hideTooltip('help2');" style="padding-left: 0.4rem; padding-top: 0.4rem;">
                                                <div class="slds-button slds-button_icon slds-button slds-button_icon" aria-describedby="help">
                                                    <c:icon elementId="infoComplianceDocs" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#info')}"
                                                        classes="slds-button__icon" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-popover slds-popover_tooltip slds-nubbin_left slds-fall-into-ground" role="tooltip" id="help2" style="position: absolute; top: -26px; left: 205px;">
                                            <div class="slds-popover__body">Use this option if you have captured all signatures above using the signature
                                                boxes. Generates the compliance documents and saves them back to the Opportunity
                                                in a PDF.
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="slds-text-heading_medium">Sign Documents</div>
                                <div style="height: 72px; padding:20px 0;">
                                    <div style="position: relative;">
                                        <div class="slds-form-element">
                                            <c:vf_congaButton containerId="remoteSigned" recordId="{!opp.Id}" objectName="Opportunity" buttonLabel="Remote Signing - Docusign"
                                                buttonVariant="brand" buttonDisabled="{!ISNULL(factFind.Id)}" congaTemplates="{!congaRemoteTemplates}"
                                                congaQueries="{!congaQueries}" congaAttributes="{!congaRemoteAttributes}" />

                                            <div class="slds-form-element__icon" onmouseover="showTooltip('help1');" onmouseout="hideTooltip('help1');" style="padding-top: 0.4rem; padding-left: 0.4rem;">
                                                <div class="slds-button slds-button_icon slds-button slds-button_icon" aria-describedby="help">
                                                    <c:icon elementId="infoAllDocuments" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#info')}" classes="slds-button__icon"
                                                    />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-popover slds-popover_tooltip slds-nubbin_left slds-fall-into-ground" role="tooltip" id="help1" style="position: absolute; top: -72px; left: 220px;">
                                            <div class="slds-popover__body">Use this option to send the compliance documents to the client via Docusign for
                                                signing. Only use this button if you haven't already captured all signatures
                                                in the signature boxes above. The button generates a PDF made up of the documents
                                                chosen on the next screen and emails it in order to each signer. When all
                                                clients have completed signing the document will be saved back to the Docusign
                                                Status record associated with the Opportunity.
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="slds-text-heading_medium">Next Appointment</div>
                                <div style="height: 72px; padding:20px 0; padding-left: 8px;">
                                    <div style="position: relative;">
                                        <div class="slds-form-element">
                                            <apex:commandLink html-data-toggle="tooltip" html-data-placement="top" styleClass="slds-button slds-button_brand active-btn"
                                                title="Book Follow Up Appointment" value="Book Follow Up Appointment" action="{!openNextAppointment}"
                                                reRender="nextAppointmentPanel" onClick="showSpinner()" onComplete="hideSpinner(); openDialog('nextappointment');">
                                            </apex:commandLink>
                                        </div>
                                    </div>
                                </div>
                                <c:dialog name="nextappointment" title="Book Follow Up Appointment" confirmButtonLabel="Book Follow Up Appointment" confirmButtonClick="saveAppointment">


                                    <apex:outputPanel id="nextAppointmentPanel">
                                        <script>
                                            // Always store duration between the start and end time
                                            var periodDuration = calculateDuration();

                                            // Re-instantialise datepickers
                                            setDatePickers();

                                            function setNewEndTime() {

                                                // Get the start date
                                                let startDateTime = getDateTimeValue(
                                                    document.querySelector(".date11").value,
                                                    getTimeValue('.startTime')
                                                );

                                                // ADd the hours to retrieve the new end time
                                                let newEndDateTime = moment(startDateTime).add(periodDuration, 'hours');

                                                // Assign the date back to the date
                                                document.querySelector(".date12").value = newEndDateTime.format('DD/MM/YYYY');

                                                // Set the time
                                                document.querySelector('.endTime').value = newEndDateTime.format('H:mm');
                                            }

                                            // Calculate the new period of time between start date and end date
                                            function calculateDuration() {

                                                // Get the start date time
                                                let startDateTime = getDateTimeValue(
                                                    document.querySelector(".date11").value,
                                                    getTimeValue('.startTime')
                                                );

                                                // Get the star date time
                                                let endDateTime = getDateTimeValue(
                                                    document.querySelector(".date12").value,
                                                    getTimeValue('.endTime')
                                                );

                                                let duration = moment.duration(moment(endDateTime).diff(moment(startDateTime)));
                                                let hoursDiff = duration.asHours();
                                                return hoursDiff;
                                            }

                                            // Get the time value for the given class name
                                            function getTimeValue(className) {
                                                let timeSelector = document.querySelector(className);
                                                return timeSelector.options[timeSelector.selectedIndex].value;
                                            }

                                            // Take the date string and time string and create a date/time object
                                            function getDateTimeValue(dateValue, timeValue) {
                                                let dateAsMoment = moment(dateValue, "DD/MM/YYYY");
                                                let dateTimeValue = dateAsMoment.toDate();
                                                dateTimeValue.setHours(timeValue.split(':')[0]);
                                                dateTimeValue.setMinutes(timeValue.split(':')[1]);
                                                return dateTimeValue;
                                            }

                                            function timestrToMinutes(timestr) {
                                                var parts = timestr.split(":");
                                                return (parts[0] * 60) +
                                                    (parts[1]);
                                            }

                                            function pad(num) {
                                                return num < 10 ? "0" + num : num;
                                            }

                                            function formatTime(minutes) {
                                                return [Math.floor(minutes / 100 / 60),
                                                pad(minutes % 60),
                                                ].join(":");
                                            }
                                        </script>

                                        <div class="slds-form-element__group">
                                            <div class="slds-form-element__row">
                                                <!--<div style="width: 50%;">
                                                    <div class="slds-text-body_regular" style="padding-bottom: 2px; color: rgb(112, 110, 107);">
                                                        Subject
                                                    </div>
                                                <apex:inputText value="{!nextAppointment.Subject}" styleClass="slds-input" onkeydown="handleKeyDown(event)" style="width: 97%;"
                                                            onchange="markAsChanged('Tab6');" />
                                                </div>-->
                                                <div style="width: 50%;">
                                                    <div class="slds-text-body_regular" style="padding-bottom: 2px; color: rgb(112, 110, 107);">Type
                                                    </div>
                                                    <apex:inputField value="{!nextAppointment.Type}" styleClass="slds-select" style="width: 97%;" onchange="markAsChanged('Tab6');"
                                                    />
                                                </div>
                                                <div style="width: 50%;">
                                                    <div class="slds-text-body_regular" style="padding-bottom: 2px; color: rgb(112, 110, 107);">
                                                        Location
                                                    </div>
                                                    <apex:inputField value="{!nextAppointment.Location}" styleClass="slds-input" style="width: 97%;" onkeydown="handleKeyDown(event)"
                                                        onchange="markAsChanged('Tab6');" />
                                                </div>

                                            </div>
                                            <div class="slds-form-element__row">
                                                <div style="width: 50%;">
                                                    <div class="slds-text-body_regular" style="padding-bottom: 2px; color: rgb(112, 110, 107);">
                                                        <span class="slds-required">*</span>Start
                                                    </div>
                                                    <div class="slds-grid" style="width: 97%;">
                                                        <div class="slds-col">
                                                            <div class="slds-text-body_regular" style="padding-bottom: 2px; color: rgb(112, 110, 107);">
                                                                Date
                                                            </div>
                                                            <div class="slds-form-element" style="padding-left: 0;">
                                                                <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right" style="width: 97%;">
                                                                    <c:icon elementId="calDate11" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#event')}" classes="slds-input__icon slds-icon-text-default iconButton"
                                                                    />
                                                                    <apex:inputText id="date11" value="{!stringDates[10]}" styleClass="slds-input date11" onkeydown="handleKeyDown(event)" html-placeholder="dd/MM/YYYY"
                                                                        onchange="markAsChanged('Tab6'); setNewEndTime();" />
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="slds-col">
                                                            <div class="slds-text-body_regular" style="padding-bottom: 2px; color: rgb(112, 110, 107);">
                                                                Time
                                                            </div>
                                                            <apex:selectList size="1" id="startTime" value="{!eventTime[0]}" styleClass="slds-select startTime" onchange="markAsChanged('Tab6'); setNewEndTime();">
                                                                <apex:selectOptions value="{!timeList}" />
                                                            </apex:selectList>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div style="width: 50%;">
                                                    <div class="slds-text-body_regular" style="padding-bottom: 2px; color: rgb(112, 110, 107);">
                                                        <span class="slds-required">*</span>End
                                                    </div>
                                                    <div class="slds-grid" style="width: 97%;">
                                                        <div class="slds-col">
                                                            <div class="slds-text-body_regular" style="padding-bottom: 2px; color: rgb(112, 110, 107);">
                                                                Date
                                                            </div>
                                                            <div class="slds-form-element" style="padding-left: 0;">
                                                                <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right" style="width: 97%;">
                                                                    <c:icon elementId="calDate12" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#event')}" classes="slds-input__icon slds-icon-text-default iconButton"
                                                                    />
                                                                    <apex:inputText id="date12" value="{!stringDates[11]}" styleClass="slds-input date12" onkeydown="handleKeyDown(event)" html-placeholder="dd/MM/YYYY"
                                                                        onchange="markAsChanged('Tab6'); calculateDuration();"
                                                                    />
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="slds-col">
                                                            <div class="slds-text-body_regular" style="padding-bottom: 2px; color: rgb(112, 110, 107);">
                                                                Time
                                                            </div>
                                                            <apex:selectList size="1" id="endTime" value="{!eventTime[1]}" styleClass="slds-select endTime" onchange="markAsChanged('Tab6'); calculateDuration();">
                                                                <apex:selectOptions value="{!timeList}" />
                                                            </apex:selectList>

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="slds-form-element__row">

                                                <div style="width: 100%;">
                                                    <div class="slds-text-body_regular" style="padding-bottom: 2px; color: rgb(112, 110, 107);">
                                                        Description
                                                    </div>
                                                    <apex:inputField value="{!nextAppointment.Description}" styleClass="slds-textarea" onchange="markAsChanged('Tab6');" style="width: 97%;"
                                                    />
                                                </div>
                                                <!--<div style="width: 50%;">
                                                    <div class="slds-text-body_regular" style="padding-bottom: 2px; color: rgb(112, 110, 107);">Event
                                                        Status
                                                    </div>
                                                    <apex:inputField value="{!nextAppointment.Event_Status__c}" styleClass="slds-select" onchange="markAsChanged('Tab6');"
                                                                     style="width: 97%;"/>
                                                </div>-->
                                            </div>
                                            <!--<div class="slds-form-element__row">
                                                <div style="width: 50%;">
                                                    <div class="slds-text-body_regular" style="padding-bottom: 2px; color: rgb(112, 110, 107);">
                                                        Description
                                                    </div>
                                                    <apex:inputField value="{!nextAppointment.Description}" styleClass="slds-textarea" onchange="markAsChanged('Tab6');"
                                                                     style="width: 97%;"/>
                                                </div>
                                                <div style="width: 50%;">
                                                    <div class="slds-text-body_regular" style="padding-bottom: 2px; color: rgb(112, 110, 107);">Show
                                                        Time As
                                                    </div>
                                                    <apex:inputField value="{!nextAppointment.ShowAs}" styleClass="slds-select" style="width: 97%;" onchange="markAsChanged('Tab6');"/>
                                                </div>
                                            </div>-->
                                            <div class="slds-form-element__row">
                                                <div style="width: 50%;">
                                                    <div class="slds-text-body_regular" style="padding-bottom: 2px; color: rgb(112, 110, 107);">
                                                        Appointment Preference
                                                    </div>
                                                    <apex:inputField value="{!nextAppointment.Appointment_Preference__c}" styleClass="slds-select" onchange="markAsChanged('Tab6');"
                                                        style="width: 97%;" />
                                                </div>
                                                <div style="width: 50%;">
                                                    <div class="slds-text-body_regular" style="padding-bottom: 2px; color: rgb(112, 110, 107);">
                                                        <span class="slds-required">*</span>Assigned To
                                                    </div>
                                                    <div style="width:97%;">
                                                        <c:SLDSDynamicLookup SLDSResourceName="$Asset.SLDS" ObjectApiName="User" DisplayFieldApiNames="Name" DisplayFieldsPattern="Name"
                                                            AdditionalWHEREFilter="IsActive = true" JSfunction="nextStepsSLDSSelected"
                                                            photo="url->/img/icon/t4v35/standard/user_120.png" LabelName="AssignedTo"
                                                            PlaceholderText="Search People..." SetValueToField="{!nextAppointment.OwnerId}"
                                                        />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </apex:outputPanel>
                                    <!--<button class="slds-button slds-button_brand active-btn slds-float_right slds-m-top--small" title="Submit Appointment" onclick="showSpinner();saveAppointment();return false;">
                                        Create Appointment
                                    </button>-->
                                </c:dialog>
                                <div class="slds-text-heading_small" style="padding-top:50px; color: rgb(112, 110, 107);">Are there any additional notes you would like to add?
                                </div>
                                <div class="slds-form-element" style="padding-top:10px;">
                                    <div class="slds-form-element__control">
                                        <apex:inputField styleClass="slds-textarea" value="{!nextStepsNotes.Body}" style="height: 150px;" onchange="markAsChanged('Tab6');"
                                            id="addNotes" />
                                    </div>
                                </div>
                                <button class="slds-button slds-button_brand active-btn slds-float_right slds-m-top--small" title="Submit Appointment" onclick="showSpinner();addNotes();return false;">
                                    Add Notes
                                </button>
                            </fieldset>


                        </apex:outputPanel>
                    </div>
                </div>
                <!-- Next Steps Tab - End -->

                <!-- FAMILY MEMBER Popup - Start -->
                <apex:outputPanel id="familyMemberDialog">
                    <c:dialog name="familyMember" title="{!IF(familyMemberAddEditType == 'add', 'Add', 'Edit')} Relationship" confirmButtonLabel="Save"
                        confirmButtonClick="confirmFamilyMember">
                        <div id="dgFamilyMember" class="slds-form--compound slds-size--1-of-1">
                            <!-- Search Existing -->
                            <apex:outputPanel rendered="{!familyMemberAddEditType == 'add'}">
                                <div class="slds-form-element__row slds-p-bottom--small slds-border--bottom slds-align--absolute-center">
                                    <div class="slds-size--1-of-3">
                                        <div class="slds-text-heading_small">Search Existing</div>
                                    </div>
                                    <div class="slds-form-element__control slds-size--2-of-3">
                                        <c:SLDSDynamicLookup SLDSResourceName="$Asset.SLDS" ObjectApiName="Account" JSfunction="familyAccountSelected" AdditionalWHEREFilter="isPersonAccount = TRUE AND Id NOT IN (SELECT Related_Account__c FROM Relationship__c WHERE Account__c = '{!client1.account.Id}' AND Relationship_Type__c IN ({!familyRelationListCommaSeparated}))"
                                            DisplayFieldApiNames="Name,Type,Birth_Date_Text__c" DisplayFieldsPattern="Name - Type - Birth_Date_Text__c"
                                            OnKeyDown="handleKeyDown(event)" photo="url->/img/icon/t4v35/standard/person_account_120.png"
                                            LabelName="SearchExisting" PlaceholderText="Search" showSpinner='true' SetValueToField="{!familyMemberToAddEdit.selectedAccountId}"
                                        />
                                    </div>
                                </div>
                            </apex:outputPanel>
                            <apex:outputPanel id="familyMemberPanel">
                                <div class="slds-form-element__group">
                                    <div class="slds-form-element__row slds-align--absolute-center slds-p-around--xxx-small slds-p-left--medium">
                                        <div class="slds-size--1-of-3">
                                            <div class="slds-text-heading_small">First Name</div>
                                        </div>
                                        <div class="slds-form-element__control slds-size--2-of-3">
                                            <apex:inputText id="firstName" onkeydown="handleKeyDown(event)" value="{!familyMemberToAddEdit.account.FirstName}" styleClass="slds-input slds-size--1-of-1"
                                            />
                                        </div>
                                    </div>
                                    <div class="slds-form-element__row slds-align--absolute-center slds-p-around--xxx-small slds-p-left--medium">
                                        <div class="slds-size--1-of-3">
                                            <div class="slds-text-heading_small">Last Name</div>
                                        </div>
                                        <div class="slds-form-element__control slds-size--2-of-3">
                                            <apex:inputText id="lastName" onkeydown="handleKeyDown(event)" value="{!familyMemberToAddEdit.account.LastName}" styleClass="slds-input slds-size--1-of-1"
                                            />
                                        </div>
                                    </div>
                                    <apex:outputPanel rendered="{!differentLastName == true}" styleClass="slds-form-element__row slds-p-left--medium">
                                        <div class="slds-size--1-of-3"></div>
                                        <div class="slds-size--2-of-3">
                                            <a href="#" class="slds-m-right--medium" onclick="setLastName(this)" style="text-decoration: underline; font-size: 0.75rem;">{!client1.account.LastName}</a>
                                            <a href="#" onclick="setLastName(this)" style="text-decoration: underline; font-size: 0.75rem;">{!client2.account.LastName}</a>
                                        </div>
                                    </apex:outputPanel>
                                    <div class="slds-form-element__row slds-align--absolute-center slds-p-around--xxx-small slds-p-left--medium">
                                        <div class="slds-size--1-of-3">
                                            <div class="slds-text-heading_small">Relationship</div>
                                        </div>
                                        <div class="slds-form-element__control slds-size--2-of-3">
                                            <apex:selectList size="1" id="relation4" styleClass="slds-select slds-size--1-of-1" value="{!familyMemberToAddEdit.relationship.Relationship_Type__c}">
                                                <apex:selectOptions value="{!familyRelationList}" />
                                            </apex:selectList>
                                        </div>
                                    </div>
                                    <div class="slds-form-element__row slds-align--absolute-center slds-p-around--xxx-small slds-p-left--medium">
                                        <div class="slds-size--1-of-3">
                                            <div class="slds-text-heading_small">Date of Birth</div>
                                        </div>
                                        <div class="slds-size--2-of-3">
                                            <div class="slds-form-element slds-input-has-icon slds-input-has-icon--right">
                                                <c:icon elementId="calDate-db" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#event')}" classes="slds-input__icon slds-icon-text-default iconButton"
                                                />
                                                <apex:inputText id="date" html-data-id="{!familyMemberToAddEdit.tempId}-birthDate" value="{!familyMemberToAddEdit.stringDate}"
                                                    styleClass="slds-input date" onkeydown="handleKeyDown(event)" html-placeholder="dd/MM/YYYY"
                                                />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-form-element__row slds-align--absolute-center slds-p-around--xxx-small slds-p-left--medium">
                                        <div class="slds-size--1-of-3">
                                            <div class="slds-text-heading_small">Dependant?</div>
                                        </div>
                                        <div class="slds-form-element__control slds-size--2-of-3">
                                            <apex:selectList size="1" value="{!familyMemberToAddEdit.relationship.Dependant__c}" styleClass="slds-select" style="width:97%;"
                                                onChange="showHideDependantUntil(this)">
                                                <apex:selectOptions value="{!dependantList}" />
                                            </apex:selectList>
                                        </div>
                                    </div>
                                    <div id="dependantUntilInput" class="slds-form-element__row slds-align--absolute-center slds-p-around--xxx-small slds-p-left--medium {!IF(OR(familyMemberToAddEdit.relationship.Dependant__c == 'Yes', ISNULL(familyMemberToAddEdit.relationship.Dependant__c)), 'slds-show', 'slds-hide')}">
                                        <div class="slds-size--1-of-3">
                                            <div class="slds-text-heading_small">Dependant until</div>
                                        </div>
                                        <div class="slds-form-element__control slds-size--2-of-3">
                                            <apex:inputField html-data-id="{!familyMemberToAddEdit.tempId}-untilAge" onkeydown="handleKeyDown(event)" value="{!familyMemberToAddEdit.account.Dependant_until_age__pc}"
                                                styleClass="slds-input slds-size--1-of-1" />
                                        </div>
                                    </div>
                                </div>
                            </apex:outputPanel>
                        </div>
                    </c:dialog>
                </apex:outputPanel>
                <!-- FAMILY MEMBER Popup - End -->

                <!-- OTHER ENTITy Popup - Start -->
                <apex:outputPanel id="otherEntititiesDialog">
                    <c:dialog name="otherEntities" title="{!IF(otherEntityAddEditType == 'add', 'Add', 'Edit')} Other Entity" confirmButtonLabel="Save"
                        confirmButtonClick="confirmOtherEntity">
                        <div class="slds-form--compound" style="width: 100%;">
                            <div class="slds-form-element__group">
                                <!-- Search Existing -->
                                <apex:outputPanel rendered="{!otherEntityAddEditType == 'add'}">
                                    <div class="slds-form-element__row slds-p-bottom--small slds-border--bottom slds-align--absolute-center slds-p-left--medium">
                                        <div class="slds-size--1-of-3">
                                            <div class="slds-text-heading_small">Search Existing</div>
                                        </div>
                                        <div class="slds-form-element__control slds-size--2-of-3">
                                            <c:SLDSDynamicLookup SLDSResourceName="$Asset.SLDS" ObjectApiName="Account" JSfunction="legalEntitySelected" AdditionalWHEREFilter="RecordTypeId = '{!legalEntityRecordType}'"
                                                DisplayFieldApiNames="Name,Type" DisplayFieldsPattern="Name - Type" OnKeyDown="handleKeyDown(event)"
                                                photo="url->/img/icon/t4v35/standard/person_account_120.png" LabelName="SearchExisting"
                                                PlaceholderText="Search Legal Entities" showSpinner='true' SetValueToField="{!otherEntityToAddEdit.selectedLegalEntityId}"
                                            />
                                        </div>
                                    </div>
                                </apex:outputPanel>
                                <div class="slds-form-element__row slds-p-top--small slds-p-bottom--small">
                                    <div class="slds-text-heading--medium slds-hyphenate slds-align--absolute-center">{!IF(otherEntityAddEditType == 'add', 'Add or Edit New', 'Entity')}</div>
                                </div>
                                <apex:outputPanel id="legalEntityPanel">
                                    <div class="slds-form-element__row slds-align--absolute-center slds-p-around--xxx-small slds-p-left--medium">
                                        <div class="slds-size--1-of-3">
                                            <div class="slds-text-heading_small">Type of Entity</div>
                                        </div>
                                        <div class="slds-form-element__control slds-size--2-of-3">
                                            <apex:inputField id="otherEntityTypeLegal-1" onkeydown="handleKeyDown(event)" value="{!otherEntityToAddEdit.account.Type}"
                                                styleClass="slds-select" style="width:97%;" />
                                        </div>
                                    </div>
                                    <div class="slds-form-element__row slds-align--absolute-center slds-p-around--xxx-small slds-p-left--medium">
                                        <div class="slds-size--1-of-3">
                                            <div class="slds-text-heading_small">Entity Name</div>
                                        </div>
                                        <div class="slds-form-element__control slds-size--2-of-3">
                                            <apex:inputField id="otherEntityNameLegal-1" value="{!otherEntityToAddEdit.account.Name}" styleClass="slds-input" onkeydown="handleKeyDown(event)"
                                                required="false" html-placeholder="Entity Name" style="width:97%;" />
                                        </div>
                                    </div>
                                </apex:outputPanel>
                                <div class="slds-form-element__row slds-align--absolute-center slds-p-top--small">
                                    <div class="slds-text-heading--medium slds-hyphenate slds-align--absolute-center">Add or Edit Roles</div>
                                </div>
                                <apex:outputPanel id="otherEntityRelationshipPanel">
                                    <apex:repeat value="{!otherEntityToAddEdit.roles}" var="role" rendered="{!!otherEntitiesRolesIsEmpty}">
                                        <div class="slds-border--bottom slds-p-top--small">
                                            <div class="slds-form-element__row slds-align--absolute-center slds-p-around--xxx-small slds-p-left--medium">
                                                <div class="slds-size--1-of-3">
                                                    <div class="slds-text-heading_small">Who</div>
                                                </div>
                                                <div class="slds-form-element__control slds-size--2-of-3">
                                                    <apex:selectList html-data-id="otherEntityRoleRelatedAccount-{!role.tempId}" size="1" value="{!role.strOwnerType}" styleClass="slds-select"
                                                        style="width:90%;" disabled="{!NOT(ISBLANK(role.relationship.Id))}">
                                                        <apex:selectOptions value="{!whoList}" />
                                                    </apex:selectList>
                                                </div>
                                            </div>
                                            <div class="slds-form-element__row slds-align--absolute-center slds-p-around--xxx-small slds-p-left--medium">
                                                <div class="slds-size--1-of-3">
                                                    <div class="slds-text-heading_small">Entity Relationship</div>
                                                </div>
                                                <div class="slds-form-element__control slds-size--2-of-3">
                                                    <apex:selectList size="1" html-data-id="otherEntityRoleRelationshipType-{!role.tempId}" styleClass="slds-select" style="width:90%;"
                                                        value="{!role.relationship.Relationship_Type__c}" rendered="{!ISBLANK(role.relationship.Id)}">
                                                        <apex:selectOptions value="{!otherEntityRoleRelationList}" />
                                                    </apex:selectList>
                                                    <apex:outputText value="{!role.relationship.Relationship_Type__c}" styleClass="slds-input slds-is-disabled" rendered="{!NOT(ISBLANK(role.relationship.Id))}"
                                                        style="width:90%;" />
                                                </div>
                                            </div>
                                            <div class="slds-form-element__row slds-align--absolute-center slds-border--bottom slds-p-around--xxx-small slds-p-left--medium slds-p-bottom--medium">
                                                <div class="slds-size--1-of-3">
                                                    <div class="slds-text-heading_small">Entity Description</div>
                                                </div>
                                                <div class="slds-form-element__control slds-size--2-of-3">
                                                    <apex:inputField value="{!role.relationship.Description__c}" styleClass="slds-textarea" onkeydown="handleKeyDown(event)"
                                                        html-placeholder="Entity Description" style="width:90%;" rendered="{!ISBLANK(role.relationship.Id)}"
                                                    />
                                                    <apex:outputText value="{!role.relationship.Description__c}" styleClass="slds-input slds-is-disabled" rendered="{!NOT(ISBLANK(role.relationship.Id))}"
                                                        style="width:90%;" />

                                                    <c:icon elementId="delEntityRole-{!role.tempId}" path="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#delete')}"
                                                        classes="slds-float_right slds-m-right--small iconButton icon-secondary slds-icon--small"
                                                        onclick="confirmDelete('Entity Role', '{!role.relationship.Id}', '{!role.tempId}', 'Entity Role {!role.relationship.Account__r.Name}'); return false;"
                                                    />
                                                </div>
                                            </div>
                                        </div>
                                    </apex:repeat>
                                    <apex:outputPanel rendered="{!otherEntitiesRolesIsEmpty}">
                                        <div class="slds-form-element__row">
                                            <div style="width:100%;">
                                                <div class="slds-text-heading_small slds-align_absolute-center">
                                                    <i>No Roles Added</i>
                                                </div>
                                            </div>
                                        </div>
                                    </apex:outputPanel>
                                    <div class="slds-form-element__row slds-align--absolute-center slds-p-top--small">
                                        <apex:commandButton value="Add Role" rerender="otherEntityRelationshipPanel" action="{!addOtherEntityRole}" styleClass="slds-button slds-button_brand slds-float_right active-btn"
                                            title="Add Role" onclick="showSpinner();" oncomplete="hideSpinner();" />
                                    </div>
                                </apex:outputPanel>
                            </div>
                        </div>
                    </c:dialog>
                </apex:outputPanel>
                <!-- OTHER ENTITY Popup - End -->

                <!-- ASSET DATA Popup - Start -->
                <apex:outputPanel id="assetDataDialog">
                    <c:dialog name="assetData" title="Asset Data" confirmButtonLabel="Save" confirmButtonClick="confirmAssetData">
                        <div class="slds-form--compound" style="width: 100%;">
                            <div class="slds-form-element__group">
                                <div class="slds-form-element__row slds-m-left--medium slds-p-bottom--small">
                                    <div class="label slds-m-top--x-small slds-size--1-of-5">
                                        Asset Address
                                    </div>
                                    <div class="slds-size--4-of-5">
                                        <c:vf_nzPostAddress containerId="assetaddress" recordId="{!assetToAddEdit.asset.Id}" objectApiName="Client_Asset__c" showMap="false"
                                            editEnabled="true" editAlwaysEnabled="true" labelToShow="" streetFieldName="Street__c"
                                            streetFieldValue="{!assetToAddEdit.asset.Street__c}" suburbFieldName="Suburb__c"
                                            suburbFieldValue="{!assetToAddEdit.asset.Suburb__c}" countryFieldName="Country__c"
                                            countryFieldValue="{!assetToAddEdit.asset.Country__c}" cityFieldName="City__c" cityFieldValue="{!assetToAddEdit.asset.City__c}"
                                            postalCodeFieldName="Postal_Code__c" postalCodeFieldValue="{!assetToAddEdit.asset.Postal_Code__c}"
                                            showButtons="false" internationalSearch="true" showAustraliaAsOption="true" OnChange="rerenderLink();"
                                            loadJQuery="false" />
                                    </div>
                                </div>
                                <apex:actionFunction name="rerenderLink" reRender="linkHomes" onComplete="return false;"></apex:actionFunction>
                                <apex:outputPanel id="linkHomes" layout="none">
                                    <div class="slds-form-element__row slds-m-left--medium slds-p-bottom--xx-small">
                                        <div class="slds-size--1-of-5"></div>
                                        <div class="slds-m-left--x-small slds-size--4-of-5">
                                            <apex:outputLink value="https://homes.co.nz/app/area/{!IF(assetToAddEdit.asset.Street__c + ' ' + assetToAddEdit.asset.Suburb__c != ' ',SUBSTITUTE(assetToAddEdit.asset.Street__c + ' ' + assetToAddEdit.asset.Suburb__c, ' ', '-'), '')}"
                                                style="text-decoration: underline" id="searchHomeLink" styleClass="">Check value on Homes.co.nz</apex:outputLink>
                                        </div>
                                    </div>
                                </apex:outputPanel>
                                <div class="slds-form-element__row slds-m-left--medium slds-p-bottom--small">
                                    <div class="slds-size--1-of-5"></div>
                                    <div class="slds-m-left--x-small slds-size--4-of-5">
                                        <apex:outputLink value="https://www.aucklandcouncil.govt.nz/property-rates-valuations/Pages/find-property-rates-valuation.aspx"
                                            style="text-decoration: underline" id="searchCouncilLink" styleClass="">Input address into Auckland Councils rate finder</apex:outputLink>
                                    </div>
                                </div>
                                <div class="slds-form-element__row slds-m-left--medium slds-p-bottom--small">
                                    <div class="label slds-m-top--x-small slds-size--1-of-5">
                                        Asset Value
                                    </div>
                                    <div class="slds-size--2-of-5 slds-form-element__control">
                                        <apex:inputField value="{!assetToAddEdit.asset.Value__c}" onkeydown="handleKeyDown(event)" styleClass="slds-input" style="padding-left:1.5rem;"
                                        />
                                        <span class="currencysign">$</span>
                                    </div>
                                </div>
                                <div class="slds-form-element__row slds-m-left--medium slds-p-bottom--small">
                                    <div class="label slds-size--1-of-5">
                                        Has Mortgage
                                    </div>
                                    <div class="slds-size--2-of-5">
                                        <label class="slds-checkbox">
                                            <input id="hasMortgage" class="slds-input" type="checkbox" name="hasMortgage" />
                                            <span class="slds-checkbox_faux"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </c:dialog>
                </apex:outputPanel>
                <!-- ASSET DATA Popup - End -->

                <!-- NEW INSTITUTION Popup - Start -->
                <apex:outputPanel id="newInstitutionDialog">
                    <c:dialog name="newInstitution" title="Create New Institution" confirmButtonLabel="Save" confirmButtonClick="confirmNewInstitution">
                        <div class="slds-form--compound" style="width: 100%;">
                            <div class="slds-form-element__group">
                                <div class="slds-form-element__row slds-m-left--medium slds-p-bottom--small">
                                    <div class="label slds-m-top--x-small slds-size--1-of-5">
                                        Institution Name
                                    </div>
                                    <div class="slds-size--4-of-5 slds-form-element__control">
                                        <apex:inputText value="{!newInstitution.Name}" styleClass="slds-input" onkeydown="handleKeyDown(event)" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </c:dialog>
                </apex:outputPanel>
                <!-- NEW INSTITUTION Popup - End -->

                <!-- CONFIRM DIALOG - Start -->
                <c:dialog name="confirm" type="alert">
                    <span id="dialog-content-body" class="slds-align_absolute-center" />
                </c:dialog>
                <!-- CONFIRM DIALOG - End -->

                <!-- Hidden Variables - Start -->
                <div id="selectedTab">
                    <apex:inputHidden value="{!selectedTab}" />
                </div>
                <div id="selectedInternalTab">
                    <apex:inputHidden value="{!selectedInternalTab}" />
                </div>
                <!-- Hidden Variables - End -->
            </div>
        </apex:form>

        <script>
            // function to initialize the Appiphony Lightning JS
            $.aljsInit({
                assetsLocation: '{!URLFOR($Asset.SLDS)}', // SLDS Static Resource Path
                scoped: false
            });

            // object variable to record changes o main tabs
            var hasChanges = {};

            // array with the name of the address fields
            var addressFields = ["Street", "Suburb", "City", "PostalCode", "Country"];

            // variable to store the liability tempId when creating a new Institution
            var liabilityWrapperTempId = null;

            // variable to store the asset tempId when creating a new Institution
            var assetWrapperTempId = null;

            // Update the online status icon based on connectivity
            window.addEventListener('online', function () {
                $("#offline").css("display", "none");
                $(".active-btn").removeClass("slds-button_neutral");
                $(".active-btn").addClass("slds-button_brand");
                $(".active-btn").removeAttr("disabled");
                $(".neutral-btn").removeAttr("disabled");

                if ({!!single
            }) {
                $(".client2-btn").removeClass("slds-button_neutral");
                $(".client2-btn").addClass("slds-button_brand");
                $(".client2-btn").removeAttr("disabled");
            }
                });

            // Update the offline status icon based on connectivity
            window.addEventListener('offline', function () {
                $("#offline").css("display", "block");
                $(".active-btn").addClass("slds-button_neutral");
                $(".active-btn").removeClass("slds-button_brand");
                $(".active-btn").attr("disabled", "true");
                $(".neutral-btn").attr("disabled", "true");

                if ({!!single
            }) {
                $(".client2-btn").addClass("slds-button_neutral");
                $(".client2-btn").removeClass("slds-button_brand");
                $(".client2-btn").attr("disabled", "true");
            }
                });

            // funtion to initialize the page
            $(document).ready(function () {

                setDatePickers();

                formatNumber('.totalIncome1', 'span');
                formatNumber('.totalIncome2', 'span');
                formatNumber('.totalExpense', 'span');
                formatNumber('.totalExpenseAnnual', 'span');
                formatNumber('.totalAssets', 'span');
                formatNumber('.totalLiabilities', 'span');
                formatNumber('.totalConLiabilities', 'span');
            });

            // function to format the numbers
            function formatNumber(x, type) {
                var value = type == 'span' ? parseCurrency($(x).text()) : parseCurrency($(x).val().toString());
                value = (type == 'Asset' ? (value || 1) : value).toFixed(2).toString();
                var parts = value.split(".");
                parts[0] = parts[0].replace(",", "").replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,");
                if (value.indexOf(".") == -1) {
                    parts.push("00");
                }

                if (type == 'span') {
                    $(x).text(parts.join("."));
                } else {
                    $(x).val(parts.join("."));

                    if ($(x).hasClass('salary1')) {
                        $('.annualIncome1').val(parts.join("."));
                    }

                    if ($(x).hasClass('salary2')) {
                        $('.annualIncome2').val(parts.join("."));
                    }
                }

                setTotals(type);
            }

            // function to set the totals client side
            function setTotals(type) {
                // income client 1
                if (type === 'Income,Client1' || type === 'Income/Expense' || type === 'tabIncomeExpenses') {
                    setValues('div#client1income input.income1', '.totalIncome1', '1', '.annualIncome1');
                }
                // income client 2
                if (type === 'Income,Client2' || type === 'Income/Expense' || type === 'tabIncomeExpenses') {
                    setValues('div#client2income input.income2', '.totalIncome2', '2', '.annualIncome2');
                }
                // expense
                if (type === 'Expense' || type === 'Income/Expense' || type === 'tabIncomeExpenses') {
                    setValues('div#clientExpenses input.expense', '.totalExpense', '3', '');
                    setValues('div#clientExpenses input.expense', '.totalExpenseAnnual', '', '', 12);
                }
                // asset
                if (type === 'Asset' || type === 'tabAssetsLiabilities') {
                    setValues('div#assets input.asset', '.totalAssets', '4', '');
                }
                // liability
                if (type === 'Liability' || type === 'tabAssetsLiabilities') {
                    setValues('div#liabilities input.liability', '.totalLiabilities', '5', '.analysis-liab1');
                }
                // contingent liability
                if (type === 'ConLiability' || type === 'Contingent Liability' || type === 'tabAssetsLiabilities') {
                    setValues('div#conLiabilities input.conLiab', '.totalConLiabilities', '6', '');
                }
            }

            // function to delete records
            function confirmDelete(type, recordId, tempId, text) {
                // if the record Id is empty, then it's a client side record to delete, so show the type only as text
                if (recordId === '') text = null;

                showConfirm('Delete ' + type, 'Are you sure you want to delete the ' + (text || type) + '?', 'Delete', () => {
                    showSpinner();
                    deleteRecord(recordId, tempId, type);
                })
            }

            // function to set values of number fields
            function setValues(a, x, y, z, multiplier = 1) {
                var total = 0;
                $(a).each(function () {
                    total += parseCurrency($(this).val());
                });
                $(x).text((total * multiplier).toFixed(2));
                formatNumber(x, 'span');

                if (y !== '') {
                    $('#hiddenInput input:nth-child(' + y + ')').val(total.toFixed(2));
                }

                if (z !== '') {
                    $(z).val(total.toFixed(2));
                    formatNumber(z, '');
                }

                if (z == '.analysis-liab1' && {!!single
            }) {
                $('.analysis-liab2').val(total.toFixed(2));
                formatNumber('.analysis-liab2', '');
            }

            return false;
                }



            // function to navigate between main tabs
            function selectTab(tabElem) {
                var oldSelectedTab = $("#selectedTab input").val() || 'Tab1';
                var knowYourClientValid = true;

                // if it's Know your Client validate minimum data
                if (['Tab1', 'Tab2'].indexOf(tabElem.id) === -1) {
                    knowYourClientValid = validateKnowYourClientUncompleteData();
                }

                if (knowYourClientValid) {
                    validateChanges(oldSelectedTab, tabElem.id).then((res) => {
                        if (res) {
                            $("#selectedTab input").val(tabElem.id);
                            // slds-active
                            $(tabElem).parent("li").siblings(".slds-active").removeClass("slds-active");
                            $(tabElem).parent("li").addClass("slds-active");

                            // tabindex
                            $(tabElem).parent("li").siblings().children("a").attr("tabindex", -1);
                            $(tabElem).attr("tabindex", 0);

                            // aria-selected
                            $(tabElem).parent("li").siblings().children("a").attr("aria-selected", false);
                            $(tabElem).attr("aria-selected", true);

                            // hiding previouly selected tab (slds-show/slds-hide)
                            $(tabElem).closest(".slds-tabs--default").children("div[role='tabpanel'].slds-show").addClass("slds-hide").removeClass("slds-show");

                            // displaying newly selected tab (slds-show/slds-hide)
                            $(tabElem).closest(".slds-tabs--default").children("div[aria-labelledby='" + tabElem.id + "']").addClass("slds-show").removeClass("slds-hide");

                            $(".header-btn").css('display', 'none');
                            if (tabElem.id === 'Tab6') {
                                ReloadSignature();
                            } else {
                                $("." + tabElem.id).css('display', '');
                            }
                        }
                    });
                }
            }

            //Javascript function to navigate between the Know the Client Tab
            function selectInternalTab(aElement) {
                var oldSelectedId = $("#selectedInternalTab input").val() || 'tabAgenda';
                var newSelectedId = aElement.id;
                var oldSelectedElement = $("#" + oldSelectedId);

                // slds-active
                $(oldSelectedElement).parent("li").removeClass("slds-is-active");
                $(aElement).parent("li").addClass("slds-is-active");

                // tabindex
                $(oldSelectedElement).parent("li").children("a").attr("tabindex", -1);
                $(aElement).attr("tabindex", 0);

                // aria-selected
                $(oldSelectedElement).parent("li").children("a").attr("aria-selected", false);
                $(aElement).attr("aria-selected", true);

                // hiding previouly selected tab (slds-show/slds-hide)
                $("div[aria-labelledby='" + oldSelectedId + "']").addClass("slds-hide").removeClass("slds-show");

                // displaying newly selected tab (slds-show/slds-hide)
                $("div[aria-labelledby='" + newSelectedId + "']").addClass("slds-show").removeClass("slds-hide");

                // set the selected internal tab
                $("#selectedInternalTab input").val(newSelectedId);

                setTotals(newSelectedId);
            }

            // function to move to next tab when saving
            function moveToNextTab(hasError) {
                var currentTabName, currentTabLink, nextElementSiblingElement;

                if (!hasError) {
                    currentTabName = $("#selectedInternalTab input").val() || 'tabAgenda';
                    currentTabLink = document.getElementById(currentTabName);
                    nextElementSiblingElement = currentTabLink.parentElement.nextElementSibling;
                    if (nextElementSiblingElement != null) {
                        //Move to the next Internal Tab
                        selectInternalTab(nextElementSiblingElement.lastElementChild);
                    } else {
                        //Move to the Next Parent Tab i.e. 'Needs Analysis'
                        currentTabName = $("#selectedTab input").val() || 'Tab1';
                        currentTabLink = document.getElementById(currentTabName);
                        nextElementSiblingElement = currentTabLink.parentElement.nextElementSibling;
                        selectTab(nextElementSiblingElement.lastElementChild);
                    }
                }
            }

            // function to display or hide details for client 1
            function displayOrHideOtherDetails1(picklist, joint) {
                if (picklist.value != 'No') {
                    $('.divotherdetails1').removeClass('slds-hide');
                    $('.divotherdetails1').addClass('slds-show');

                } else {

                    $('.divotherdetails1').removeClass('slds-show');
                    $('.divotherdetails1').addClass('slds-hide');
                    $('.otherdetails1').val('');
                }
            }

            // function to display or hide details for client 1
            function displayOrHideOtherDetails2(picklist, joint) {
                if (picklist.value != 'No') {
                    $('.divotherdetails2').removeClass('slds-hide');
                    $('.divotherdetails2').addClass('slds-show');

                } else {

                    $('.divotherdetails2').removeClass('slds-show');
                    $('.divotherdetails2').addClass('slds-hide');
                    $('.otherdetails2').val('');

                }
            }



            // function to confirm the save of an other entity
            function confirmOtherEntity() {
                // main account
                var types = $('*[id*=otherEntityTypeLegal]');
                var names = $('*[id*=otherEntityNameLegal]');

                var typeValue = $(types[0]).is("select") ? $(types[0]).children("option:selected").val() : $(types[0]).text();
                var nameValue = $(names[0]).is("input") ? $(names[0]).val() : $(names[0]).text();

                if (typeValue === '') {
                    showAlert('Required Fields', 'Type of Entity is Required for saving');
                    return false;
                }

                if (nameValue === '') {
                    showAlert('Required Fields', 'Entity Name is Required for saving');
                    return false;
                }

                // roles
                var countRelatedAccounts = 0;

                // related accounts
                $('select[data-id*=otherEntityRoleRelatedAccount]').each((index, value) => {
                    if ($(value).children("option:selected").val() !== '') {
                        countRelatedAccounts++;
                    }
                });

                if (countRelatedAccounts === 0) {
                    showAlert('Required Fields', 'At least one role with Who is needed for saving.');
                    return false;
                }

                // if there are no errors call the function
                showSpinner();
                saveOtherEntity();
            }

            // function to confirm the save of a family member
            function confirmFamilyMember() {
                // main account
                var firstName = $('*[id*=firstName]').val();
                var lastName = $('*[id*=lastName]').val();

                if (firstName === '' || lastName === '') {
                    showAlert('Required Fields', 'First and Last Name are Required for saving');
                    return false;
                }
                // if there are no errors call the function
                showSpinner();
                saveMember();
            }

            // function to confirm asset data
            function confirmAssetData() {
                var hasMortgage = $('#hasMortgage').prop('checked');
                showSpinner();
                saveAsset(hasMortgage ? 'true' : 'false');

                if (hasMortgage) {
                    markAsChanged('Tab1', 'tabAssetsLiabilities');
                }
            }

            // function to confirm new Institution
            function confirmNewInstitution() {
                showSpinner();
                var origin = (liabilityWrapperTempId !== null ? 'Liability' : (assetWrapperTempId !== null ? 'Asset' : ''));
                var tempId = liabilityWrapperTempId || assetWrapperTempId;

                // save
                saveInstitution(tempId, origin);

                // mark the tab and subtab as changed and clean the variable
                markAsChanged('Tab1', 'tabAssetsLiabilities');
                liabilityWrapperTempId = null;
                assetWrapperTempId = null;
            }

            // function to set the last name of the family member when clicking on the link
            function setLastName(element) {
                $('*[id*=lastName]').val($(element).text());
            }

            // function to show or hide the postal address
            function showHidePostalAddress(type) {
                $('#' + type + '-postalAddress').toggleClass('slds-show slds-hide');
            }

            // function to copy the address to partner
            function copyAddress(typeOrigin, typeDestination, origin, destination) {
                var containerOrigin = $(`#container-${origin}${typeOrigin}address`);
                var containerDestination = $(`#container-${destination}${typeDestination}address`);

                addressFields.forEach((fl) => {
                    var originValue = $(containerOrigin).find('*[data-name*=' + fl + ']').val();

                    if (originValue) {
                        $(containerDestination).find('*[data-name*=' + fl + ']').val(originValue);
                        $('*[data-id=set' + destination + typeDestination + 'address' + fl + ']').val(originValue);
                    }
                })
            }

            // function to check if postal address is blank and fill it if it's
            function checkAndFillPostalAddress() {
                // client 1 check
                var containerOrigin = $(`#container-client1homeaddress`);
                var containerDestination = $(`#container-client1postaladdress`);
                var empty = true;

                addressFields.forEach((fl) => {
                    if ($(containerDestination).find('*[data-name*=' + fl + ']').val() !== '') {
                        empty = false;
                    }
                });

                if (empty) {
                    copyAddress('home', 'postal', 'client1', 'client1');
                    // showHidePostalAddress('primary');
                    $('*[data-id*=differentPrimaryPostalAddressCheckbox]').prop('checked', false);
                }

                // client 2 check
                containerOrigin = $(`#container-client2homeaddress`);
                containerDestination = $(`#container-client2postaladdress`);
                empty = true;

                addressFields.forEach((fl) => {
                    if ($(containerDestination).find('*[data-name*=' + fl + ']').val() !== '') {
                        empty = false;
                    }
                });

                if (empty) {
                    copyAddress('home', 'postal', 'client2', 'client2');
                    // showHidePostalAddress('joint');
                    $('*[data-id*=differentJointPostalAddressCheckbox]').prop('checked', false);
                }

                return false;
            }

            // function to validate uncomplete data on Know Your Client tab (AP2-414)
            function validateKnowYourClientUncompleteData() {
                let completed = true;
                let emptyField = false;
                let nonHave = false;
                let chosenNotTo = false;
                let message = 'You need to complete the following sections to continue: ';

                // YOUR FAMILY
                emptyField = $('*[data-id=familyMembersEmpty]').length > 0;
                nonHave = $('*[data-id=noFamilyMembers]').prop('checked');
                chosenNotTo = $('*[data-id=chosenNotToProvideFamilyMembers]').prop('checked');

                if (emptyField && !nonHave && !chosenNotTo) {
                    completed = false;
                    message += ' Your Family,';
                }

                // EMPLOYMENT
                emptyField = $('*[data-id=employmentClient1Empty]').length > 0 && $('*[data-id=employmentClient2Empty]').length > 0;
                chosenNotTo = $('*[data-id=chosenNotToProvideEmployments]').prop('checked');

                if (emptyField && !chosenNotTo) {
                    completed = false;
                    message += ' Employment,';
                }

                // OTHER ENTITIES
                emptyField = $('*[data-id=otherEntitiesEmpty]').length > 0;
                nonHave = $('*[data-id=noOtherEntities]').prop('checked');
                chosenNotTo = $('*[data-id=chosenNotToProvideOtherEntities]').prop('checked');

                if (emptyField && !nonHave && !chosenNotTo) {
                    completed = false;
                    message += ' Other Entities,';
                }

                // ASSETS
                emptyField = $('*[data-id=assetsEmpty]').length > 0;
                nonHave = $('*[data-id=noAssets]').prop('checked');
                chosenNotTo = $('*[data-id=chosenNotToProvideAssets]').prop('checked');

                if (emptyField && !nonHave && !chosenNotTo) {
                    completed = false;
                    message += ' Assets,';
                }

                // LIABILITIES
                emptyField = $('*[data-id=liabilitiesEmpty]').length > 0;
                nonHave = $('*[data-id=noLiabilities]').prop('checked');
                chosenNotTo = $('*[data-id=chosenNotToProvideLiabilities]').prop('checked');

                if (emptyField && !nonHave && !chosenNotTo) {
                    completed = false;
                    message += ' Liabilities,';
                }

                // INCOME
                emptyField = $('*[data-id=incomeClient1Empty]').length > 0 && $('*[data-id=incomeClient2Empty]').length > 0;
                chosenNotTo = $('*[data-id=chosenNotToProvideIncome]').prop('checked');

                if (emptyField && !chosenNotTo) {
                    completed = false;
                    message += ' Income,';
                }

                // EXPENSES
                emptyField = $('*[data-id=expensesEmpty]').length > 0;
                nonHave = $('*[data-id=noExpenses]').prop('checked');
                chosenNotTo = $('*[data-id=chosenNotToProvideExpenses]').prop('checked');

                if (emptyField && !nonHave && !chosenNotTo) {
                    completed = false;
                    message += ' Expenses,';
                }

                if (!completed) {
                    // remove the last comma and if there is still 1 comma, then change the latest one for and
                    message = message.substring(0, message.length - 1);

                    if (message.indexOf(',') !== -1) {
                        var lastPositionComma = message.lastIndexOf(',');
                        message = message.substring(0, lastPositionComma) + ' and ' + message.substring(lastPositionComma + 1);
                    }

                    showAlert('Uncomplete data', message);
                }

                return completed;
            }

            // function to validate if the tabs has changes
            function validateChanges(oldTab, newTab) {
                const validateTogether = ['Tab1', 'Tab2'].indexOf(newTab) === -1;

                return new Promise((resolve, reject) => {
                    if (validateTogether) {
                        if ((!validateTogether && hasChanges[oldTab]) || (validateTogether && (hasChanges['Tab1'] || hasChanges['Tab2']))) {
                            showConfirm('Changes', 'There are unsaved changes. Do you want to save them?', 'Save Changes', () => {
                                showSpinner();
                                switch (oldTab) {
                                    case 'Tab1':
                                        checkAndFillPostalAddress();
                                        saveAndNextTab1();
                                        break;
                                    case 'Tab2':
                                        saveNeedAnalysis();
                                        break;
                                    case 'Tab3':
                                        saveRiskAnalysis();
                                        break;
                                    case 'Tab4':
                                        loaScopeSaveRecord();
                                        break;
                                    case 'Tab5':
                                        scopeSaveRecord();
                                        break;
                                    case 'Tab6':
                                        saveAppointment();
                                        addNotes();
                                        break;
                                    default:
                                }

                                resolve(true);
                            });
                        } else resolve(true);
                    } else resolve(true);
                })
            }

            // funtion to set the tab as saved
            function setSaved(tab) {
                hasChanges[tab] = false;
                $('.unsaved').removeClass('unsaved');
                $('.unsaved-abbr').removeClass('slds-show_inline').addClass('slds-hide');
            }

            // function to show or hide asset data icon
            function showHideAssetDataIcon(element, tempId) {
                var type = $(element).val();
                if (type) {
                    var types = JSON.parse('{!serializedMapAssetTypeLiabilityType}');
                    if (types[type] !== 'None') {
                        $(`#iconAssetData-${tempId}`).addClass('slds-visible').removeClass('slds-hidden');
                        $(`span[data-id*=detailsAssetData-${tempId}]`).addClass('slds-hidden').removeClass('slds-visible');
                    } else {
                        $(`#iconAssetData-${tempId}`).addClass('slds-hidden').removeClass('slds-visible');
                        $(`span[data-id*=detailsAssetData-${tempId}]`).addClass('slds-visible').removeClass('slds-hidden');
                    }
                }
            }

            // function to show or hide related asset on liability and the options
            function showHideRelatedAsset(element, tempId) {
                //, assetRole.asset.Type__c + ' ($ ' + assetRole.asset.Value__c + ')')
                var type = $(element).val();
                if (type) {
                    var types = JSON.parse('{!serializedMapRelatedAssetList}');
                    var selectElement = $(`#selectRelatedAsset-${tempId}`);
                    if (types[type]) {
                        // change the options
                        selectElement.empty(); // remove old options
                        $.each(types[type], (key, value) => {
                            var address = '';

                            if (value.Street__c) {
                                address = `(${value.Street__c || ''})`;
                            }
                            selectElement.append($("<option></option>")
                                .attr("value", value.Id).text(`${value.Type__c} ${address}`));
                        });
                        $(`#selectRelatedAssetContainer-${tempId}`).addClass('slds-show').removeClass('slds-hide');
                        $(`#assetSelected-${tempId}`).val(types[type][0].Id);
                    } else {
                        $(`#selectRelatedAssetContainer-${tempId}`).addClass('slds-hide').removeClass('slds-show');
                        $(`#assetSelected-${tempId}`).val();
                    }
                }
                else {
                    $(`#assetSelected-${tempId}`).val();
                    $(`#selectRelatedAssetContainer-${tempId}`).addClass('slds-hide').removeClass('slds-show');
                }
            }

            // function to set the asset selected on liabilities
            function setAssetSelected(element, tempId) {
                var valueSelected = $(element).val();
                var type = $('select[data-id*=liabType-' + tempId + ']').val();
                var types = JSON.parse('{!serializedMapRelatedAssetList}');

                $.each(types[type], (key, value) => {
                    var address = '';
                    if (value.Id === valueSelected) {
                        $(`input[data-id*=assetSelectedId-${tempId}]`).val(valueSelected);

                        if (value.Street__c) {
                            address = `(${value.Street__c || ''})`;
                        }

                        $(`input[data-id*=assetSelectedDisplayValue-${tempId}]`).val(`${value.Type__c} ${address}`);
                    }
                });
            }

            // function to mark the tab as unsaved
            function markAsChanged(mainTab, subTab) {
                var tabToMark = subTab || mainTab;
                hasChanges[mainTab] = true;

                $('#' + tabToMark).addClass('unsaved');
                $('#' + tabToMark).find('.unsaved-abbr').removeClass('slds-hide').addClass('slds-show_inline');
            }

            function enableRowFields(tempId) {
                $('select[data-id*=external-refType-' + tempId + ']').toggleClass('slds-is-disabled');
                $('textarea[data-id*=external-refNote-' + tempId + ']').toggleClass('slds-is-disabled');
            }

            // function to execute after institution was selected/deleted
            function institutionSelected() {
                markAsChanged('Tab1', 'tabAssetsLiabilities');
            }

            // function to execute after any legal SLDS Dynamic was selected/deleted
            function legalSLDSSelected() {
                markAsChanged('Tab1', 'tabLegalDocuments');
            }

            // function to execute after any referral SLDS Dynamic was selected/deleted
            function referralSLDSSelected(selectedId, mainRecordId) {
                $('input[data-id*=userChanged-' + mainRecordId + ']').val(true);
                markAsChanged('Tab1', 'tabCoverGoals');
            }

            // function to execute after any next Steps SLDS Dynamic was selected/deleted
            function nextStepsSLDSSelected() {
                markAsChanged('Tab6');
            }

            // function to set all limited advice checkboxes
            function setLimitedAdvice(element) {
                if (element.checked) {
                    $('input.limitedAdvice').each((index, value) => {
                        $(value).prop("checked", true);
                        $(value).trigger('change');
                    });
                }
            }

            // function to alert user of missing information, i.e: There is no 'Preferred Email' address for 'Sara Smith'
            function missingFieldAlert(title, type, recordName, element) {
                // currently below is only checking if Client 1's personal email is null, however this needs to be changed if checking for other fields
                if (type === 'email' && '{!client1.account.PersonEmail}' === '' && element.checked && $('input[data-id="client1Email"]').val() === '') {
                    showAlert(title, 'There is no &#39;Preferred Email&#39; address for &#39;' + recordName + '&#39;.');
                    element.checked = false;
                }
            }

            // function to show/hide Dependant Until
            function showHideDependantUntil(element) {
                $('#dependantUntilInput').toggleClass('slds-show slds-hide');
            }

            // function to show the circle of life popup
            function openCircleOfLife() {
                var img = `{!baseUrl}{!URLFOR($Resource.Akina, 'images/circleOfLife.jpg')}`;
                var popupHeight = 700;
                var popupWidth = 780;
                const y = window.outerHeight / 2 + window.screenY - (popupHeight / 2);
                const x = window.outerWidth / 2 + window.screenX - (popupWidth / 2);
                var win = window.open("", "", "toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=" + popupWidth + ",height=" + popupHeight + ",top=" + y + ",left=" + x);

                win.document.title = 'Image';
                win.document.body.innerHTML =
                    `<div style="text-align: center">
                            <img src="${img}" alt="" style="height: 95%" />
                        </div>
                        <div style="text-align: center">
                            <button onclick="window.close()" style="color: rgb(255, 255, 255);padding: 0 1rem 0 1rem;border-radius: .25rem;line-height: 1.875rem;font-size: .75rem;background-color: #66b245;border: 1px solid #66b245">
                                Close
                            </button>
                        </div>`;
            }
                        
                        
            // function to validate uncomplete data on Know Your Client tab (AP2-414)
            function checkTaxCountryData() {
               
                let completed = true;
                let message = 'You need to complete  tax resident country name';
                hasCountryTax = $('*[id*=has-tax-resident-country]') ;

                if(hasCountryTax && 'Yes' === $('*[id*=has-tax-resident-country]').val() ){
                    emptyField =  $('*[id*=country-resident-tax]') && $('*[id*=country-resident-tax]').val();

                    if (!emptyField) {
                        completed = false;
                    }
        
                    if (!completed) {
                        showAlert('Uncomplete data', message);
                    }

                }  
                
                if(completed){
                    showSpinner();
                    saveRiskAnalysis();
                }  
                return completed;
            }            


        </script>
    </body>

    </html>
</apex:page>